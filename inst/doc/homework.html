<!DOCTYPE html>

<html>

<head>

<meta charset="utf-8" />
<meta name="generator" content="pandoc" />
<meta http-equiv="X-UA-Compatible" content="IE=EDGE" />

<meta name="viewport" content="width=device-width, initial-scale=1" />

<meta name="author" content="Wang Shuyan" />

<meta name="date" content="2022-11-29" />

<title>Homework</title>

<script>// Hide empty <a> tag within highlighted CodeBlock for screen reader accessibility (see https://github.com/jgm/pandoc/issues/6352#issuecomment-626106786) -->
// v0.0.1
// Written by JooYoung Seo (jooyoung@psu.edu) and Atsushi Yasumoto on June 1st, 2020.

document.addEventListener('DOMContentLoaded', function() {
  const codeList = document.getElementsByClassName("sourceCode");
  for (var i = 0; i < codeList.length; i++) {
    var linkList = codeList[i].getElementsByTagName('a');
    for (var j = 0; j < linkList.length; j++) {
      if (linkList[j].innerHTML === "") {
        linkList[j].setAttribute('aria-hidden', 'true');
      }
    }
  }
});
</script>

<style type="text/css">
  code{white-space: pre-wrap;}
  span.smallcaps{font-variant: small-caps;}
  span.underline{text-decoration: underline;}
  div.column{display: inline-block; vertical-align: top; width: 50%;}
  div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
  ul.task-list{list-style: none;}
    </style>


<style type="text/css">
  code {
    white-space: pre;
  }
  .sourceCode {
    overflow: visible;
  }
</style>
<style type="text/css" data-origin="pandoc">
code.sourceCode > span { display: inline-block; line-height: 1.25; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode { white-space: pre; position: relative; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
code.sourceCode { white-space: pre-wrap; }
code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */

</style>
<script>
// apply pandoc div.sourceCode style to pre.sourceCode instead
(function() {
  var sheets = document.styleSheets;
  for (var i = 0; i < sheets.length; i++) {
    if (sheets[i].ownerNode.dataset["origin"] !== "pandoc") continue;
    try { var rules = sheets[i].cssRules; } catch (e) { continue; }
    for (var j = 0; j < rules.length; j++) {
      var rule = rules[j];
      // check if there is a div.sourceCode rule
      if (rule.type !== rule.STYLE_RULE || rule.selectorText !== "div.sourceCode") continue;
      var style = rule.style.cssText;
      // check if color or background-color is set
      if (rule.style.color === '' && rule.style.backgroundColor === '') continue;
      // replace div.sourceCode by a pre.sourceCode rule
      sheets[i].deleteRule(j);
      sheets[i].insertRule('pre.sourceCode{' + style + '}', j);
    }
  }
})();
</script>




<style type="text/css">body {
background-color: #fff;
margin: 1em auto;
max-width: 700px;
overflow: visible;
padding-left: 2em;
padding-right: 2em;
font-family: "Open Sans", "Helvetica Neue", Helvetica, Arial, sans-serif;
font-size: 14px;
line-height: 1.35;
}
#TOC {
clear: both;
margin: 0 0 10px 10px;
padding: 4px;
width: 400px;
border: 1px solid #CCCCCC;
border-radius: 5px;
background-color: #f6f6f6;
font-size: 13px;
line-height: 1.3;
}
#TOC .toctitle {
font-weight: bold;
font-size: 15px;
margin-left: 5px;
}
#TOC ul {
padding-left: 40px;
margin-left: -1.5em;
margin-top: 5px;
margin-bottom: 5px;
}
#TOC ul ul {
margin-left: -2em;
}
#TOC li {
line-height: 16px;
}
table {
margin: 1em auto;
border-width: 1px;
border-color: #DDDDDD;
border-style: outset;
border-collapse: collapse;
}
table th {
border-width: 2px;
padding: 5px;
border-style: inset;
}
table td {
border-width: 1px;
border-style: inset;
line-height: 18px;
padding: 5px 5px;
}
table, table th, table td {
border-left-style: none;
border-right-style: none;
}
table thead, table tr.even {
background-color: #f7f7f7;
}
p {
margin: 0.5em 0;
}
blockquote {
background-color: #f6f6f6;
padding: 0.25em 0.75em;
}
hr {
border-style: solid;
border: none;
border-top: 1px solid #777;
margin: 28px 0;
}
dl {
margin-left: 0;
}
dl dd {
margin-bottom: 13px;
margin-left: 13px;
}
dl dt {
font-weight: bold;
}
ul {
margin-top: 0;
}
ul li {
list-style: circle outside;
}
ul ul {
margin-bottom: 0;
}
pre, code {
background-color: #f7f7f7;
border-radius: 3px;
color: #333;
white-space: pre-wrap; 
}
pre {
border-radius: 3px;
margin: 5px 0px 10px 0px;
padding: 10px;
}
pre:not([class]) {
background-color: #f7f7f7;
}
code {
font-family: Consolas, Monaco, 'Courier New', monospace;
font-size: 85%;
}
p > code, li > code {
padding: 2px 0px;
}
div.figure {
text-align: center;
}
img {
background-color: #FFFFFF;
padding: 2px;
border: 1px solid #DDDDDD;
border-radius: 3px;
border: 1px solid #CCCCCC;
margin: 0 5px;
}
h1 {
margin-top: 0;
font-size: 35px;
line-height: 40px;
}
h2 {
border-bottom: 4px solid #f7f7f7;
padding-top: 10px;
padding-bottom: 2px;
font-size: 145%;
}
h3 {
border-bottom: 2px solid #f7f7f7;
padding-top: 10px;
font-size: 120%;
}
h4 {
border-bottom: 1px solid #f7f7f7;
margin-left: 8px;
font-size: 105%;
}
h5, h6 {
border-bottom: 1px solid #ccc;
font-size: 105%;
}
a {
color: #0033dd;
text-decoration: none;
}
a:hover {
color: #6666ff; }
a:visited {
color: #800080; }
a:visited:hover {
color: #BB00BB; }
a[href^="http:"] {
text-decoration: underline; }
a[href^="https:"] {
text-decoration: underline; }

code > span.kw { color: #555; font-weight: bold; } 
code > span.dt { color: #902000; } 
code > span.dv { color: #40a070; } 
code > span.bn { color: #d14; } 
code > span.fl { color: #d14; } 
code > span.ch { color: #d14; } 
code > span.st { color: #d14; } 
code > span.co { color: #888888; font-style: italic; } 
code > span.ot { color: #007020; } 
code > span.al { color: #ff0000; font-weight: bold; } 
code > span.fu { color: #900; font-weight: bold; } 
code > span.er { color: #a61717; background-color: #e3d2d2; } 
</style>




</head>

<body>




<h1 class="title toc-ignore">Homework</h1>
<h4 class="author">Wang Shuyan</h4>
<h4 class="date">2022-11-29</h4>



<div class="sourceCode" id="cb1"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1-1"><a href="#cb1-1"></a><span class="kw">library</span>(StatComp22023)</span></code></pre></div>
<div id="homework-0-2022-09-09" class="section level1">
<h1>homework 0: 2022-09-09</h1>
<div id="question" class="section level2">
<h2>Question</h2>
<p>Use knitr to produce at least 3 examples (texts, figures, tables).</p>
</div>
<div id="answer" class="section level2">
<h2>Answer</h2>
<p>load <code>knitr</code> package</p>
<div class="sourceCode" id="cb2"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb2-1"><a href="#cb2-1"></a><span class="kw">library</span>(knitr)</span>
<span id="cb2-2"><a href="#cb2-2"></a><span class="kw">data</span>(data)</span></code></pre></div>
<div id="beautify-tables" class="section level3">
<h3>1. Beautify tables</h3>
<p>Use the data <code>WorldPhones</code>: the number of telephones in various regions of the world</p>
<p>Without using <code>knitr</code> package, we’ll get the table like:</p>
<div class="sourceCode" id="cb3"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb3-1"><a href="#cb3-1"></a><span class="kw">head</span>(WorldPhones, <span class="dv">4</span>)</span></code></pre></div>
<pre><code>##      N.Amer Europe Asia S.Amer Oceania Africa Mid.Amer
## 1951  45939  21574 2876   1815    1646     89      555
## 1956  60423  29990 4708   2568    2366   1411      733
## 1957  64721  32510 5230   2695    2526   1546      773
## 1958  68484  35218 6662   2845    2691   1663      836</code></pre>
<p>Beautifying by <code>knitr</code>, we get:</p>
<div class="sourceCode" id="cb5"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb5-1"><a href="#cb5-1"></a><span class="kw">kable</span>(<span class="kw">head</span>(WorldPhones, <span class="dv">4</span>))</span></code></pre></div>
<table>
<thead>
<tr class="header">
<th align="left"></th>
<th align="right">N.Amer</th>
<th align="right">Europe</th>
<th align="right">Asia</th>
<th align="right">S.Amer</th>
<th align="right">Oceania</th>
<th align="right">Africa</th>
<th align="right">Mid.Amer</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="left">1951</td>
<td align="right">45939</td>
<td align="right">21574</td>
<td align="right">2876</td>
<td align="right">1815</td>
<td align="right">1646</td>
<td align="right">89</td>
<td align="right">555</td>
</tr>
<tr class="even">
<td align="left">1956</td>
<td align="right">60423</td>
<td align="right">29990</td>
<td align="right">4708</td>
<td align="right">2568</td>
<td align="right">2366</td>
<td align="right">1411</td>
<td align="right">733</td>
</tr>
<tr class="odd">
<td align="left">1957</td>
<td align="right">64721</td>
<td align="right">32510</td>
<td align="right">5230</td>
<td align="right">2695</td>
<td align="right">2526</td>
<td align="right">1546</td>
<td align="right">773</td>
</tr>
<tr class="even">
<td align="left">1958</td>
<td align="right">68484</td>
<td align="right">35218</td>
<td align="right">6662</td>
<td align="right">2845</td>
<td align="right">2691</td>
<td align="right">1663</td>
<td align="right">836</td>
</tr>
</tbody>
</table>
</div>
<div id="beautify-texts" class="section level3">
<h3>2. Beautify texts</h3>
<p>a piece of R code like this is not readable enough:</p>
<div class="sourceCode" id="cb6"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb6-1"><a href="#cb6-1"></a>parity&lt;-<span class="cf">function</span>(x){<span class="cf">if</span>(x<span class="op">%%</span><span class="dv">2</span><span class="op">==</span><span class="dv">1</span>){<span class="kw">print</span>(<span class="st">&#39;odd&#39;</span>)} <span class="cf">else</span>{<span class="kw">print</span>(<span class="st">&#39;even&#39;</span>)}}</span>
<span id="cb6-2"><a href="#cb6-2"></a><span class="kw">parity</span>(<span class="dv">5</span>)</span></code></pre></div>
<pre><code>## [1] &quot;odd&quot;</code></pre>
<p>With the chunk option <code>tidy=TRUE</code>, we can reformat the R code.</p>
<div class="sourceCode" id="cb8"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb8-1"><a href="#cb8-1"></a>parity &lt;-<span class="st"> </span><span class="cf">function</span>(x) {</span>
<span id="cb8-2"><a href="#cb8-2"></a>    <span class="cf">if</span> (x<span class="op">%%</span><span class="dv">2</span> <span class="op">==</span><span class="st"> </span><span class="dv">1</span>) {</span>
<span id="cb8-3"><a href="#cb8-3"></a>        <span class="kw">print</span>(<span class="st">&quot;odd&quot;</span>)</span>
<span id="cb8-4"><a href="#cb8-4"></a>    } <span class="cf">else</span> {</span>
<span id="cb8-5"><a href="#cb8-5"></a>        <span class="kw">print</span>(<span class="st">&quot;even&quot;</span>)</span>
<span id="cb8-6"><a href="#cb8-6"></a>    }</span>
<span id="cb8-7"><a href="#cb8-7"></a>}</span>
<span id="cb8-8"><a href="#cb8-8"></a><span class="kw">parity</span>(<span class="dv">5</span>)</span></code></pre></div>
<pre><code>## [1] &quot;odd&quot;</code></pre>
</div>
<div id="beautify-figures" class="section level3">
<h3>3. Beautify figures</h3>
<p>We can also use the chunk option <code>fig.width</code> and <code>fig.height</code> to adjust the image size</p>
<div class="sourceCode" id="cb10"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb10-1"><a href="#cb10-1"></a><span class="kw">library</span>(ggplot2)</span></code></pre></div>
<div class="sourceCode" id="cb11"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb11-1"><a href="#cb11-1"></a><span class="kw">ggplot</span>(<span class="dt">data=</span>beaver1, <span class="kw">aes</span>(<span class="dt">x=</span>day, <span class="dt">y=</span>temp, <span class="dt">group=</span>day)) <span class="op">+</span><span class="st"> </span></span>
<span id="cb11-2"><a href="#cb11-2"></a><span class="st">  </span><span class="kw">geom_boxplot</span>() <span class="op">+</span><span class="st"> </span></span>
<span id="cb11-3"><a href="#cb11-3"></a><span class="st">  </span><span class="kw">scale_x_continuous</span>(<span class="dt">breaks =</span> <span class="kw">c</span>(<span class="dv">346</span>, <span class="dv">347</span>))</span></code></pre></div>
<p><img src="data:image/png;base64,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" /><!-- --></p>
<p>After adjustment, we get:</p>
<div class="sourceCode" id="cb12"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb12-1"><a href="#cb12-1"></a><span class="kw">ggplot</span>(<span class="dt">data=</span>beaver1, <span class="kw">aes</span>(<span class="dt">x=</span>day, <span class="dt">y=</span>temp, <span class="dt">group=</span>day)) <span class="op">+</span><span class="st"> </span></span>
<span id="cb12-2"><a href="#cb12-2"></a><span class="st">  </span><span class="kw">geom_boxplot</span>() <span class="op">+</span><span class="st"> </span></span>
<span id="cb12-3"><a href="#cb12-3"></a><span class="st">  </span><span class="kw">scale_x_continuous</span>(<span class="dt">breaks =</span> <span class="kw">c</span>(<span class="dv">346</span>, <span class="dv">347</span>))</span></code></pre></div>
<p><img src="data:image/png;base64,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" /><!-- --></p>
<div class="sourceCode" id="cb13"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb13-1"><a href="#cb13-1"></a><span class="kw">rm</span>(<span class="dt">list =</span> <span class="kw">ls</span>())</span></code></pre></div>
</div>
</div>
</div>
<div id="homework-1-2022-09-16" class="section level1">
<h1>homework 1: 2022-09-16</h1>
<div id="question-3.3" class="section level2">
<h2>Question 3.3</h2>
<p>3.3 The Pareto(a, b) distribution has cdf<span class="math display">\[F(x)=1-(\frac{b}{x})^a,x\geq b &gt;0,a&gt;0\]</span> Derive the probability inverse transformation <span class="math inline">\(F^{−1}(U)\)</span> and use the inverse transform method to simulate a random sample from the Pareto(2, 2) distribution. Graph the density histogram of the sample with the Pareto(2, 2) density superimposed for comparison</p>
</div>
<div id="answer-1" class="section level2">
<h2>Answer</h2>
<p>By <span class="math display">\[F(x)=1-(\frac{b}{x})^a\]</span> we have that <span class="math display">\[(\frac{b}{x})^a = 1-F(x)\]</span> then <span class="math display">\[\frac{b}{x} = (1-F(x))^{\frac{1}{a}}\]</span> <span class="math display">\[x = b(1-F(x))^{-\frac{1}{a}}\]</span> So <span class="math display">\[F^{-1}(u) = b(1-u)^{-\frac{1}{a}}\]</span></p>
<div id="simulate-a-random-sample" class="section level3">
<h3>simulate a random sample</h3>
<p>First Generate <span class="math inline">\(U\sim U(0, 1)\)</span></p>
<div class="sourceCode" id="cb14"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb14-1"><a href="#cb14-1"></a><span class="kw">set.seed</span>(<span class="dv">1</span>)</span>
<span id="cb14-2"><a href="#cb14-2"></a>N &lt;-<span class="st"> </span><span class="dv">5000</span></span>
<span id="cb14-3"><a href="#cb14-3"></a>U &lt;-<span class="st"> </span><span class="kw">runif</span>(N)</span></code></pre></div>
<p>Then return <span class="math inline">\(X = F^{-1}(U)\)</span> with<span class="math inline">\(a=b=2\)</span></p>
<div class="sourceCode" id="cb15"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb15-1"><a href="#cb15-1"></a>F_inverse =<span class="st"> </span><span class="cf">function</span>(u, a, b){</span>
<span id="cb15-2"><a href="#cb15-2"></a>  b<span class="op">*</span>(<span class="dv">1</span><span class="op">-</span>u)<span class="op">^</span>(<span class="op">-</span><span class="dv">1</span><span class="op">/</span>a)</span>
<span id="cb15-3"><a href="#cb15-3"></a>}</span>
<span id="cb15-4"><a href="#cb15-4"></a>x &lt;-<span class="st"> </span><span class="kw">F_inverse</span>(U, <span class="dv">2</span>, <span class="dv">2</span>)</span></code></pre></div>
<p>calculate Pareto(2, 2) density</p>
<p><span class="math display">\[p(x) = F&#39;(x) = a(\frac{b}{x})^{(a-1)}\frac{b}{x^2}, x\geq b &gt;0,a&gt;0\]</span></p>
<div class="sourceCode" id="cb16"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb16-1"><a href="#cb16-1"></a>pareto &lt;-<span class="st"> </span><span class="cf">function</span>(x, a, b){</span>
<span id="cb16-2"><a href="#cb16-2"></a>  a<span class="op">*</span>(b<span class="op">/</span>x)<span class="op">^</span>(a<span class="dv">-1</span>)<span class="op">*</span>b<span class="op">/</span>x<span class="op">^</span><span class="dv">2</span></span>
<span id="cb16-3"><a href="#cb16-3"></a>}</span></code></pre></div>
</div>
<div id="graph-the-density-histogram-of-the-sample-with-the-pareto2-2-density-superimposed-for-comparison" class="section level3">
<h3>Graph the density histogram of the sample with the Pareto(2, 2) density superimposed for comparison</h3>
<div class="sourceCode" id="cb17"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb17-1"><a href="#cb17-1"></a><span class="kw">hist</span>(x, <span class="dt">freq=</span>F, <span class="dt">breaks=</span><span class="dv">100</span>,<span class="dt">xlim=</span><span class="kw">c</span>(<span class="dv">0</span>,<span class="dv">20</span>))</span>
<span id="cb17-2"><a href="#cb17-2"></a><span class="co">#draw density function</span></span>
<span id="cb17-3"><a href="#cb17-3"></a><span class="kw">lines</span>(<span class="kw">seq</span>(<span class="dv">2</span>,<span class="dv">20</span>,<span class="fl">0.05</span>), <span class="kw">pareto</span>(<span class="kw">seq</span>(<span class="dv">2</span>,<span class="dv">20</span>,<span class="fl">0.05</span>), <span class="dv">2</span>, <span class="dv">2</span>), <span class="dt">lwd=</span><span class="dv">2</span>)</span></code></pre></div>
<p><img src="data:image/png;base64,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" /><!-- --></p>
</div>
</div>
<div id="question-3.7" class="section level2">
<h2>Question 3.7</h2>
<p>3.7 Write a function to generate a random sample of size n from the Beta(a, b) distribution by the acceptance-rejection method. Generate a random sample of size 1000 from the Beta(3,2) distribution. Graph the histogram of the sample with the theoretical Beta(3,2) density superimposed.</p>
</div>
<div id="answer-2" class="section level2">
<h2>Answer</h2>
<p>The pdf of Beta distribution (<code>dbeta</code> in R) is <span class="math display">\[f(x) =\frac{1}{B(\alpha,\beta)}x^{\alpha-1}(1-x)^{\beta -1}\]</span> So the pdf of Beta(2,3) distribution is <span class="math display">\[f(x) = \frac{1}{B(2,3)}x(1-x)^2 \leq\frac{1}{8B(2,3)}=1.5\]</span></p>
<p>So let <span class="math inline">\(g(x) = I(0\leq x \leq 1), c=2\)</span>. In fact g is a uniform distribution U(0,1). We get <span class="math inline">\(f(x)/cg(x) &lt; 1\)</span>, for all x</p>
<div class="sourceCode" id="cb18"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb18-1"><a href="#cb18-1"></a>n &lt;-<span class="st"> </span><span class="dv">10000</span> <span class="co">#number of samples</span></span>
<span id="cb18-2"><a href="#cb18-2"></a>x &lt;-<span class="st"> </span><span class="kw">numeric</span>(<span class="dv">0</span>) <span class="co">#samples</span></span>
<span id="cb18-3"><a href="#cb18-3"></a>f =<span class="st"> </span><span class="cf">function</span>(x) <span class="dv">1</span><span class="op">/</span><span class="kw">beta</span>(<span class="dv">2</span>,<span class="dv">3</span>)<span class="op">*</span>x<span class="op">*</span>(<span class="dv">1</span><span class="op">-</span>x)<span class="op">^</span><span class="dv">2</span></span>
<span id="cb18-4"><a href="#cb18-4"></a>g =<span class="st"> </span><span class="cf">function</span>(x) <span class="kw">I</span>(x<span class="op">&gt;</span><span class="dv">0</span>)<span class="op">*</span><span class="kw">I</span>(x<span class="op">&lt;</span><span class="dv">1</span>) </span>
<span id="cb18-5"><a href="#cb18-5"></a>c &lt;-<span class="st"> </span><span class="dv">2</span></span></code></pre></div>
<p>Acceptance-rejection algorithm</p>
<div class="sourceCode" id="cb19"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb19-1"><a href="#cb19-1"></a><span class="kw">set.seed</span>(<span class="dv">1</span>)</span>
<span id="cb19-2"><a href="#cb19-2"></a>i=k=<span class="dv">0</span></span>
<span id="cb19-3"><a href="#cb19-3"></a><span class="cf">while</span>(i <span class="op">&lt;</span><span class="st"> </span>n){</span>
<span id="cb19-4"><a href="#cb19-4"></a>  y &lt;-<span class="st"> </span><span class="kw">runif</span>(<span class="dv">1</span>) <span class="co">#y ~ g</span></span>
<span id="cb19-5"><a href="#cb19-5"></a>  u &lt;-<span class="st"> </span><span class="kw">runif</span>(<span class="dv">1</span>) <span class="co">#u ~ u(0,1)</span></span>
<span id="cb19-6"><a href="#cb19-6"></a>  <span class="cf">if</span>(u <span class="op">&lt;=</span><span class="st"> </span><span class="kw">f</span>(y)<span class="op">/</span>c<span class="op">/</span><span class="kw">g</span>(y)){ <span class="co"># 接收y的条件</span></span>
<span id="cb19-7"><a href="#cb19-7"></a>    x[k] &lt;-<span class="st"> </span>y</span>
<span id="cb19-8"><a href="#cb19-8"></a>    k &lt;-<span class="st"> </span>k<span class="op">+</span><span class="dv">1</span></span>
<span id="cb19-9"><a href="#cb19-9"></a>  }</span>
<span id="cb19-10"><a href="#cb19-10"></a>  i &lt;-<span class="st"> </span>i<span class="op">+</span><span class="dv">1</span> </span>
<span id="cb19-11"><a href="#cb19-11"></a>}</span></code></pre></div>
<p>Graph the histogram of the sample with the theoretical Beta(3,2) density superimposed.</p>
<div class="sourceCode" id="cb20"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb20-1"><a href="#cb20-1"></a><span class="kw">hist</span>(x, <span class="dt">freq=</span>F, <span class="dt">ylim=</span><span class="kw">c</span>(<span class="dv">0</span>,<span class="dv">2</span>))</span>
<span id="cb20-2"><a href="#cb20-2"></a><span class="kw">lines</span>(<span class="kw">seq</span>(<span class="dv">0</span>,<span class="dv">1</span>,<span class="fl">0.01</span>), <span class="kw">dbeta</span>(<span class="kw">seq</span>(<span class="dv">0</span>,<span class="dv">1</span>,<span class="fl">0.01</span>),<span class="dv">2</span>,<span class="dv">3</span>), <span class="dt">lwd=</span><span class="dv">2</span>)</span></code></pre></div>
<p><img src="data:image/png;base64,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" /><!-- --></p>
</div>
<div id="question-3.12" class="section level2">
<h2>Question 3.12</h2>
<p>3.12 Simulate a continuous Exponential-Gamma mixture. Suppose that the rate parameter <span class="math inline">\(\Lambda\)</span> has <span class="math inline">\(Gamma(r, \beta)\)</span> distribution and Y has <span class="math inline">\(Exp(\Lambda)\)</span> distribution. That is, <span class="math inline">\((Y|\Lambda = \lambda) \sim f_Y (y|\lambda) = \lambda e^{−\lambda y}\)</span>. Generate 1000 random observations from this mixture with r = 4 and <span class="math inline">\(\beta\)</span> = 2.</p>
</div>
<div id="answer-3" class="section level2">
<h2>Answer</h2>
<p>First generate 1000 random observations from <span class="math inline">\(Gamma(4,2)\)</span></p>
<div class="sourceCode" id="cb21"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb21-1"><a href="#cb21-1"></a>n &lt;-<span class="st"> </span><span class="dv">1000</span></span>
<span id="cb21-2"><a href="#cb21-2"></a>lambda &lt;-<span class="st"> </span><span class="kw">rgamma</span>(n,<span class="dv">4</span>,<span class="dv">2</span>)</span></code></pre></div>
<p>Then generate <span class="math inline">\(Exp(\Lambda)\)</span> from <code>lambda</code></p>
<div class="sourceCode" id="cb22"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb22-1"><a href="#cb22-1"></a>x &lt;-<span class="st"> </span><span class="kw">rexp</span>(n, lambda)</span></code></pre></div>
<p>Plot the histogram</p>
<div class="sourceCode" id="cb23"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb23-1"><a href="#cb23-1"></a><span class="kw">hist</span>(x, <span class="dt">breaks=</span><span class="dv">30</span>, <span class="dt">xlim=</span><span class="kw">c</span>(<span class="dv">0</span>,<span class="dv">6</span>))</span></code></pre></div>
<p><img src="data:image/png;base64,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" /><!-- --></p>
</div>
<div id="question-3.13" class="section level2">
<h2>Question 3.13</h2>
<p>3.13 It can be shown that the mixture in Exercise 3.12 has a Pareto distribution with cdf <span class="math display">\[F(y)=1-(\frac{\beta}{\beta+y})^r, y\geq 0\]</span> (This is an alternative parameterization of the Pareto cdf given in Exercise 3.3.) Generate 1000 random observations from the mixture with r = 4 and <span class="math inline">\(\beta= 2\)</span>. Compare the empirical and theoretical (Pareto) distributions by graphing the density histogram of the sample and superimposing the Pareto density curve.</p>
</div>
<div id="answer-4" class="section level2">
<h2>Answer</h2>
<p>calculate Pareto(4, 2) density</p>
<p><span class="math display">\[p(y) = F&#39;(y) = r(\frac{\beta}{\beta+y})^{(r-1)}\frac{\beta}{(\beta+y)^2}, y\geq 0\]</span></p>
<div class="sourceCode" id="cb24"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb24-1"><a href="#cb24-1"></a>pareto &lt;-<span class="st"> </span><span class="cf">function</span>(y, r, beta){</span>
<span id="cb24-2"><a href="#cb24-2"></a>  r<span class="op">*</span>(beta<span class="op">/</span>(y<span class="op">+</span>beta))<span class="op">^</span>(r<span class="dv">-1</span>)<span class="op">*</span>beta<span class="op">/</span>(y<span class="op">+</span>beta)<span class="op">^</span><span class="dv">2</span></span>
<span id="cb24-3"><a href="#cb24-3"></a>}</span></code></pre></div>
<p>Compare the empirical and theoretical (Pareto) distributions</p>
<div class="sourceCode" id="cb25"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb25-1"><a href="#cb25-1"></a><span class="kw">hist</span>(x, <span class="dt">breaks=</span><span class="dv">30</span>, <span class="dt">freq=</span>F, <span class="dt">xlim=</span><span class="kw">c</span>(<span class="dv">0</span>,<span class="dv">6</span>))</span>
<span id="cb25-2"><a href="#cb25-2"></a><span class="kw">lines</span>(<span class="kw">seq</span>(<span class="fl">0.05</span>,<span class="dv">6</span>,<span class="fl">0.01</span>), <span class="kw">pareto</span>(<span class="kw">seq</span>(<span class="fl">0.05</span>,<span class="dv">6</span>,<span class="fl">0.01</span>), <span class="dv">4</span>, <span class="dv">2</span>), <span class="dt">lwd=</span><span class="dv">2</span>)</span></code></pre></div>
<p><img src="data:image/png;base64,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" /><!-- --></p>
<div class="sourceCode" id="cb26"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb26-1"><a href="#cb26-1"></a><span class="kw">rm</span>(<span class="dt">list =</span> <span class="kw">ls</span>())</span></code></pre></div>
</div>
</div>
<div id="homework-2-2022-09-23" class="section level1">
<h1>homework 2: 2022-09-23</h1>
<div id="question-1" class="section level2">
<h2>Question 1</h2>
<p>For n = 1e4, 2 × 1e4, 4 × 1e4, 6 × 1e4, 8 × 1e4, apply the fast sorting algorithm to randomly permuted numbers of 1, . . . , n.</p>
<p>• Calculate computation time averaged over 100 simulations, denoted by an.</p>
<p>• Regress an on tn := n log(n), and graphically show the results (scatter plot and regression line).</p>
</div>
<div id="answer-5" class="section level2">
<h2>Answer</h2>
<div class="sourceCode" id="cb27"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb27-1"><a href="#cb27-1"></a>quick_sort&lt;-<span class="cf">function</span>(x){</span>
<span id="cb27-2"><a href="#cb27-2"></a>  num&lt;-<span class="kw">length</span>(x)</span>
<span id="cb27-3"><a href="#cb27-3"></a>  <span class="cf">if</span>(num<span class="op">==</span><span class="dv">0</span><span class="op">||</span>num<span class="op">==</span><span class="dv">1</span>){<span class="kw">return</span>(x)</span>
<span id="cb27-4"><a href="#cb27-4"></a>  }<span class="cf">else</span>{</span>
<span id="cb27-5"><a href="#cb27-5"></a>    a&lt;-x[<span class="dv">1</span>]</span>
<span id="cb27-6"><a href="#cb27-6"></a>    y&lt;-x[<span class="op">-</span><span class="dv">1</span>]</span>
<span id="cb27-7"><a href="#cb27-7"></a>    lower&lt;-y[y<span class="op">&lt;</span>a]</span>
<span id="cb27-8"><a href="#cb27-8"></a>    upper&lt;-y[y<span class="op">&gt;=</span>a]</span>
<span id="cb27-9"><a href="#cb27-9"></a>    <span class="kw">return</span>(<span class="kw">c</span>(<span class="kw">quick_sort</span>(lower),a,<span class="kw">quick_sort</span>(upper)))}<span class="co">#??????</span></span>
<span id="cb27-10"><a href="#cb27-10"></a>}</span></code></pre></div>
<p>Calculate computation time averaged over 100 simulations</p>
<div class="sourceCode" id="cb28"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb28-1"><a href="#cb28-1"></a>time_all =<span class="st"> </span><span class="kw">c</span>()</span>
<span id="cb28-2"><a href="#cb28-2"></a>num &lt;-<span class="st"> </span><span class="kw">c</span>(<span class="fl">1e4</span>, <span class="fl">2e4</span>, <span class="fl">4e4</span>, <span class="fl">6e4</span>, <span class="fl">8e4</span>)</span>
<span id="cb28-3"><a href="#cb28-3"></a><span class="cf">for</span>(k <span class="cf">in</span> <span class="dv">1</span><span class="op">:</span><span class="dv">5</span>){</span>
<span id="cb28-4"><a href="#cb28-4"></a>  n &lt;-<span class="st"> </span>num[k]</span>
<span id="cb28-5"><a href="#cb28-5"></a>  time_each &lt;-<span class="st"> </span><span class="dv">0</span></span>
<span id="cb28-6"><a href="#cb28-6"></a>  <span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">1</span><span class="op">:</span><span class="dv">100</span>){</span>
<span id="cb28-7"><a href="#cb28-7"></a>    test&lt;-<span class="kw">sample</span>(<span class="dv">1</span><span class="op">:</span>n)</span>
<span id="cb28-8"><a href="#cb28-8"></a>    time_each &lt;-<span class="st"> </span>time_each <span class="op">+</span><span class="st"> </span><span class="kw">system.time</span>(<span class="kw">quick_sort</span>(test))[<span class="dv">1</span>]</span>
<span id="cb28-9"><a href="#cb28-9"></a>  }</span>
<span id="cb28-10"><a href="#cb28-10"></a>  time_all[k] =<span class="st"> </span>time_each</span>
<span id="cb28-11"><a href="#cb28-11"></a>}</span></code></pre></div>
<p>Regress and graphically show the results</p>
<div class="sourceCode" id="cb29"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb29-1"><a href="#cb29-1"></a>x =<span class="st"> </span>num<span class="op">*</span><span class="kw">log</span>(num)</span>
<span id="cb29-2"><a href="#cb29-2"></a>relation &lt;-<span class="st"> </span><span class="kw">lm</span>(time_all <span class="op">~</span><span class="st"> </span>x)</span>
<span id="cb29-3"><a href="#cb29-3"></a><span class="kw">plot</span>(x, time_all, <span class="dt">main =</span> <span class="st">&quot;Regression&quot;</span>,<span class="dt">pch =</span> <span class="dv">16</span>,<span class="dt">xlab =</span> <span class="st">&quot;n log(n)&quot;</span>,<span class="dt">ylab =</span> <span class="st">&quot;time&quot;</span>)</span>
<span id="cb29-4"><a href="#cb29-4"></a><span class="kw">abline</span>(relation,<span class="dt">cex =</span> <span class="fl">1.3</span>)</span></code></pre></div>
<p><img src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAASAAAAEgCAMAAAAjXV6yAAAApVBMVEUAAAAAADoAAGYAOjoAOmYAOpAAZrY6AAA6ADo6OgA6Ojo6OmY6OpA6ZpA6ZrY6kLY6kNtmAABmADpmOgBmOjpmkLZmkNtmtrZmtttmtv+QOgCQZgCQZjqQkGaQtpCQttuQtv+Q29uQ2/+2ZgC2Zjq2kDq2tma229u22/+2/7a2///bkDrbkGbbtmbbtpDb29vb////tmb/25D/27b//7b//9v///+g5KpnAAAACXBIWXMAAA7DAAAOwwHHb6hkAAAJHElEQVR4nO2da2ObNhiFcZbLuu4Sr90l2bpL6LasrFtIYv7/T5uEEIYUOEZ+dcGc50NKDbxCj4UkjBBZRSbJYh9A6lAQgIIAFASgIAAFASgIQEEACgJQEICCABQEoCAABQEoCEBBAAoCUBCAggAUBKAgAAUBKAhAQQAKAlAQgIIAFASgIAAFASgIQEGAwIJ2t1nN5vW9SLCLh+PDTBNJkFJ0JxHshAVll2FTdiW8oPpLf7yq/929V0Xp67oU6MXzuzw7+1AV2eaXN9nZfXf1P6/U4lf3vUUb7N+3WfbZd3pJ7fl7HUfuiCMJqnL97/O2LkvnH2zR2rwygjQXD53V5iO9srPYBGs+6CxKnL+WqCUo18VELV5XVanOuYddnjWCLu6r/zqrlarLh+pj1l80wUyoQn+g/57fN8tCxKuD6rzqjBRaSn1u6U+MoJuq6q5WEs7/MhE6i0aQ2bPK93uqTeQquGiCLuvv3p4RtmTZOkifIv3VWVPP9BcvHuye9U5mT13IxI44kqDzX6v6tLIGbJ66gjqrq6c3Zum3qrNYu7F7lrrwnIQg9aX/YapUVURuup9Xn5Sgm/2eT+9eNTVxu3iiJahpbS77GenXQbWgT/K5+8lUN3ZxqA46EUEqO7p05Nnmx+ppqz/qt2Kmmd6vVmu/edAnV29xqBU7FUEqV8pE09HRmer3g4ygzur32cDiUD/oVATpIqQy8fSzaqlM/1j3mr+879ZBvdUfdbXzur/Y60l/r1ctXxAiD3D5OY9UBKkS9bVwF0+GVATZTo/gVZQMqQiqnt5etdfrKZGMoFShIAAFASgIQEEACgJQEICCABQEoCAABQEoCEBBAAoCUBCAggAUBKAgAAUBKAhAQQAKAlAQgIIAFASgIAAFAYQFZYshliDZcB6o3VDQKLb4UNAwGQVN41fQ81Y/O6HHgtnhykeFi0EAQYUeZfm8vRneZBmCKo+CGjXFyGDUtAV1GjBvgh6vakHlyEmWtKBsZPngnRDLLkH9ro8nQfoEvqxsdX1kuLBkk/89eD+EcrS5Uw3Z2COPqQr6pOfMflCXgQuLwILmXwOGZOigWIJahr80CrKMHJHHVsywkH7Q6DnvpwTtbkcvwlzC+Wf8cDydYrtb8DhXUoKmmgxfdVCZjVyluoXzyuSxsJIGPY7VC0IHsnJBuMO6bkEHHMWaBR10vbNiQYcdwmoFHXq5vFZB8vk+KUEzfm1ZpaA5ia9Q0Lwf69YnaGbKaxM0+7fedQly+Cl8RYLc7hSsR5DjvZTVCHK927QWQc6341YiKGMJmkwsq1gH4bSSasXsZL4JjFE8chiAi6BnPWtqPjWXd2GHvYyOfwkm6NiEHASVm7tCT888bmh3266LPMLs+FEk8wXp3OtsF+N3lztjW+OOURRIZb4gnXstaCzrVTIlSGQQknsJyidmmy3sjeeYdZBMEs51UDF5890OgBmV6F2Q1Bg2x1bs6MlmfQsSix+4oxhojKJg+JPsSUsGdxBk6xc0iEwmXYfQorFdWjE4WXrUMYqxinqvH4SIN0ZRvHJz6wdBYo1RlA/rUAc9fn5ACx9ljKKPttFF0FWalbSfroPLKSbxwoaI54KnsLMqacF0J4PsC423nqenSlou3akY+x55Ar2GmZW0WLoTIfZPJvvsds7esO0Fxq6k5z/a7pSK+IbBwgW67hXfMFy4II8uLllQFeLRzpmCnrfXydRBYlFkkkiwBAV5MtihFfvWtPITdzUk0/UaQjKVTwRN3BeTTHc0QKhbjzM3zPc/hR3VoQ52R/hY3EtQoHSH9w449kF8wwDhwulZpKCw01osT1BQPcsTFHxWlIUJCq1nYYJiTKqzJEER9CxJUKQ5mZYiKNqUVQsRFEuPJ0HSc7nGnPHMnyC5uVwj6vEoSGwmzsgT5nkTNDyX6/wheHH1JF+C4s+36EmQLiMCc7lG1+OvmZeYyzV+8amS7geloCdhQUkUnypdQYnoSVGQ7gKkUnyqBAWlNpdyaoJCjGiZBQUBKAiQmKCMddBUODtDgmxSx5GSoKTEWNIRlFbBaUlFUKJ6khGUqp5EBCVbfKo0BCWsJ7Ig8yBB0n6iCkqt0zxIREHJXVUMQkEACgJEFyQbVp5ogma+ajoaKfSDkiZiCVoIkQQdn5LozWuB3FGQ/xCyKVGQyGYUFDKY7xCyKVGQyGYUFDKY7xCyKa1X0EKhIAAFASgIQEEACgJQEICCABQEoCAABQEoCEBBAB+C6ndIjTxRVjZvptg/nIfQ0ziPbDc/2Hw8CNrdqqMuho+31I/j6UwdPHNsefGgBAgFc8CDIPPc7+BkcWbK4fzy8Mn2zB5CwVzwVgfVX23RnmvmS967Kw48ITqF4/hgLngTlOsDV5Ier+pMNXmq/+ovPP9ivJ7qUp79vTUbCgRzwZcg/dxvM5VFXf6b3Gyav89b/Vz55OvwDIWeBkNPJy8RzAVPgkpdR5scqDPBvk/gps1TsxWuO4pNU0wkgrngR5B5brxsBlLoquLlWVHTTOMwhame1YYSwVzwIqh5WWTZeRfXy3q18+Ek7TklEcwFH4LsS9y6c8SYw29bZpO5A84KE0NtKBHMBS/9IFtd1hVI3n2nW9u3092Xg+pVPUtIrUIimAMeBBWmsrD9oP4XW9iX4OVNfQIpbRMuEWw+vFgFUBCAggAUBKAgAAUBKAhAQQAKAlAQgIIAFASgIAAFASgIQEEACgJQEICCABQEoCAABQEoCEBBAAoCUBCAggBpChp5d9Dutv1Y5rWwB7AoQd3BmuXIu2GkWZKg3qed0uSVdAQ9b3/YZt2hV+24lzzLNu/0WKCzD52txl4vJExKgvQAfTPeRwsqlYZ6iL0eUFzqgUB6nNR+q+6YPI+kJOi6HYmpBJkBdsqC+SjXo32vu1t5GrT5kpQE3bTVjPrH5F8Pb61HldXDoW+6W42+oUqWxAWphcIKqj+hIJagMV4IelEHFW0dZLdaex002orZrVbYivUF9fpBZ39qS3U/yG61un7QNK0cy+irXoVJX1DTeNWPjPFabIjSPuTDq/kUoSAABQEoCEBBAAoCUBCAggAUBKAgAAUBKAhAQQAKAlAQgIIAFASgIAAFASgIQEGA/wGU63x/Q/YcJQAAAABJRU5ErkJggg==" /><!-- --></p>
</div>
<div id="question-2" class="section level2">
<h2>Question 2</h2>
<p>5.6 In Example 5.7 the control variate approach was illustrated for Monte Carlo integration. Now consider the antithetic variate approach. Compute Cov(eU, e1−U) and V ar(eU + e1−U), where U ∼ Uniform(0,1). What is the percent reduction in variance of θ that can be achieved using antithetic variates (compared with simple MC)?</p>
</div>
<div id="answer-6" class="section level2">
<h2>Answer</h2>
<p>The variable<span class="math inline">\(U\sim U(0,1)\)</span>, then<span class="math display">\[E(e^U)=\int^1_0 e^xdx=e-1\]</span> <span class="math display">\[E(e^{2U})=\int^1_0 e^{2x}dx=\frac{1}{2}e^2-\frac{1}{2}\]</span> and<span class="math display">\[var(e^U) = E(e^{2U})-(E(e^U))^2=\frac{1}{2}(e^2-1)-(e-1)^2\]</span></p>
<p>So <span class="math display">\[
cov(e^U, e^{1-U}) = E(e^U e^{1-U})-E(e^U)E(e^{1-U})\\
=e-(e-1)^2
\]</span></p>
<p><span class="math display">\[
var(e^U+e^{1-U}) = var(e^U)+var(e^{1-U})+2cov(e^U, e^{1-U})\\
=(e^2-1)-2(e-1)^2+2[e-(e-1)^2]\\
=(e^2-1)-4(e-1)^2+2e
\]</span></p>
<p>With the simple MC, we get <span class="math display">\[var(\hat\theta_{MC})=\frac{1}{m}var(e^U)=\frac{1}{m}[\frac{1}{2}(e^2-1)-(e-1)^2]\]</span> where m is the number of the samples</p>
<p>With the antithetic variates, we get <span class="math display">\[var(\hat\theta_{anti})=\frac{1}{m}var[(e^U+e^{1-U})/2]=\frac{1}{4m}[(e^2-1)-4(e-1)^2+2e]\]</span></p>
<p>So the percent reduction in variance is <span class="math display">\[1-var(\hat\theta_{anti})/var(\hat\theta_{MC})=1-\frac{\frac{1}{4}[(e^2-1)-4(e-1)^2+2e]}{\frac{1}{2}(e^2-1)-(e-1)^2}\]</span></p>
<div class="sourceCode" id="cb30"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb30-1"><a href="#cb30-1"></a><span class="dv">1</span><span class="op">-</span>(<span class="kw">exp</span>(<span class="dv">2</span>)<span class="op">-</span><span class="dv">1</span> <span class="op">-</span><span class="st"> </span><span class="dv">4</span><span class="op">*</span>(<span class="kw">exp</span>(<span class="dv">1</span>)<span class="op">-</span><span class="dv">1</span>)<span class="op">^</span><span class="dv">2</span> <span class="op">+</span><span class="st"> </span><span class="dv">2</span><span class="op">*</span><span class="kw">exp</span>(<span class="dv">1</span>))<span class="op">/</span><span class="dv">4</span><span class="op">/</span>((<span class="kw">exp</span>(<span class="dv">2</span>)<span class="op">-</span><span class="dv">1</span>)<span class="op">/</span><span class="dv">2</span><span class="op">-</span>(<span class="kw">exp</span>(<span class="dv">1</span>)<span class="op">-</span><span class="dv">1</span>)<span class="op">^</span><span class="dv">2</span>)</span></code></pre></div>
<pre><code>## [1] 0.983835</code></pre>
</div>
<div id="question-3" class="section level2">
<h2>Question 3</h2>
<p>5.7 Refer to Exercise 5.6. Use a Monte Carlo simulation to estimate θ by the antithetic variate approach and by the simple Monte Carlo method. Compute an empirical estimate of the percent reduction in variance using the antithetic variate. Compare the result with the theoretical value from Exercise 5.6.</p>
</div>
<div id="answer-7" class="section level2">
<h2>Answer</h2>
<div class="sourceCode" id="cb32"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb32-1"><a href="#cb32-1"></a><span class="kw">set.seed</span>(<span class="dv">1</span>)</span>
<span id="cb32-2"><a href="#cb32-2"></a>m &lt;-<span class="st"> </span><span class="dv">5000</span></span>
<span id="cb32-3"><a href="#cb32-3"></a>u &lt;-<span class="st"> </span><span class="kw">runif</span>(m)</span></code></pre></div>
<p>Monte Carlo simulation</p>
<div class="sourceCode" id="cb33"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb33-1"><a href="#cb33-1"></a>sample_MC =<span class="st"> </span><span class="kw">exp</span>(u)</span>
<span id="cb33-2"><a href="#cb33-2"></a><span class="kw">cat</span>(<span class="st">&#39;the MC simulation and the variance is&#39;</span>, <span class="kw">mean</span>(sample_MC), <span class="kw">var</span>(sample_MC))</span></code></pre></div>
<pre><code>## the MC simulation and the variance is 1.715957 0.2514045</code></pre>
<p>using antithetic variates</p>
<div class="sourceCode" id="cb35"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb35-1"><a href="#cb35-1"></a>sample_anti =<span class="st"> </span>(<span class="kw">exp</span>(u)<span class="op">+</span><span class="kw">exp</span>(<span class="dv">1</span><span class="op">-</span>u))<span class="op">/</span><span class="dv">2</span></span>
<span id="cb35-2"><a href="#cb35-2"></a><span class="kw">cat</span>(<span class="st">&#39;the antithetic simulation and the variance is&#39;</span>, <span class="kw">mean</span>(sample_anti), <span class="kw">var</span>(sample_anti))</span></code></pre></div>
<pre><code>## the antithetic simulation and the variance is 1.720772 0.004041845</code></pre>
<div class="sourceCode" id="cb37"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb37-1"><a href="#cb37-1"></a><span class="kw">cat</span>(<span class="st">&#39;the percent reduction in variance is &#39;</span>, <span class="dv">1</span><span class="op">-</span><span class="kw">var</span>(sample_anti)<span class="op">/</span><span class="kw">var</span>(sample_MC))</span></code></pre></div>
<pre><code>## the percent reduction in variance is  0.9839229</code></pre>
<div class="sourceCode" id="cb39"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb39-1"><a href="#cb39-1"></a><span class="kw">rm</span>(<span class="dt">list =</span> <span class="kw">ls</span>())</span></code></pre></div>
</div>
</div>
<div id="homework-3-2022-09-30" class="section level1">
<h1>homework 3: 2022-09-30</h1>
<div id="question-5.13" class="section level2">
<h2>Question 5.13</h2>
<p>Find two importance functions f1 and f2 that are supported on <span class="math inline">\((1, \infty)\)</span> and are ‘close’ to <span class="math display">\[g(x) = \frac{x^2}{\sqrt{2π}} e^{−x^2/2}, x &gt; 1.\]</span> Which of your two importance functions should produce the smaller variance in estimating <span class="math display">\[\int_1^\infty\frac{x^2}{\sqrt{2π}} e^{−x^2/2}\]</span></p>
</div>
<div id="answer-8" class="section level2">
<h2>Answer</h2>
<div class="sourceCode" id="cb40"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb40-1"><a href="#cb40-1"></a>g &lt;-<span class="st"> </span><span class="cf">function</span>(x){</span>
<span id="cb40-2"><a href="#cb40-2"></a>  x<span class="op">^</span><span class="dv">2</span><span class="op">/</span><span class="kw">sqrt</span>(<span class="dv">2</span><span class="op">*</span>pi)<span class="op">*</span><span class="kw">exp</span>(<span class="op">-</span>x<span class="op">^</span><span class="dv">2</span><span class="op">/</span><span class="dv">2</span>)</span>
<span id="cb40-3"><a href="#cb40-3"></a>}</span></code></pre></div>
<p>If<span class="math inline">\(X\sim N(\mu,\sigma^2)\)</span>，then the pdf of X is<span class="math display">\[\frac{1}{\sqrt{2π}\sigma} e^{-((x-\mu)^2/2\sigma^2)}, -\infty &lt; x&lt; \infty\]</span> So for any<span class="math inline">\(a&lt;\mu\)</span><span class="math display">\[P(|X-a|+a&lt;x)=P(2a-x&lt;X&lt;x)= P(X&lt;x) -P(X&lt;2a-x)= \int_0^x\frac{1}{\sqrt{2π}\sigma} e^{-((t-\mu)^2/2\sigma^2)}dt - \int_0^{2a-x}\frac{1}{\sqrt{2π}\sigma} e^{-((t-\mu)^2/2\sigma^2)}dt\]</span> the pdf of Y=|X-a|+a is<span class="math display">\[p(y)=\frac{dP(|X-a|+a&lt;y)}{dy} = \frac{1}{\sqrt{2π}\sigma} e^{-((y-\mu)^2/2\sigma^2)} + \frac{1}{\sqrt{2π}\sigma} e^{-((2a-y-\mu)^2/2\sigma^2)}, y&gt;a\]</span></p>
<p>This pdf is equal to the sum of pdf <span class="math inline">\(N(\mu,\sigma^2)\)</span> and <span class="math inline">\(N(2a-\mu,\sigma^2)\)</span> with x in <span class="math inline">\((a, +\infty)\)</span></p>
<p>Take<span class="math inline">\(a=1, \mu=1.5, \sigma=1.5. f_1\)</span>is the pdf defined as above</p>
<p>Then sampling with a pdf<span class="math inline">\(f_1\)</span>randomly，is equal to sampling X randomly from <span class="math inline">\(N(1.5,1.5^2)\)</span>first，and take |X-1|+1</p>
<div class="sourceCode" id="cb41"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb41-1"><a href="#cb41-1"></a>f1 &lt;-<span class="st"> </span><span class="cf">function</span>(x)  <span class="kw">dnorm</span>(x, <span class="dt">mean=</span><span class="fl">1.5</span>, <span class="dt">sd=</span><span class="fl">1.5</span>) <span class="op">+</span><span class="st"> </span><span class="kw">dnorm</span>(x, <span class="dt">mean=</span><span class="fl">0.5</span>, <span class="dt">sd=</span><span class="fl">1.5</span>)</span></code></pre></div>
<p>Then take<span class="math inline">\(a=1, \mu=4, \sigma=1.5. f_2\)</span>is the pdf defined as above</p>
<p>Then sampling with a pdf<span class="math inline">\(f_2\)</span>randomly，is equal to sampling X randomly from <span class="math inline">\(N(4,1.5^2)\)</span>first，and take |X-1|+1</p>
<div class="sourceCode" id="cb42"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb42-1"><a href="#cb42-1"></a>f2 &lt;-<span class="st"> </span><span class="cf">function</span>(x)  <span class="kw">dnorm</span>(x, <span class="dt">mean=</span><span class="dv">4</span>, <span class="dt">sd=</span><span class="fl">1.5</span>) <span class="op">+</span><span class="st"> </span><span class="kw">dnorm</span>(x, <span class="dt">mean=</span><span class="op">-</span><span class="dv">2</span>, <span class="dt">sd=</span><span class="fl">1.5</span>)</span></code></pre></div>
<p>importance sampling</p>
<div class="sourceCode" id="cb43"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb43-1"><a href="#cb43-1"></a><span class="kw">set.seed</span>(<span class="dv">1</span>)</span>
<span id="cb43-2"><a href="#cb43-2"></a>x1 &lt;-<span class="st"> </span><span class="kw">abs</span>(<span class="kw">rnorm</span>(<span class="fl">1e5</span>, <span class="fl">1.5</span>, <span class="fl">1.5</span>)<span class="op">-</span><span class="dv">1</span>)<span class="op">+</span><span class="dv">1</span> <span class="co">#f1</span></span>
<span id="cb43-3"><a href="#cb43-3"></a>x2 &lt;-<span class="st"> </span><span class="kw">abs</span>(<span class="kw">rnorm</span>(<span class="fl">1e5</span>, <span class="dv">4</span>, <span class="fl">1.5</span>)<span class="op">-</span><span class="dv">1</span>)<span class="op">+</span><span class="dv">1</span> <span class="co">#f2</span></span></code></pre></div>
<p>plot <span class="math inline">\(f_1, f_2\)</span> and <span class="math inline">\(g\)</span></p>
<div class="sourceCode" id="cb44"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb44-1"><a href="#cb44-1"></a>x &lt;-<span class="st"> </span><span class="kw">seq</span>(<span class="dv">1</span>, <span class="dv">5</span>, <span class="fl">0.05</span>)</span>
<span id="cb44-2"><a href="#cb44-2"></a><span class="kw">plot</span>(x, <span class="kw">g</span>(x), <span class="dt">type=</span><span class="st">&#39;l&#39;</span>, <span class="dt">ylim=</span><span class="kw">c</span>(<span class="dv">0</span>,<span class="fl">0.6</span>))</span>
<span id="cb44-3"><a href="#cb44-3"></a><span class="kw">lines</span>(x, <span class="kw">f1</span>(x), <span class="dt">col=</span><span class="st">&#39;red&#39;</span>)</span>
<span id="cb44-4"><a href="#cb44-4"></a><span class="kw">lines</span>(x, <span class="kw">f2</span>(x), <span class="dt">col=</span><span class="st">&#39;blue&#39;</span>)</span>
<span id="cb44-5"><a href="#cb44-5"></a><span class="kw">legend</span>(<span class="st">&quot;topright&quot;</span>,<span class="dt">legend=</span><span class="kw">c</span>(<span class="st">&#39;g&#39;</span>,<span class="st">&#39;f1&#39;</span>,<span class="st">&#39;f2&#39;</span>),<span class="dt">col=</span><span class="kw">c</span>(<span class="st">&#39;black&#39;</span>,<span class="st">&#39;red&#39;</span>,<span class="st">&#39;blue&#39;</span>),<span class="dt">lty=</span><span class="kw">c</span>(<span class="dv">1</span>,<span class="dv">1</span>,<span class="dv">1</span>))</span></code></pre></div>
<p><img src="data:image/png;base64,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" /><!-- --></p>
<p>(Verify for the review that f1 and f2 are indeed pdf on<span class="math inline">\((1,+\infty)\)</span></p>
<div class="sourceCode" id="cb45"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb45-1"><a href="#cb45-1"></a><span class="kw">integrate</span>(f1, <span class="dv">1</span>, <span class="ot">Inf</span>)</span></code></pre></div>
<pre><code>## 1 with absolute error &lt; 3.8e-07</code></pre>
<div class="sourceCode" id="cb47"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb47-1"><a href="#cb47-1"></a><span class="kw">integrate</span>(f2, <span class="dv">1</span>, <span class="ot">Inf</span>)</span></code></pre></div>
<pre><code>## 1 with absolute error &lt; 4.9e-07</code></pre>
<p><span class="math display">\[\int_1^\infty g(x)dx = E(g(X)/f(X)),X\sim f\]</span></p>
<p>evaluate the integration</p>
<div class="sourceCode" id="cb49"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb49-1"><a href="#cb49-1"></a>f1_eva =<span class="st"> </span><span class="kw">mean</span>(<span class="kw">g</span>(x1)<span class="op">/</span><span class="kw">f1</span>(x1)) <span class="co">#f1</span></span>
<span id="cb49-2"><a href="#cb49-2"></a>f2_eva =<span class="st"> </span><span class="kw">mean</span>(<span class="kw">g</span>(x2)<span class="op">/</span><span class="kw">f2</span>(x2)) <span class="co">#f2</span></span>
<span id="cb49-3"><a href="#cb49-3"></a><span class="kw">cat</span>(f1_eva, f2_eva)</span></code></pre></div>
<pre><code>## 0.4000996 0.4033189</code></pre>
<p>the mean of the evaluations from f1 is 0.400, the evaluation from f2 is 0.403</p>
<div class="sourceCode" id="cb51"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb51-1"><a href="#cb51-1"></a>f1_eva =<span class="st"> </span><span class="kw">var</span>(<span class="kw">g</span>(x1)<span class="op">/</span><span class="kw">f1</span>(x1)) <span class="co">#f1</span></span>
<span id="cb51-2"><a href="#cb51-2"></a>f2_eva =<span class="st"> </span><span class="kw">var</span>(<span class="kw">g</span>(x2)<span class="op">/</span><span class="kw">f2</span>(x2)) <span class="co">#f2</span></span>
<span id="cb51-3"><a href="#cb51-3"></a><span class="kw">cat</span>(f1_eva, f2_eva)</span></code></pre></div>
<pre><code>## 0.04137673 0.8373449</code></pre>
<p>the variance of the evaluations from f1 is 0.041, the variance of the evaluation from f2 is 0.837</p>
<p>f1 is smaller. Because the pdf of f1 is more paralleled to g than f2. So <span class="math inline">\(g(X)/f(X)\)</span>is more close to a constant. So the varience of the integration <span class="math inline">\(var(g(X)/f(X))\)</span> is smaller.</p>
</div>
<div id="question-5.15" class="section level2">
<h2>Question 5.15</h2>
<p>Obtain the stratified importance sampling estimate in Example 5.13 and compare it with the result of Example 5.13</p>
</div>
<div id="answer-9" class="section level2">
<h2>Answer</h2>
<p>Due to the result in Example 5.10, the best result was obtained with importance function <span class="math inline">\(f(x)=e^{-x}/(1-e^{-1}),0&lt;x&lt;1\)</span></p>
<p>let <span class="math inline">\(g(x) = \frac{e^{-x}}{1+x^2}\)</span></p>
<p>Then <span class="math inline">\(\int_0^1g(x)dx=\int_0^1g(x)f(x)/f(x)dx=E_{x\sim f(x),(0,1)}(g(x)/f(x))\)</span>,with<span class="math inline">\(f(x)=e^{-x}/(1-e^{-1})\)</span></p>
<p>So the cdf of X is <span class="math inline">\(F(x) = (1 - e^{-x})/(1-e^{-1}), F^{-1}(u)=-log(1-u(1-e^{-1}))\)</span></p>
<p>When F(x) reaches 0,0.2,0.4,0.6,0.8,1, x will becomes</p>
<div class="sourceCode" id="cb53"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb53-1"><a href="#cb53-1"></a>Fx &lt;-<span class="st"> </span><span class="kw">c</span>(<span class="dv">0</span>,<span class="fl">0.2</span>, <span class="fl">0.4</span>, <span class="fl">0.6</span>, <span class="fl">0.8</span>,<span class="dv">1</span>)</span>
<span id="cb53-2"><a href="#cb53-2"></a>I &lt;-<span class="st"> </span><span class="op">-</span><span class="kw">log</span>(<span class="dv">1</span><span class="op">-</span>Fx<span class="op">*</span>(<span class="dv">1</span><span class="op">-</span><span class="kw">exp</span>(<span class="op">-</span><span class="dv">1</span>)))</span>
<span id="cb53-3"><a href="#cb53-3"></a>I</span></code></pre></div>
<pre><code>## [1] 0.0000000 0.1351603 0.2914869 0.4768628 0.7046055 1.0000000</code></pre>
<p>These are the split points for the subintervals, which the probability in the each one is the same, 0.2.</p>
<p>let these split points record as <span class="math inline">\(I_j, j=0,1,2,3,4,5\)</span></p>
<p><span class="math display">\[\int_0^1\frac{e^{-x}}{1+x^2}dx=\frac{1}{5}\sum_{j=0}^4\int_{I_j}^{I_{j+1}}\frac{e^{-x}}{1+x^2}/f(x)*5f(x)dx=\sum_{j=0}^4 E_{x\sim 5f(x),(I_j,I_{j+1})}(g(x)/f(x))\]</span></p>
<p>which <span class="math inline">\(f(x)=e^{-x}/(1-e^{-1})\)</span></p>
<p>So the cdf of <span class="math inline">\(5f\)</span> in <span class="math inline">\((I_j,I_{j+1})\)</span> is<span class="math inline">\(F(x)=\int_{I_j}^x 5e^{-x}/(1-e^{-1})dx=5((e^{-I_j}- e^{-x})/(1-e^{-1}))\)</span></p>
<p>Then <span class="math inline">\(F^{-1}(u)=-log(e^{-I_j}-u(1-e^{-1})/5)\)</span></p>
<div class="sourceCode" id="cb55"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb55-1"><a href="#cb55-1"></a>f &lt;-<span class="st"> </span><span class="cf">function</span>(x){</span>
<span id="cb55-2"><a href="#cb55-2"></a> <span class="kw">exp</span>(<span class="op">-</span>x)<span class="op">/</span>(<span class="dv">1</span><span class="op">-</span><span class="kw">exp</span>(<span class="op">-</span><span class="dv">1</span>))</span>
<span id="cb55-3"><a href="#cb55-3"></a>}</span>
<span id="cb55-4"><a href="#cb55-4"></a></span>
<span id="cb55-5"><a href="#cb55-5"></a>F_inv &lt;-<span class="st"> </span><span class="cf">function</span>(u, Ij){</span>
<span id="cb55-6"><a href="#cb55-6"></a>  <span class="op">-</span><span class="kw">log</span>(<span class="kw">exp</span>(<span class="op">-</span>Ij) <span class="op">-</span><span class="st"> </span>u<span class="op">/</span><span class="dv">5</span><span class="op">*</span>(<span class="dv">1</span><span class="op">-</span><span class="kw">exp</span>(<span class="op">-</span><span class="dv">1</span>)))</span>
<span id="cb55-7"><a href="#cb55-7"></a>}</span>
<span id="cb55-8"><a href="#cb55-8"></a></span>
<span id="cb55-9"><a href="#cb55-9"></a>g &lt;-<span class="st"> </span><span class="cf">function</span>(x) {</span>
<span id="cb55-10"><a href="#cb55-10"></a>  <span class="kw">exp</span>(<span class="op">-</span>x)<span class="op">/</span>(<span class="dv">1</span><span class="op">+</span>x<span class="op">^</span><span class="dv">2</span>)</span>
<span id="cb55-11"><a href="#cb55-11"></a>}</span></code></pre></div>
<p>Use the inverse transform method to evaluate each stratification.</p>
<p>There are 10000 samples used for evaluation. So we use 2000 samples in each stratification.</p>
<div class="sourceCode" id="cb56"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb56-1"><a href="#cb56-1"></a><span class="kw">set.seed</span>(<span class="dv">1</span>)</span>
<span id="cb56-2"><a href="#cb56-2"></a>result =<span class="st"> </span><span class="kw">numeric</span>(<span class="dv">5</span>)</span>
<span id="cb56-3"><a href="#cb56-3"></a>se =<span class="st"> </span><span class="kw">numeric</span>(<span class="dv">5</span>)</span>
<span id="cb56-4"><a href="#cb56-4"></a>n &lt;-<span class="st"> </span><span class="dv">2000</span></span>
<span id="cb56-5"><a href="#cb56-5"></a><span class="cf">for</span>(j <span class="cf">in</span> <span class="dv">1</span><span class="op">:</span><span class="dv">5</span>){</span>
<span id="cb56-6"><a href="#cb56-6"></a>  u &lt;-<span class="st"> </span><span class="kw">runif</span>(n,<span class="dv">0</span>,<span class="dv">1</span>) </span>
<span id="cb56-7"><a href="#cb56-7"></a>  x &lt;-<span class="st"> </span><span class="kw">F_inv</span>(u, I[j])</span>
<span id="cb56-8"><a href="#cb56-8"></a>  fg &lt;-<span class="st"> </span><span class="kw">g</span>(x) <span class="op">/</span><span class="st"> </span><span class="kw">f</span>(x)</span>
<span id="cb56-9"><a href="#cb56-9"></a>  result[j] &lt;-<span class="st"> </span><span class="kw">mean</span>(fg)</span>
<span id="cb56-10"><a href="#cb56-10"></a>  se[j] &lt;-<span class="st"> </span><span class="kw">sd</span>(fg)</span>
<span id="cb56-11"><a href="#cb56-11"></a>}</span>
<span id="cb56-12"><a href="#cb56-12"></a><span class="kw">mean</span>(result)</span></code></pre></div>
<pre><code>## [1] 0.5246884</code></pre>
<div class="sourceCode" id="cb58"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb58-1"><a href="#cb58-1"></a><span class="kw">mean</span>(se)</span></code></pre></div>
<pre><code>## [1] 0.01841327</code></pre>
<p>The evaluation is 0.525, closed to the result in Example 5.10. But the standard deviation (sd) is 0.018, much smaller than the sd in Example 5.10.</p>
<div class="sourceCode" id="cb60"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb60-1"><a href="#cb60-1"></a><span class="kw">rm</span>(<span class="dt">list =</span> <span class="kw">ls</span>())</span></code></pre></div>
</div>
</div>
<div id="homework-4-2022-10-09" class="section level1">
<h1>homework 4: 2022-10-09</h1>
<div id="question-6.4" class="section level2">
<h2>Question 6.4</h2>
<p>Suppose that X1, . . . , Xn are a random sample from a from a lognormal distribution with unknown parameters. Construct a 95% confidence interval for the parameter µ. Use a Monte Carlo method to obtain an empirical estimate of the confidence level.</p>
</div>
<div id="answer-10" class="section level2">
<h2>Answer</h2>
<p><span class="math inline">\(X_i \sim logN(\mu, \sigma^2)\)</span>，so <span class="math inline">\(Y_i = log(X_i) \sim N(\mu, \sigma^2)\)</span></p>
<p>So 95% confidence interval for <span class="math inline">\(\mu\)</span> is <span class="math inline">\((\hat \mu - \frac{\hat\sigma}{\sqrt n} u_{0.975}, \hat\mu + \frac{\hat\sigma}{\sqrt n} u_{0.975})\)</span></p>
<p>If we take <span class="math inline">\(\mu =0, \sigma = 2, n=30\)</span></p>
<p>Then the CI will become:</p>
<div class="sourceCode" id="cb61"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb61-1"><a href="#cb61-1"></a><span class="kw">print</span>(<span class="kw">c</span>(<span class="op">-</span><span class="dv">2</span><span class="op">/</span><span class="kw">sqrt</span>(<span class="dv">30</span>)<span class="op">*</span><span class="kw">qnorm</span>(<span class="fl">0.975</span>), <span class="dv">2</span><span class="op">/</span><span class="kw">sqrt</span>(<span class="dv">30</span>)<span class="op">*</span><span class="kw">qnorm</span>(<span class="fl">0.975</span>)))</span></code></pre></div>
<pre><code>## [1] -0.7156777  0.7156777</code></pre>
<p>With m = 1e5 replicates, Monte Carlo method:</p>
<div class="sourceCode" id="cb63"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb63-1"><a href="#cb63-1"></a>n &lt;-<span class="st"> </span><span class="dv">30</span></span>
<span id="cb63-2"><a href="#cb63-2"></a>m &lt;-<span class="st"> </span><span class="fl">1e5</span></span>
<span id="cb63-3"><a href="#cb63-3"></a>mu &lt;-<span class="st"> </span><span class="kw">numeric</span>(<span class="dv">100</span>)</span>
<span id="cb63-4"><a href="#cb63-4"></a><span class="kw">set.seed</span>(<span class="dv">1</span>)</span>
<span id="cb63-5"><a href="#cb63-5"></a><span class="cf">for</span>(i <span class="cf">in</span> <span class="dv">1</span><span class="op">:</span>m){</span>
<span id="cb63-6"><a href="#cb63-6"></a>  x &lt;-<span class="st"> </span><span class="kw">rlnorm</span>(n,<span class="dv">0</span>,<span class="dv">2</span>)</span>
<span id="cb63-7"><a href="#cb63-7"></a>  y &lt;-<span class="st"> </span><span class="kw">log</span>(x)</span>
<span id="cb63-8"><a href="#cb63-8"></a>  mu[i] =<span class="st"> </span><span class="kw">mean</span>(y)</span>
<span id="cb63-9"><a href="#cb63-9"></a>}</span>
<span id="cb63-10"><a href="#cb63-10"></a><span class="kw">quantile</span>(mu, <span class="dt">probs=</span><span class="kw">c</span>(<span class="fl">0.025</span>, <span class="fl">0.975</span>))</span></code></pre></div>
<pre><code>##       2.5%      97.5% 
## -0.7187408  0.7123299</code></pre>
<p>The result is similar to the theoretical results</p>
<p>Clear Memory</p>
<div class="sourceCode" id="cb65"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb65-1"><a href="#cb65-1"></a><span class="kw">rm</span>(<span class="dt">list =</span> <span class="kw">ls</span>())</span></code></pre></div>
</div>
<div id="question-6.8" class="section level2">
<h2>Question 6.8</h2>
<p>Refer to Example 6.16. Repeat the simulation, but also compute the F test of equal variance, at significance level α = 0 . .055. Compare the power of the Count Five test and F test for small, medium, and large sample sizes. (Recall that the F test is not applicable for non-normal distributions.)</p>
</div>
<div id="answer-11" class="section level2">
<h2>Answer</h2>
<div id="for-large-sample-sizes.-let-the-sample-sizes-n-200" class="section level4">
<h4>1.For large sample sizes. Let the sample sizes n = 200</h4>
<p>Repeat the simulation in Example 6.16</p>
<div class="sourceCode" id="cb66"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb66-1"><a href="#cb66-1"></a><span class="kw">set.seed</span>(<span class="dv">1</span>)</span>
<span id="cb66-2"><a href="#cb66-2"></a>count5test &lt;-<span class="st"> </span><span class="cf">function</span>(x, y) {</span>
<span id="cb66-3"><a href="#cb66-3"></a>  X &lt;-<span class="st"> </span>x <span class="op">-</span><span class="st"> </span><span class="kw">mean</span>(x)</span>
<span id="cb66-4"><a href="#cb66-4"></a>  Y &lt;-<span class="st"> </span>y <span class="op">-</span><span class="st"> </span><span class="kw">mean</span>(y)</span>
<span id="cb66-5"><a href="#cb66-5"></a>  outx &lt;-<span class="st"> </span><span class="kw">sum</span>(X <span class="op">&gt;</span><span class="st"> </span><span class="kw">max</span>(Y)) <span class="op">+</span><span class="st"> </span><span class="kw">sum</span>(X <span class="op">&lt;</span><span class="st"> </span><span class="kw">min</span>(Y))</span>
<span id="cb66-6"><a href="#cb66-6"></a>  outy &lt;-<span class="st"> </span><span class="kw">sum</span>(Y <span class="op">&gt;</span><span class="st"> </span><span class="kw">max</span>(X)) <span class="op">+</span><span class="st"> </span><span class="kw">sum</span>(Y <span class="op">&lt;</span><span class="st"> </span><span class="kw">min</span>(X))</span>
<span id="cb66-7"><a href="#cb66-7"></a>  <span class="co"># return 1 (reject) or 0 (do not reject H0)</span></span>
<span id="cb66-8"><a href="#cb66-8"></a>  <span class="kw">return</span>(<span class="kw">as.integer</span>(<span class="kw">max</span>(<span class="kw">c</span>(outx, outy)) <span class="op">&gt;</span><span class="st"> </span><span class="dv">5</span>))</span>
<span id="cb66-9"><a href="#cb66-9"></a>}</span>
<span id="cb66-10"><a href="#cb66-10"></a></span>
<span id="cb66-11"><a href="#cb66-11"></a><span class="co"># generate samples under H1 to estimate power</span></span>
<span id="cb66-12"><a href="#cb66-12"></a>sigma1 &lt;-<span class="st"> </span><span class="dv">1</span></span>
<span id="cb66-13"><a href="#cb66-13"></a>sigma2 &lt;-<span class="st"> </span><span class="fl">1.5</span></span>
<span id="cb66-14"><a href="#cb66-14"></a>m &lt;-<span class="st"> </span><span class="dv">1000</span></span>
<span id="cb66-15"><a href="#cb66-15"></a>n &lt;-<span class="st"> </span><span class="dv">200</span></span>
<span id="cb66-16"><a href="#cb66-16"></a>power &lt;-<span class="st"> </span><span class="kw">mean</span>(<span class="kw">replicate</span>(m, <span class="dt">expr=</span>{</span>
<span id="cb66-17"><a href="#cb66-17"></a>                        x &lt;-<span class="st"> </span><span class="kw">rnorm</span>(n, <span class="dv">0</span>, sigma1)</span>
<span id="cb66-18"><a href="#cb66-18"></a>                        y &lt;-<span class="st"> </span><span class="kw">rnorm</span>(n, <span class="dv">0</span>, sigma2)</span>
<span id="cb66-19"><a href="#cb66-19"></a>                        <span class="kw">count5test</span>(x, y)</span>
<span id="cb66-20"><a href="#cb66-20"></a>                                 }</span>
<span id="cb66-21"><a href="#cb66-21"></a>                        )</span>
<span id="cb66-22"><a href="#cb66-22"></a>             )</span>
<span id="cb66-23"><a href="#cb66-23"></a><span class="kw">print</span>(power)</span></code></pre></div>
<pre><code>## [1] 0.951</code></pre>
<p>Use F test</p>
<div class="sourceCode" id="cb68"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb68-1"><a href="#cb68-1"></a><span class="kw">set.seed</span>(<span class="dv">1</span>)</span>
<span id="cb68-2"><a href="#cb68-2"></a>p.value &lt;-<span class="st"> </span><span class="kw">replicate</span>(m, <span class="dt">expr=</span>{</span>
<span id="cb68-3"><a href="#cb68-3"></a>                        x &lt;-<span class="st"> </span><span class="kw">rnorm</span>(n, <span class="dv">0</span>, sigma1)</span>
<span id="cb68-4"><a href="#cb68-4"></a>                        y &lt;-<span class="st"> </span><span class="kw">rnorm</span>(n, <span class="dv">0</span>, sigma2)</span>
<span id="cb68-5"><a href="#cb68-5"></a>                        <span class="kw">var.test</span>(x, y, <span class="dt">alternative =</span> <span class="st">&quot;two.sided&quot;</span>)<span class="op">$</span>p.value</span>
<span id="cb68-6"><a href="#cb68-6"></a>                            }</span>
<span id="cb68-7"><a href="#cb68-7"></a>                   )</span>
<span id="cb68-8"><a href="#cb68-8"></a>         </span>
<span id="cb68-9"><a href="#cb68-9"></a><span class="kw">print</span>(<span class="kw">sum</span>(p.value <span class="op">&lt;</span><span class="st"> </span><span class="fl">0.055</span>)<span class="op">/</span>m)</span></code></pre></div>
<pre><code>## [1] 1</code></pre>
<p>Both two methods have a good power. But F test is a little better.</p>
</div>
<div id="for-medium-sample-sizes.-let-n-50" class="section level4">
<h4>2.For medium sample sizes. Let n = 50</h4>
<p>Repeat the simulation in Example 6.16</p>
<div class="sourceCode" id="cb70"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb70-1"><a href="#cb70-1"></a><span class="kw">set.seed</span>(<span class="dv">1</span>)</span>
<span id="cb70-2"><a href="#cb70-2"></a>count5test &lt;-<span class="st"> </span><span class="cf">function</span>(x, y) {</span>
<span id="cb70-3"><a href="#cb70-3"></a>  X &lt;-<span class="st"> </span>x <span class="op">-</span><span class="st"> </span><span class="kw">mean</span>(x)</span>
<span id="cb70-4"><a href="#cb70-4"></a>  Y &lt;-<span class="st"> </span>y <span class="op">-</span><span class="st"> </span><span class="kw">mean</span>(y)</span>
<span id="cb70-5"><a href="#cb70-5"></a>  outx &lt;-<span class="st"> </span><span class="kw">sum</span>(X <span class="op">&gt;</span><span class="st"> </span><span class="kw">max</span>(Y)) <span class="op">+</span><span class="st"> </span><span class="kw">sum</span>(X <span class="op">&lt;</span><span class="st"> </span><span class="kw">min</span>(Y))</span>
<span id="cb70-6"><a href="#cb70-6"></a>  outy &lt;-<span class="st"> </span><span class="kw">sum</span>(Y <span class="op">&gt;</span><span class="st"> </span><span class="kw">max</span>(X)) <span class="op">+</span><span class="st"> </span><span class="kw">sum</span>(Y <span class="op">&lt;</span><span class="st"> </span><span class="kw">min</span>(X))</span>
<span id="cb70-7"><a href="#cb70-7"></a>  <span class="co"># return 1 (reject) or 0 (do not reject H0)</span></span>
<span id="cb70-8"><a href="#cb70-8"></a>  <span class="kw">return</span>(<span class="kw">as.integer</span>(<span class="kw">max</span>(<span class="kw">c</span>(outx, outy)) <span class="op">&gt;</span><span class="st"> </span><span class="dv">5</span>))</span>
<span id="cb70-9"><a href="#cb70-9"></a>}</span>
<span id="cb70-10"><a href="#cb70-10"></a></span>
<span id="cb70-11"><a href="#cb70-11"></a><span class="co"># generate samples under H1 to estimate power</span></span>
<span id="cb70-12"><a href="#cb70-12"></a>sigma1 &lt;-<span class="st"> </span><span class="dv">1</span></span>
<span id="cb70-13"><a href="#cb70-13"></a>sigma2 &lt;-<span class="st"> </span><span class="fl">1.5</span></span>
<span id="cb70-14"><a href="#cb70-14"></a>m &lt;-<span class="st"> </span><span class="dv">1000</span></span>
<span id="cb70-15"><a href="#cb70-15"></a>n &lt;-<span class="st"> </span><span class="dv">50</span></span>
<span id="cb70-16"><a href="#cb70-16"></a>power &lt;-<span class="st"> </span><span class="kw">mean</span>(<span class="kw">replicate</span>(m, <span class="dt">expr=</span>{</span>
<span id="cb70-17"><a href="#cb70-17"></a>                        x &lt;-<span class="st"> </span><span class="kw">rnorm</span>(n, <span class="dv">0</span>, sigma1)</span>
<span id="cb70-18"><a href="#cb70-18"></a>                        y &lt;-<span class="st"> </span><span class="kw">rnorm</span>(n, <span class="dv">0</span>, sigma2)</span>
<span id="cb70-19"><a href="#cb70-19"></a>                        <span class="kw">count5test</span>(x, y)</span>
<span id="cb70-20"><a href="#cb70-20"></a>                                 }</span>
<span id="cb70-21"><a href="#cb70-21"></a>                        )</span>
<span id="cb70-22"><a href="#cb70-22"></a>             )</span>
<span id="cb70-23"><a href="#cb70-23"></a><span class="kw">print</span>(power)</span></code></pre></div>
<pre><code>## [1] 0.672</code></pre>
<p>Use F test</p>
<div class="sourceCode" id="cb72"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb72-1"><a href="#cb72-1"></a><span class="kw">set.seed</span>(<span class="dv">1</span>)</span>
<span id="cb72-2"><a href="#cb72-2"></a>p.value &lt;-<span class="st"> </span><span class="kw">replicate</span>(m, <span class="dt">expr=</span>{</span>
<span id="cb72-3"><a href="#cb72-3"></a>                        x &lt;-<span class="st"> </span><span class="kw">rnorm</span>(n, <span class="dv">0</span>, sigma1)</span>
<span id="cb72-4"><a href="#cb72-4"></a>                        y &lt;-<span class="st"> </span><span class="kw">rnorm</span>(n, <span class="dv">0</span>, sigma2)</span>
<span id="cb72-5"><a href="#cb72-5"></a>                        <span class="kw">var.test</span>(x, y, <span class="dt">alternative =</span> <span class="st">&quot;two.sided&quot;</span>)<span class="op">$</span>p.value</span>
<span id="cb72-6"><a href="#cb72-6"></a>                            }</span>
<span id="cb72-7"><a href="#cb72-7"></a>                   )</span>
<span id="cb72-8"><a href="#cb72-8"></a>         </span>
<span id="cb72-9"><a href="#cb72-9"></a><span class="kw">print</span>(<span class="kw">sum</span>(p.value <span class="op">&lt;</span><span class="st"> </span><span class="fl">0.055</span>)<span class="op">/</span>m)</span></code></pre></div>
<pre><code>## [1] 0.823</code></pre>
<p>F test is much better.</p>
</div>
<div id="for-small-sample-sizes.-let-n-20" class="section level4">
<h4>3.For small sample sizes. Let n = 20</h4>
<p>Repeat the simulation in Example 6.16</p>
<div class="sourceCode" id="cb74"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb74-1"><a href="#cb74-1"></a><span class="kw">set.seed</span>(<span class="dv">1</span>)</span>
<span id="cb74-2"><a href="#cb74-2"></a>count5test &lt;-<span class="st"> </span><span class="cf">function</span>(x, y) {</span>
<span id="cb74-3"><a href="#cb74-3"></a>  X &lt;-<span class="st"> </span>x <span class="op">-</span><span class="st"> </span><span class="kw">mean</span>(x)</span>
<span id="cb74-4"><a href="#cb74-4"></a>  Y &lt;-<span class="st"> </span>y <span class="op">-</span><span class="st"> </span><span class="kw">mean</span>(y)</span>
<span id="cb74-5"><a href="#cb74-5"></a>  outx &lt;-<span class="st"> </span><span class="kw">sum</span>(X <span class="op">&gt;</span><span class="st"> </span><span class="kw">max</span>(Y)) <span class="op">+</span><span class="st"> </span><span class="kw">sum</span>(X <span class="op">&lt;</span><span class="st"> </span><span class="kw">min</span>(Y))</span>
<span id="cb74-6"><a href="#cb74-6"></a>  outy &lt;-<span class="st"> </span><span class="kw">sum</span>(Y <span class="op">&gt;</span><span class="st"> </span><span class="kw">max</span>(X)) <span class="op">+</span><span class="st"> </span><span class="kw">sum</span>(Y <span class="op">&lt;</span><span class="st"> </span><span class="kw">min</span>(X))</span>
<span id="cb74-7"><a href="#cb74-7"></a>  <span class="co"># return 1 (reject) or 0 (do not reject H0)</span></span>
<span id="cb74-8"><a href="#cb74-8"></a>  <span class="kw">return</span>(<span class="kw">as.integer</span>(<span class="kw">max</span>(<span class="kw">c</span>(outx, outy)) <span class="op">&gt;</span><span class="st"> </span><span class="dv">5</span>))</span>
<span id="cb74-9"><a href="#cb74-9"></a>}</span>
<span id="cb74-10"><a href="#cb74-10"></a></span>
<span id="cb74-11"><a href="#cb74-11"></a><span class="co"># generate samples under H1 to estimate power</span></span>
<span id="cb74-12"><a href="#cb74-12"></a>sigma1 &lt;-<span class="st"> </span><span class="dv">1</span></span>
<span id="cb74-13"><a href="#cb74-13"></a>sigma2 &lt;-<span class="st"> </span><span class="fl">1.5</span></span>
<span id="cb74-14"><a href="#cb74-14"></a>m &lt;-<span class="st"> </span><span class="dv">1000</span></span>
<span id="cb74-15"><a href="#cb74-15"></a>n &lt;-<span class="st"> </span><span class="dv">20</span></span>
<span id="cb74-16"><a href="#cb74-16"></a>power &lt;-<span class="st"> </span><span class="kw">mean</span>(<span class="kw">replicate</span>(m, <span class="dt">expr=</span>{</span>
<span id="cb74-17"><a href="#cb74-17"></a>                        x &lt;-<span class="st"> </span><span class="kw">rnorm</span>(n, <span class="dv">0</span>, sigma1)</span>
<span id="cb74-18"><a href="#cb74-18"></a>                        y &lt;-<span class="st"> </span><span class="kw">rnorm</span>(n, <span class="dv">0</span>, sigma2)</span>
<span id="cb74-19"><a href="#cb74-19"></a>                        <span class="kw">count5test</span>(x, y)</span>
<span id="cb74-20"><a href="#cb74-20"></a>                                 }</span>
<span id="cb74-21"><a href="#cb74-21"></a>                        )</span>
<span id="cb74-22"><a href="#cb74-22"></a>             )</span>
<span id="cb74-23"><a href="#cb74-23"></a><span class="kw">print</span>(power)</span></code></pre></div>
<pre><code>## [1] 0.328</code></pre>
<p>Use F test</p>
<div class="sourceCode" id="cb76"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb76-1"><a href="#cb76-1"></a><span class="kw">set.seed</span>(<span class="dv">1</span>)</span>
<span id="cb76-2"><a href="#cb76-2"></a>p.value &lt;-<span class="st"> </span><span class="kw">replicate</span>(m, <span class="dt">expr=</span>{</span>
<span id="cb76-3"><a href="#cb76-3"></a>                        x &lt;-<span class="st"> </span><span class="kw">rnorm</span>(n, <span class="dv">0</span>, sigma1)</span>
<span id="cb76-4"><a href="#cb76-4"></a>                        y &lt;-<span class="st"> </span><span class="kw">rnorm</span>(n, <span class="dv">0</span>, sigma2)</span>
<span id="cb76-5"><a href="#cb76-5"></a>                        <span class="kw">var.test</span>(x, y, <span class="dt">alternative =</span> <span class="st">&quot;two.sided&quot;</span>)<span class="op">$</span>p.value</span>
<span id="cb76-6"><a href="#cb76-6"></a>                            }</span>
<span id="cb76-7"><a href="#cb76-7"></a>                   )</span>
<span id="cb76-8"><a href="#cb76-8"></a>         </span>
<span id="cb76-9"><a href="#cb76-9"></a><span class="kw">print</span>(<span class="kw">sum</span>(p.value <span class="op">&lt;</span><span class="st"> </span><span class="fl">0.055</span>)<span class="op">/</span>m)</span></code></pre></div>
<pre><code>## [1] 0.424</code></pre>
<p>F test is better.</p>
<p>Clear Memory</p>
<div class="sourceCode" id="cb78"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb78-1"><a href="#cb78-1"></a><span class="kw">rm</span>(<span class="dt">list =</span> <span class="kw">ls</span>())</span></code></pre></div>
</div>
</div>
<div id="question-discussion" class="section level2">
<h2>Question Discussion</h2>
<p>• If we obtain the powers for two methods under a particular simulation setting with 10,000 experiments:</p>
<p>say, 0.651 for one method and 0.676 for another method. Can we say the powers are different at 0.05 level?</p>
<p>• What is the corresponding hypothesis test problem?</p>
<p>• Which test can we use? Z-test, two-sample t-test, paired-t test or McNemar test? Why?</p>
<p>• Please provide the least necessary information for hypothesis testing.</p>
</div>
<div id="answer-12" class="section level2">
<h2>Answer</h2>
<div id="the-corresponding-hypothesis-test-problem" class="section level4">
<h4>1. The corresponding hypothesis test problem</h4>
<p>Two sample test of Hypothesis test for Binomial Distributions.</p>
</div>
<div id="which-test-can-we-use" class="section level4">
<h4>2. Which test can we use?</h4>
<p>Z-test is not good because there are two samples.</p>
<p>paired-t test is not good because we don’t know the corresponding relationship.</p>
<p>McNemar test is not good because also because we don’t know the corresponding relationship. It needs the numbers of samples’ result between two methods (P-P, P-N. N-P, N-N)</p>
<p>Use two-sample test. Because they are independent and due to the Law of Large Numbers, both of them can be approximated to a normal distribution.</p>
<p>Let<span class="math inline">\(\mu_1, \mu_2\)</span> be the power of two test.</p>
<p><span class="math inline">\(H_0: \mu_1 = \mu_2 \leftrightarrow H_1:\mu_1 \neq \mu_2\)</span></p>
<div class="sourceCode" id="cb79"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb79-1"><a href="#cb79-1"></a>x1 =<span class="st"> </span><span class="kw">c</span>(<span class="kw">rep</span>(<span class="dv">1</span>, <span class="dv">651</span>), <span class="kw">rep</span>(<span class="dv">0</span>, <span class="dv">349</span>))</span>
<span id="cb79-2"><a href="#cb79-2"></a>x2 =<span class="st"> </span><span class="kw">c</span>(<span class="kw">rep</span>(<span class="dv">1</span>, <span class="dv">676</span>), <span class="kw">rep</span>(<span class="dv">0</span>, <span class="dv">324</span>))</span>
<span id="cb79-3"><a href="#cb79-3"></a><span class="kw">t.test</span>(x1, x2)</span></code></pre></div>
<pre><code>## 
##  Welch Two Sample t-test
## 
## data:  x1 and x2
## t = -1.1829, df = 1997.3, p-value = 0.237
## alternative hypothesis: true difference in means is not equal to 0
## 95 percent confidence interval:
##  -0.0664481  0.0164481
## sample estimates:
## mean of x mean of y 
##     0.651     0.676</code></pre>
<p>p-value = 0.237, we can’t say the powers are different at 0.05 level</p>
</div>
<div id="provide-the-least-necessary-information-for-hypothesis-testing" class="section level4">
<h4>3.provide the least necessary information for hypothesis testing</h4>
<p>the null and alternative hypotheses, the level of significance and the critical value.</p>
<div class="sourceCode" id="cb81"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb81-1"><a href="#cb81-1"></a><span class="kw">rm</span>(<span class="dt">list =</span> <span class="kw">ls</span>())</span></code></pre></div>
</div>
</div>
</div>
<div id="homework-5-2022-10-14" class="section level1">
<h1>homework 5: 2022-10-14</h1>
<div id="question-7.4" class="section level2">
<h2>Question 7.4</h2>
<p>Refer to the air-conditioning data set aircondit provided in the boot package. The 12 observations are the times in hours between failures of airconditioning equipment: 3, 5, 7, 18, 43, 85, 91, 98,100, 130, 230, 487. Assume that the times between failures follow an exponential model Exp(<span class="math inline">\(\lambda\)</span>). Obtain the MLE of the hazard rate <span class="math inline">\(\lambda\)</span> and use bootstrap to estimate the bias and standard error of the estimate.</p>
</div>
<div id="answer-13" class="section level2">
<h2>Answer</h2>
<p>The MLE of <span class="math inline">\(\lambda\)</span> is <span class="math inline">\(n/\sum x\)</span></p>
<div class="sourceCode" id="cb82"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb82-1"><a href="#cb82-1"></a><span class="kw">library</span>(boot)</span>
<span id="cb82-2"><a href="#cb82-2"></a>n =<span class="st"> </span><span class="kw">dim</span>(aircondit)[<span class="dv">1</span>]</span>
<span id="cb82-3"><a href="#cb82-3"></a>lambda =<span class="st"> </span>n<span class="op">/</span><span class="kw">sum</span>(aircondit<span class="op">$</span>hours)</span>
<span id="cb82-4"><a href="#cb82-4"></a>lambda <span class="co"># the MLE of the hazard rate</span></span></code></pre></div>
<pre><code>## [1] 0.00925212</code></pre>
<p>use bootstrap to estimate the bias and standard error of the estimate.</p>
<div class="sourceCode" id="cb84"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb84-1"><a href="#cb84-1"></a><span class="kw">set.seed</span>(<span class="dv">2022</span>)</span>
<span id="cb84-2"><a href="#cb84-2"></a>data &lt;-<span class="st"> </span>aircondit<span class="op">$</span>hours</span>
<span id="cb84-3"><a href="#cb84-3"></a>B &lt;-<span class="st"> </span><span class="fl">1e4</span></span>
<span id="cb84-4"><a href="#cb84-4"></a>lambdastar &lt;-<span class="st"> </span><span class="kw">numeric</span>(B)</span>
<span id="cb84-5"><a href="#cb84-5"></a><span class="cf">for</span>(b <span class="cf">in</span> <span class="dv">1</span><span class="op">:</span>B){</span>
<span id="cb84-6"><a href="#cb84-6"></a>  datastar &lt;-<span class="st"> </span><span class="kw">sample</span>(data,<span class="dt">replace=</span><span class="ot">TRUE</span>)</span>
<span id="cb84-7"><a href="#cb84-7"></a>  lambdastar[b] &lt;-<span class="st"> </span>n<span class="op">/</span><span class="kw">sum</span>(datastar)</span>
<span id="cb84-8"><a href="#cb84-8"></a>}</span>
<span id="cb84-9"><a href="#cb84-9"></a><span class="kw">round</span>(<span class="kw">c</span>(<span class="dt">bias=</span><span class="kw">mean</span>(lambdastar)<span class="op">-</span>lambda, </span>
<span id="cb84-10"><a href="#cb84-10"></a>        <span class="dt">se.boot=</span><span class="kw">sd</span>(lambdastar)), <span class="dv">4</span>)</span></code></pre></div>
<pre><code>##    bias se.boot 
##  0.0013  0.0044</code></pre>
<div class="sourceCode" id="cb86"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb86-1"><a href="#cb86-1"></a>se.boot=<span class="kw">sd</span>(lambdastar)</span></code></pre></div>
<p>Clear the memery</p>
<div class="sourceCode" id="cb87"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb87-1"><a href="#cb87-1"></a><span class="kw">rm</span>(<span class="dt">list =</span> <span class="kw">ls</span>())</span></code></pre></div>
</div>
<div id="question-7.5" class="section level2">
<h2>Question 7.5</h2>
<p>Refer to Exercise 7.4. Compute 95% bootstrap confidence intervals for the mean time between failures <span class="math inline">\(1/\lambda\)</span> by the standard normal, basic, percentile, and BCa methods. Compare the intervals and explain why they may differ.</p>
</div>
<div id="answer-14" class="section level2">
<h2>Answer</h2>
<div class="sourceCode" id="cb88"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb88-1"><a href="#cb88-1"></a>boot.mean &lt;-<span class="st"> </span><span class="cf">function</span>(x,i){</span>
<span id="cb88-2"><a href="#cb88-2"></a>  <span class="kw">mean</span>(x[i])</span>
<span id="cb88-3"><a href="#cb88-3"></a>  }</span>
<span id="cb88-4"><a href="#cb88-4"></a></span>
<span id="cb88-5"><a href="#cb88-5"></a>redata &lt;-<span class="st"> </span><span class="kw">boot</span>(<span class="dt">data=</span>aircondit<span class="op">$</span>hours, <span class="dt">statistic=</span>boot.mean, <span class="dt">R =</span> <span class="fl">1e3</span>)</span>
<span id="cb88-6"><a href="#cb88-6"></a>result &lt;-<span class="st"> </span><span class="kw">boot.ci</span>(redata, <span class="dt">type=</span><span class="kw">c</span>(<span class="st">&quot;norm&quot;</span>,<span class="st">&quot;basic&quot;</span>,<span class="st">&quot;perc&quot;</span>,<span class="st">&quot;bca&quot;</span>))</span>
<span id="cb88-7"><a href="#cb88-7"></a><span class="kw">cbind</span>(<span class="dt">norm=</span>result<span class="op">$</span>norm[<span class="dv">2</span><span class="op">:</span><span class="dv">3</span>], <span class="dt">basic=</span>result<span class="op">$</span>basic[<span class="dv">4</span><span class="op">:</span><span class="dv">5</span>],</span>
<span id="cb88-8"><a href="#cb88-8"></a>      <span class="dt">percentile=</span>result<span class="op">$</span>percent[<span class="dv">4</span><span class="op">:</span><span class="dv">5</span>],<span class="dt">bca=</span>result<span class="op">$</span>bca[<span class="dv">4</span><span class="op">:</span><span class="dv">5</span>])</span></code></pre></div>
<pre><code>##           norm     basic percentile       bca
## [1,]  30.48835  15.59392   46.83333  56.58333
## [2,] 184.93865 169.33333  200.57275 236.75490</code></pre>
<p>Different methods may give a different result of confidence intervals. Because their hypothesis is different.</p>
<p>The standard normal method assumes that the parameter follows a normal distribution after standardization</p>
<p>The basic method assumes <span class="math inline">\(\hat\theta^*-\hat\theta|X \overset{d}{=}\hat\theta-\theta\)</span></p>
<p>The percentile method assumes <span class="math inline">\(\hat\theta^*|X \overset{d}{=}\hat\theta\)</span></p>
<p>The BCa method corrected the quantile of boot samples in the percentile method</p>
<p>Clear the memery</p>
<div class="sourceCode" id="cb90"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb90-1"><a href="#cb90-1"></a><span class="kw">rm</span>(<span class="dt">list =</span> <span class="kw">ls</span>())</span></code></pre></div>
</div>
<div id="question-7.a" class="section level2">
<h2>Question 7.A</h2>
<p>Conduct a Monte Carlo study to estimate the coverage probabilities of the standard normal bootstrap confidence interval, the basic bootstrap confidence interval, and the percentile confidence interval. Sample from a normal population and check the empirical coverage rates for the sample mean. Find the proportion of times that the confidence intervals miss on the left, and the proportion of times that the confidence intervals miss on the right.</p>
</div>
<div id="answer-15" class="section level2">
<h2>Answer</h2>
<p>Sample from a normal population N(0,1), which contains 20 numbers.</p>
<div class="sourceCode" id="cb91"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb91-1"><a href="#cb91-1"></a>n &lt;-<span class="st"> </span><span class="dv">20</span></span>
<span id="cb91-2"><a href="#cb91-2"></a>M &lt;-<span class="st"> </span><span class="fl">1e4</span></span>
<span id="cb91-3"><a href="#cb91-3"></a><span class="kw">set.seed</span>(<span class="dv">1</span>)</span>
<span id="cb91-4"><a href="#cb91-4"></a>boot.mean &lt;-<span class="st"> </span><span class="cf">function</span>(x,i) <span class="kw">mean</span>(x[i])</span>
<span id="cb91-5"><a href="#cb91-5"></a>result.norm &lt;-<span class="st"> </span>result.basic &lt;-<span class="st"> </span>result.perc &lt;-<span class="st"> </span><span class="kw">matrix</span>(<span class="ot">NA</span> ,M, <span class="dv">2</span>)</span>
<span id="cb91-6"><a href="#cb91-6"></a></span>
<span id="cb91-7"><a href="#cb91-7"></a><span class="cf">for</span>(i <span class="cf">in</span> <span class="dv">1</span><span class="op">:</span>M){</span>
<span id="cb91-8"><a href="#cb91-8"></a>  data =<span class="st"> </span><span class="kw">rnorm</span>(n, <span class="dv">0</span>, <span class="dv">1</span>)</span>
<span id="cb91-9"><a href="#cb91-9"></a>  de &lt;-<span class="st"> </span><span class="kw">boot</span>(<span class="dt">data=</span>data,<span class="dt">statistic=</span>boot.mean, <span class="dt">R =</span> <span class="fl">1e3</span>)</span>
<span id="cb91-10"><a href="#cb91-10"></a>  result &lt;-<span class="st"> </span><span class="kw">boot.ci</span>(de,<span class="dt">type=</span><span class="kw">c</span>(<span class="st">&quot;norm&quot;</span>,<span class="st">&quot;perc&quot;</span>,<span class="st">&quot;basic&quot;</span>))</span>
<span id="cb91-11"><a href="#cb91-11"></a>  result.norm[i,]&lt;-result<span class="op">$</span>norm[<span class="dv">2</span><span class="op">:</span><span class="dv">3</span>]</span>
<span id="cb91-12"><a href="#cb91-12"></a>  result.perc[i,]&lt;-result<span class="op">$</span>percent[<span class="dv">4</span><span class="op">:</span><span class="dv">5</span>]</span>
<span id="cb91-13"><a href="#cb91-13"></a>  result.basic[i,]&lt;-result<span class="op">$</span>basic[<span class="dv">4</span><span class="op">:</span><span class="dv">5</span>]</span>
<span id="cb91-14"><a href="#cb91-14"></a>}</span>
<span id="cb91-15"><a href="#cb91-15"></a><span class="kw">cat</span>(<span class="st">&#39;norm =&#39;</span>,<span class="kw">mean</span>(result.norm[,<span class="dv">1</span>]<span class="op">&lt;=</span><span class="dv">0</span> <span class="op">&amp;</span><span class="st"> </span>result.norm[,<span class="dv">2</span>]<span class="op">&gt;=</span><span class="dv">0</span>),</span>
<span id="cb91-16"><a href="#cb91-16"></a>    <span class="st">&#39;perc =&#39;</span>,<span class="kw">mean</span>(result.perc[,<span class="dv">1</span>]<span class="op">&lt;=</span><span class="dv">0</span> <span class="op">&amp;</span><span class="st"> </span>result.perc[,<span class="dv">2</span>]<span class="op">&gt;=</span><span class="dv">0</span>),</span>
<span id="cb91-17"><a href="#cb91-17"></a>    <span class="st">&#39;basic =&#39;</span>,<span class="kw">mean</span>(result.basic[,<span class="dv">1</span>]<span class="op">&lt;=</span><span class="dv">0</span> <span class="op">&amp;</span><span class="st"> </span>result.basic[,<span class="dv">2</span>]<span class="op">&gt;=</span><span class="dv">0</span>))</span></code></pre></div>
<pre><code>## norm = 0.9283 perc = 0.929 basic = 0.9286</code></pre>
<p>The proportion of times that the confidence intervals miss on the left/right.</p>
<div class="sourceCode" id="cb93"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb93-1"><a href="#cb93-1"></a><span class="kw">cat</span>(<span class="st">&#39;miss on the left: norm =&#39;</span>,<span class="kw">mean</span>(result.norm[,<span class="dv">1</span>]<span class="op">&gt;</span><span class="dv">0</span>), <span class="st">&#39;perc =&#39;</span>,<span class="kw">mean</span>(result.perc[,<span class="dv">1</span>]<span class="op">&gt;</span><span class="dv">0</span>), <span class="st">&#39;basic =&#39;</span>,<span class="kw">mean</span>(result.basic[,<span class="dv">1</span>]<span class="op">&gt;</span><span class="dv">0</span>))</span></code></pre></div>
<pre><code>## miss on the left: norm = 0.0357 perc = 0.0359 basic = 0.035</code></pre>
<div class="sourceCode" id="cb95"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb95-1"><a href="#cb95-1"></a><span class="kw">cat</span>(<span class="st">&#39;</span><span class="ch">\n</span><span class="st">miss on the right: norm =&#39;</span>,<span class="kw">mean</span>(result.norm[,<span class="dv">2</span>]<span class="op">&lt;</span><span class="dv">0</span>), <span class="st">&#39;perc =&#39;</span>,<span class="kw">mean</span>(result.perc[,<span class="dv">2</span>]<span class="op">&lt;</span><span class="dv">0</span>), <span class="st">&#39;basic =&#39;</span>,<span class="kw">mean</span>(result.basic[,<span class="dv">2</span>]<span class="op">&lt;</span><span class="dv">0</span>))</span></code></pre></div>
<pre><code>## 
## miss on the right: norm = 0.036 perc = 0.0351 basic = 0.0364</code></pre>
<div class="sourceCode" id="cb97"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb97-1"><a href="#cb97-1"></a><span class="kw">rm</span>(<span class="dt">list =</span> <span class="kw">ls</span>())</span></code></pre></div>
</div>
</div>
<div id="homework-6-2022-10-21" class="section level1">
<h1>homework 6: 2022-10-21</h1>
<div id="question-7.8" class="section level2">
<h2>Question 7.8</h2>
<p>Refer to Exercise 7.7. Obtain the jackknife estimates of bias and standard error of <span class="math inline">\(\hat \theta\)</span></p>
</div>
<div id="answer-16" class="section level2">
<h2>Answer</h2>
<div class="sourceCode" id="cb98"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb98-1"><a href="#cb98-1"></a>data =<span class="st"> </span>bootstrap<span class="op">::</span>scor</span>
<span id="cb98-2"><a href="#cb98-2"></a>n=<span class="dv">88</span></span></code></pre></div>
<p>calculate the estimation of the first principal component</p>
<div class="sourceCode" id="cb99"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb99-1"><a href="#cb99-1"></a>FPC &lt;-<span class="st"> </span><span class="cf">function</span>(x, i){</span>
<span id="cb99-2"><a href="#cb99-2"></a>  x =<span class="st"> </span>x[i,]</span>
<span id="cb99-3"><a href="#cb99-3"></a>  Sigma &lt;-<span class="st"> </span><span class="kw">cor</span>(x)</span>
<span id="cb99-4"><a href="#cb99-4"></a>  <span class="kw">eigen</span>(Sigma)<span class="op">$</span>values[<span class="dv">1</span>]<span class="op">/</span><span class="kw">sum</span>(<span class="kw">eigen</span>(Sigma)<span class="op">$</span>values)</span>
<span id="cb99-5"><a href="#cb99-5"></a>}</span>
<span id="cb99-6"><a href="#cb99-6"></a>theta.hat &lt;-<span class="st"> </span><span class="kw">FPC</span>(data, <span class="dv">1</span><span class="op">:</span>n)</span></code></pre></div>
<div class="sourceCode" id="cb100"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb100-1"><a href="#cb100-1"></a>theta.jack &lt;-<span class="st"> </span><span class="kw">numeric</span>(n)</span>
<span id="cb100-2"><a href="#cb100-2"></a><span class="cf">for</span>(i <span class="cf">in</span> <span class="dv">1</span><span class="op">:</span>n){</span>
<span id="cb100-3"><a href="#cb100-3"></a>  theta.jack[i] &lt;-<span class="st"> </span><span class="kw">FPC</span>(data,(<span class="dv">1</span><span class="op">:</span>n)[<span class="op">-</span>i])</span>
<span id="cb100-4"><a href="#cb100-4"></a>}</span>
<span id="cb100-5"><a href="#cb100-5"></a>se.jack &lt;-<span class="st"> </span><span class="kw">sqrt</span>((n<span class="dv">-1</span>)<span class="op">*</span><span class="kw">mean</span>((theta.jack<span class="op">-</span>theta.hat)<span class="op">^</span><span class="dv">2</span>))</span>
<span id="cb100-6"><a href="#cb100-6"></a>bias.jack &lt;-<span class="st"> </span>(n<span class="dv">-1</span>)<span class="op">*</span>(<span class="kw">mean</span>(theta.jack)<span class="op">-</span>theta.hat)</span>
<span id="cb100-7"><a href="#cb100-7"></a><span class="kw">round</span>(<span class="kw">c</span>(<span class="dt">est=</span>theta.hat,<span class="dt">bias=</span>bias.jack,</span>
<span id="cb100-8"><a href="#cb100-8"></a>        <span class="dt">se=</span>se.jack),<span class="dv">4</span>)</span></code></pre></div>
<pre><code>##     est    bias      se 
##  0.6362 -0.0004  0.0447</code></pre>
<div class="sourceCode" id="cb102"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb102-1"><a href="#cb102-1"></a><span class="kw">rm</span>(<span class="dt">list=</span><span class="kw">ls</span>()) </span></code></pre></div>
</div>
<div id="question-7.11" class="section level2">
<h2>Question 7.11</h2>
<p>In Example 7.18, leave-one-out (n-fold) cross validation was used to select the best fitting model. Use leave-two-out cross validation to compare the models</p>
</div>
<div id="answer-17" class="section level2">
<h2>Answer</h2>
<p>repeat Example 7.18</p>
<p>load data</p>
<div class="sourceCode" id="cb103"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb103-1"><a href="#cb103-1"></a><span class="kw">library</span>(DAAG); <span class="kw">attach</span>(ironslag)</span></code></pre></div>
<p>leave-one-out (n-fold) cross validation</p>
<div class="sourceCode" id="cb104"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb104-1"><a href="#cb104-1"></a>n &lt;-<span class="st"> </span><span class="kw">length</span>(magnetic) <span class="co">#in DAAG ironslag</span></span>
<span id="cb104-2"><a href="#cb104-2"></a>e1 &lt;-<span class="st"> </span>e2 &lt;-<span class="st"> </span>e3 &lt;-<span class="st"> </span>e4 &lt;-<span class="st"> </span><span class="kw">numeric</span>(n)</span>
<span id="cb104-3"><a href="#cb104-3"></a><span class="cf">for</span> (k <span class="cf">in</span> <span class="dv">1</span><span class="op">:</span>n) {</span>
<span id="cb104-4"><a href="#cb104-4"></a>  y &lt;-<span class="st"> </span>magnetic[<span class="op">-</span>k]</span>
<span id="cb104-5"><a href="#cb104-5"></a>  x &lt;-<span class="st"> </span>chemical[<span class="op">-</span>k]</span>
<span id="cb104-6"><a href="#cb104-6"></a>  J1 &lt;-<span class="st"> </span><span class="kw">lm</span>(y <span class="op">~</span><span class="st"> </span>x)</span>
<span id="cb104-7"><a href="#cb104-7"></a>  yhat1 &lt;-<span class="st"> </span>J1<span class="op">$</span>coef[<span class="dv">1</span>] <span class="op">+</span><span class="st"> </span>J1<span class="op">$</span>coef[<span class="dv">2</span>] <span class="op">*</span><span class="st"> </span>chemical[k]</span>
<span id="cb104-8"><a href="#cb104-8"></a>  e1[k] &lt;-<span class="st"> </span>magnetic[k] <span class="op">-</span><span class="st"> </span>yhat1</span>
<span id="cb104-9"><a href="#cb104-9"></a>  J2 &lt;-<span class="st"> </span><span class="kw">lm</span>(y <span class="op">~</span><span class="st"> </span>x <span class="op">+</span><span class="st"> </span><span class="kw">I</span>(x<span class="op">^</span><span class="dv">2</span>))</span>
<span id="cb104-10"><a href="#cb104-10"></a>  yhat2 &lt;-<span class="st"> </span>J2<span class="op">$</span>coef[<span class="dv">1</span>] <span class="op">+</span><span class="st"> </span>J2<span class="op">$</span>coef[<span class="dv">2</span>] <span class="op">*</span><span class="st"> </span>chemical[k] <span class="op">+</span></span>
<span id="cb104-11"><a href="#cb104-11"></a><span class="st">  </span>J2<span class="op">$</span>coef[<span class="dv">3</span>] <span class="op">*</span><span class="st"> </span>chemical[k]<span class="op">^</span><span class="dv">2</span></span>
<span id="cb104-12"><a href="#cb104-12"></a>  e2[k] &lt;-<span class="st"> </span>magnetic[k] <span class="op">-</span><span class="st"> </span>yhat2</span>
<span id="cb104-13"><a href="#cb104-13"></a>  J3 &lt;-<span class="st"> </span><span class="kw">lm</span>(<span class="kw">log</span>(y) <span class="op">~</span><span class="st"> </span>x)</span>
<span id="cb104-14"><a href="#cb104-14"></a>  logyhat3 &lt;-<span class="st"> </span>J3<span class="op">$</span>coef[<span class="dv">1</span>] <span class="op">+</span><span class="st"> </span>J3<span class="op">$</span>coef[<span class="dv">2</span>] <span class="op">*</span><span class="st"> </span>chemical[k]</span>
<span id="cb104-15"><a href="#cb104-15"></a>  yhat3 &lt;-<span class="st"> </span><span class="kw">exp</span>(logyhat3)</span>
<span id="cb104-16"><a href="#cb104-16"></a>  e3[k] &lt;-<span class="st"> </span>magnetic[k] <span class="op">-</span><span class="st"> </span>yhat3</span>
<span id="cb104-17"><a href="#cb104-17"></a>  J4 &lt;-<span class="st"> </span><span class="kw">lm</span>(<span class="kw">log</span>(y) <span class="op">~</span><span class="st"> </span><span class="kw">log</span>(x))</span>
<span id="cb104-18"><a href="#cb104-18"></a>  logyhat4 &lt;-<span class="st"> </span>J4<span class="op">$</span>coef[<span class="dv">1</span>] <span class="op">+</span><span class="st"> </span>J4<span class="op">$</span>coef[<span class="dv">2</span>] <span class="op">*</span><span class="st"> </span><span class="kw">log</span>(chemical[k])</span>
<span id="cb104-19"><a href="#cb104-19"></a>  yhat4 &lt;-<span class="st"> </span><span class="kw">exp</span>(logyhat4)</span>
<span id="cb104-20"><a href="#cb104-20"></a>  e4[k] &lt;-<span class="st"> </span>magnetic[k] <span class="op">-</span><span class="st"> </span>yhat4</span>
<span id="cb104-21"><a href="#cb104-21"></a>}</span></code></pre></div>
<div class="sourceCode" id="cb105"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb105-1"><a href="#cb105-1"></a><span class="kw">c</span>(<span class="kw">mean</span>(e1<span class="op">^</span><span class="dv">2</span>), <span class="kw">mean</span>(e2<span class="op">^</span><span class="dv">2</span>), <span class="kw">mean</span>(e3<span class="op">^</span><span class="dv">2</span>), <span class="kw">mean</span>(e4<span class="op">^</span><span class="dv">2</span>))</span></code></pre></div>
<pre><code>## [1] 19.55644 17.85248 18.44188 20.45424</code></pre>
<p>leave-two-out cross validation</p>
<div class="sourceCode" id="cb107"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb107-1"><a href="#cb107-1"></a>cross &lt;-<span class="st"> </span><span class="kw">combn</span>(n,<span class="dv">2</span>)</span>
<span id="cb107-2"><a href="#cb107-2"></a>e1 &lt;-<span class="st"> </span>e2 &lt;-<span class="st"> </span>e3 &lt;-<span class="st"> </span>e4 &lt;-<span class="st"> </span><span class="kw">numeric</span>(<span class="kw">dim</span>(cross)[<span class="dv">2</span>])</span>
<span id="cb107-3"><a href="#cb107-3"></a><span class="cf">for</span> (group <span class="cf">in</span> <span class="dv">1</span><span class="op">:</span><span class="kw">dim</span>(cross)[<span class="dv">2</span>]) {</span>
<span id="cb107-4"><a href="#cb107-4"></a>  k &lt;-<span class="st"> </span>cross[,group]</span>
<span id="cb107-5"><a href="#cb107-5"></a>  y &lt;-<span class="st"> </span>magnetic[<span class="op">-</span>k]</span>
<span id="cb107-6"><a href="#cb107-6"></a>  x &lt;-<span class="st"> </span>chemical[<span class="op">-</span>k]</span>
<span id="cb107-7"><a href="#cb107-7"></a>  J1 &lt;-<span class="st"> </span><span class="kw">lm</span>(y <span class="op">~</span><span class="st"> </span>x)</span>
<span id="cb107-8"><a href="#cb107-8"></a>  yhat1 &lt;-<span class="st"> </span>J1<span class="op">$</span>coef[<span class="dv">1</span>] <span class="op">+</span><span class="st"> </span>J1<span class="op">$</span>coef[<span class="dv">2</span>] <span class="op">*</span><span class="st"> </span>chemical[k]</span>
<span id="cb107-9"><a href="#cb107-9"></a>  e1[group] &lt;-<span class="st"> </span><span class="kw">mean</span>((magnetic[k] <span class="op">-</span><span class="st"> </span>yhat1)<span class="op">^</span><span class="dv">2</span>)</span>
<span id="cb107-10"><a href="#cb107-10"></a>  J2 &lt;-<span class="st"> </span><span class="kw">lm</span>(y <span class="op">~</span><span class="st"> </span>x <span class="op">+</span><span class="st"> </span><span class="kw">I</span>(x<span class="op">^</span><span class="dv">2</span>))</span>
<span id="cb107-11"><a href="#cb107-11"></a>  yhat2 &lt;-<span class="st"> </span>J2<span class="op">$</span>coef[<span class="dv">1</span>] <span class="op">+</span><span class="st"> </span>J2<span class="op">$</span>coef[<span class="dv">2</span>] <span class="op">*</span><span class="st"> </span>chemical[k] <span class="op">+</span></span>
<span id="cb107-12"><a href="#cb107-12"></a><span class="st">  </span>J2<span class="op">$</span>coef[<span class="dv">3</span>] <span class="op">*</span><span class="st"> </span>chemical[k]<span class="op">^</span><span class="dv">2</span></span>
<span id="cb107-13"><a href="#cb107-13"></a>  e2[group] &lt;-<span class="st"> </span><span class="kw">mean</span>((magnetic[k] <span class="op">-</span><span class="st"> </span>yhat2)<span class="op">^</span><span class="dv">2</span>)</span>
<span id="cb107-14"><a href="#cb107-14"></a>  J3 &lt;-<span class="st"> </span><span class="kw">lm</span>(<span class="kw">log</span>(y) <span class="op">~</span><span class="st"> </span>x)</span>
<span id="cb107-15"><a href="#cb107-15"></a>  logyhat3 &lt;-<span class="st"> </span>J3<span class="op">$</span>coef[<span class="dv">1</span>] <span class="op">+</span><span class="st"> </span>J3<span class="op">$</span>coef[<span class="dv">2</span>] <span class="op">*</span><span class="st"> </span>chemical[k]</span>
<span id="cb107-16"><a href="#cb107-16"></a>  yhat3 &lt;-<span class="st"> </span><span class="kw">exp</span>(logyhat3)</span>
<span id="cb107-17"><a href="#cb107-17"></a>  e3[group] &lt;-<span class="st"> </span><span class="kw">mean</span>((magnetic[k] <span class="op">-</span><span class="st"> </span>yhat3)<span class="op">^</span><span class="dv">2</span>)</span>
<span id="cb107-18"><a href="#cb107-18"></a>  J4 &lt;-<span class="st"> </span><span class="kw">lm</span>(<span class="kw">log</span>(y) <span class="op">~</span><span class="st"> </span><span class="kw">log</span>(x))</span>
<span id="cb107-19"><a href="#cb107-19"></a>  logyhat4 &lt;-<span class="st"> </span>J4<span class="op">$</span>coef[<span class="dv">1</span>] <span class="op">+</span><span class="st"> </span>J4<span class="op">$</span>coef[<span class="dv">2</span>] <span class="op">*</span><span class="st"> </span><span class="kw">log</span>(chemical[k])</span>
<span id="cb107-20"><a href="#cb107-20"></a>  yhat4 &lt;-<span class="st"> </span><span class="kw">exp</span>(logyhat4)</span>
<span id="cb107-21"><a href="#cb107-21"></a>  e4[group] &lt;-<span class="st"> </span><span class="kw">mean</span>((magnetic[k] <span class="op">-</span><span class="st"> </span>yhat4)<span class="op">^</span><span class="dv">2</span>)</span>
<span id="cb107-22"><a href="#cb107-22"></a>}</span></code></pre></div>
<p>Calculate the error. (The square had been calculated above, so here I don’t need to use <code>mean(e1^2)</code></p>
<div class="sourceCode" id="cb108"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb108-1"><a href="#cb108-1"></a><span class="kw">c</span>(<span class="kw">mean</span>(e1), <span class="kw">mean</span>(e2), <span class="kw">mean</span>(e3), <span class="kw">mean</span>(e4))</span></code></pre></div>
<pre><code>## [1] 19.57227 17.87018 18.45491 20.46718</code></pre>
<p>The result using leave-two-out cross validation is the same as the result using leave-one-out cross validation. The best fitting model is the second model, the quadratic model.</p>
<div class="sourceCode" id="cb110"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb110-1"><a href="#cb110-1"></a><span class="kw">lm</span>(magnetic <span class="op">~</span><span class="st"> </span>chemical <span class="op">+</span><span class="st"> </span><span class="kw">I</span>(chemical<span class="op">^</span><span class="dv">2</span>))</span></code></pre></div>
<pre><code>## 
## Call:
## lm(formula = magnetic ~ chemical + I(chemical^2))
## 
## Coefficients:
##   (Intercept)       chemical  I(chemical^2)  
##      24.49262       -1.39334        0.05452</code></pre>
<p><span class="math display">\[\hat Y = 24.49262 − 1.39334X + 0.05452X^2\]</span></p>
<div class="sourceCode" id="cb112"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb112-1"><a href="#cb112-1"></a><span class="kw">rm</span>(<span class="dt">list=</span><span class="kw">ls</span>()) </span></code></pre></div>
</div>
<div id="question-8.2" class="section level2">
<h2>Question 8.2</h2>
<p>Implement the bivariate Spearman rank correlation test for independence as a permutation test. The Spearman rank correlation test statistic can be obtained from function cor with method = “spearman”. Compare the achieved significance level of the permutation test with the p-value reported by cor.test on the same samples.</p>
</div>
<div id="answer-18" class="section level2">
<h2>Answer</h2>
<p>Use the iris data set. Select the species setosa (first 50 rows). X will be the variables sepal length and width (first 2 columns); Y will be the variables petal length and width (the 3rd and 4th columns).</p>
<div class="sourceCode" id="cb113"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb113-1"><a href="#cb113-1"></a><span class="kw">data</span>(data) </span>
<span id="cb113-2"><a href="#cb113-2"></a>iris &lt;-<span class="st"> </span>iris[<span class="dv">1</span><span class="op">:</span><span class="dv">50</span>,<span class="dv">1</span><span class="op">:</span><span class="dv">4</span>] <span class="co">#the species setosa</span></span></code></pre></div>
<div class="sourceCode" id="cb114"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb114-1"><a href="#cb114-1"></a>boot.rho &lt;-<span class="st"> </span><span class="cf">function</span>(data, i){</span>
<span id="cb114-2"><a href="#cb114-2"></a>  x &lt;-<span class="st"> </span><span class="kw">as.matrix</span>(data[ , <span class="dv">1</span><span class="op">:</span><span class="dv">2</span>])</span>
<span id="cb114-3"><a href="#cb114-3"></a>  y &lt;-<span class="st"> </span><span class="kw">as.matrix</span>(data[i, <span class="dv">3</span><span class="op">:</span><span class="dv">4</span>])</span>
<span id="cb114-4"><a href="#cb114-4"></a>  <span class="kw">cor.test</span>(x, y, <span class="dt">method =</span> <span class="st">&quot;spearman&quot;</span>, <span class="dt">exact =</span> <span class="ot">FALSE</span>)<span class="op">$</span>estimate</span>
<span id="cb114-5"><a href="#cb114-5"></a>}</span>
<span id="cb114-6"><a href="#cb114-6"></a>rho.hat &lt;-<span class="st"> </span><span class="kw">boot.rho</span>(iris, <span class="dv">1</span><span class="op">:</span><span class="dv">50</span>)</span>
<span id="cb114-7"><a href="#cb114-7"></a>rho.hat</span></code></pre></div>
<pre><code>##       rho 
## 0.8292811</code></pre>
<div class="sourceCode" id="cb116"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb116-1"><a href="#cb116-1"></a><span class="kw">library</span>(boot)</span>
<span id="cb116-2"><a href="#cb116-2"></a><span class="kw">set.seed</span>(<span class="dv">1</span>)</span>
<span id="cb116-3"><a href="#cb116-3"></a>boot.obj &lt;-<span class="st"> </span><span class="kw">boot</span>(<span class="dt">data =</span> iris, <span class="dt">statistic =</span> boot.rho, <span class="dt">R =</span> <span class="dv">9999</span>, <span class="dt">sim =</span> <span class="st">&quot;permutation&quot;</span>)</span>
<span id="cb116-4"><a href="#cb116-4"></a>p.perm &lt;-<span class="st"> </span><span class="kw">mean</span>(<span class="kw">c</span>(boot.obj<span class="op">$</span>t, boot.obj<span class="op">$</span>t0) <span class="op">&gt;</span><span class="st"> </span>rho.hat)</span>
<span id="cb116-5"><a href="#cb116-5"></a>p.perm</span></code></pre></div>
<pre><code>## [1] 0.0044</code></pre>
<p>the p-value reported by cor.test on the same samples is:</p>
<div class="sourceCode" id="cb118"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb118-1"><a href="#cb118-1"></a>test &lt;-<span class="st"> </span><span class="kw">cor.test</span>(<span class="kw">as.matrix</span>(iris[,<span class="dv">1</span><span class="op">:</span><span class="dv">2</span>]), <span class="kw">as.matrix</span>(iris[,<span class="dv">3</span><span class="op">:</span><span class="dv">4</span>]), <span class="dt">method =</span> <span class="st">&quot;spearman&quot;</span>, <span class="dt">exact =</span> <span class="ot">FALSE</span>)</span>
<span id="cb118-2"><a href="#cb118-2"></a>test<span class="op">$</span>p.value</span></code></pre></div>
<pre><code>## [1] 1.652371e-26</code></pre>
<p>The p value of permutation test with bivariate Spearman rank correlation is 0.0044</p>
<p>the p-value reported by cor.test is 1.652371e-26</p>
<div class="sourceCode" id="cb120"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb120-1"><a href="#cb120-1"></a><span class="kw">rm</span>(<span class="dt">list =</span> <span class="kw">ls</span>())</span></code></pre></div>
</div>
</div>
<div id="homework-7-2022-10-28" class="section level1">
<h1>homework 7: 2022-10-28</h1>
<div id="question-9.4" class="section level2">
<h2>Question 9.4</h2>
<p>Implement a random walk Metropolis sampler for generating the standard Laplace distribution (see Exercise 3.2). For the increment, simulate from a normal distribution. Compare the chains generated when different variances are used for the proposal distribution. Also, compute the acceptance rates of each chain.</p>
</div>
<div id="answer-19" class="section level2">
<h2>Answer</h2>
<p>The standard Laplace distribution <span class="math inline">\(f(x)=\frac{1}{2}e^{-abs(x)}\)</span></p>
<p>The 95% confidence interval is</p>
<div class="sourceCode" id="cb121"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb121-1"><a href="#cb121-1"></a>dl &lt;-<span class="st"> </span><span class="cf">function</span>(x){</span>
<span id="cb121-2"><a href="#cb121-2"></a>  <span class="kw">exp</span>(<span class="op">-</span><span class="kw">abs</span>(x))<span class="op">/</span><span class="dv">2</span></span>
<span id="cb121-3"><a href="#cb121-3"></a>}</span>
<span id="cb121-4"><a href="#cb121-4"></a></span>
<span id="cb121-5"><a href="#cb121-5"></a>lower &lt;-<span class="st"> </span><span class="kw">uniroot</span>(<span class="cf">function</span>(a) <span class="kw">integrate</span>(dl, <span class="op">-</span><span class="ot">Inf</span>, a)<span class="op">$</span>value<span class="fl">-0.025</span>, <span class="dt">lower=</span><span class="op">-</span><span class="dv">6</span>, <span class="dt">upper=</span><span class="dv">6</span>)<span class="op">$</span>root</span>
<span id="cb121-6"><a href="#cb121-6"></a>upper &lt;-<span class="st"> </span><span class="kw">uniroot</span>(<span class="cf">function</span>(a) <span class="kw">integrate</span>(dl, <span class="op">-</span><span class="ot">Inf</span>, a)<span class="op">$</span>value<span class="fl">-0.975</span>, <span class="dt">lower=</span><span class="op">-</span><span class="dv">6</span>, <span class="dt">upper=</span><span class="dv">6</span>)<span class="op">$</span>root</span>
<span id="cb121-7"><a href="#cb121-7"></a><span class="kw">c</span>(lower, upper)</span></code></pre></div>
<pre><code>## [1] -2.995733  2.995301</code></pre>
<p>Implement a random walk Metropolis sampler for generating the standard Laplace distribution. And according to the question given by TA, use the Gelman-Rubin method to monitor convergence of the chain, and run the chain until it converges approximately to the target distribution according to R &lt; 1.2.</p>
<p>Here I set the length of the chain no smaller than 3000 and no longer than 15000, whether or not it’s convergent before 3000 or it’s not convergent after 15000.</p>
<div class="sourceCode" id="cb123"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb123-1"><a href="#cb123-1"></a><span class="kw">set.seed</span>(<span class="dv">1</span>)</span>
<span id="cb123-2"><a href="#cb123-2"></a>Gelman.Rubin &lt;-<span class="st"> </span><span class="cf">function</span>(chain) {</span>
<span id="cb123-3"><a href="#cb123-3"></a>  chain &lt;-<span class="st"> </span><span class="kw">as.matrix</span>(chain)</span>
<span id="cb123-4"><a href="#cb123-4"></a>  l &lt;-<span class="st"> </span><span class="kw">ncol</span>(chain)</span>
<span id="cb123-5"><a href="#cb123-5"></a>  </span>
<span id="cb123-6"><a href="#cb123-6"></a>  B &lt;-<span class="st"> </span>l <span class="op">*</span><span class="st"> </span><span class="kw">var</span>(<span class="kw">rowMeans</span>(chain))       </span>
<span id="cb123-7"><a href="#cb123-7"></a>  chain.w &lt;-<span class="st"> </span><span class="kw">apply</span>(chain, <span class="dv">1</span>, <span class="st">&quot;var&quot;</span>) </span>
<span id="cb123-8"><a href="#cb123-8"></a>  W &lt;-<span class="st"> </span><span class="kw">mean</span>(chain.w)              </span>
<span id="cb123-9"><a href="#cb123-9"></a>  v.hat &lt;-<span class="st"> </span>W<span class="op">*</span>l<span class="op">/</span>(l<span class="dv">-1</span>) <span class="op">+</span><span class="st"> </span>(B<span class="op">/</span>l)   </span>
<span id="cb123-10"><a href="#cb123-10"></a>  r.hat &lt;-<span class="st"> </span>v.hat <span class="op">/</span><span class="st"> </span>W           </span>
<span id="cb123-11"><a href="#cb123-11"></a>  <span class="kw">return</span>(r.hat)</span>
<span id="cb123-12"><a href="#cb123-12"></a>}</span></code></pre></div>
<div class="sourceCode" id="cb124"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb124-1"><a href="#cb124-1"></a>Metropolis &lt;-<span class="st"> </span><span class="cf">function</span>(sigma, <span class="dt">x0=</span><span class="kw">c</span>(<span class="op">-</span><span class="dv">9</span>,<span class="op">-</span><span class="dv">3</span>,<span class="dv">3</span>,<span class="dv">9</span>), <span class="dt">N_max=</span><span class="dv">5000</span>) { <span class="co">#generate 4 chains to calculate R</span></span>
<span id="cb124-2"><a href="#cb124-2"></a>    x &lt;-<span class="st"> </span><span class="kw">matrix</span>(<span class="dv">0</span>, <span class="dt">nrow=</span><span class="dv">4</span>, <span class="dt">ncol=</span>N_max)</span>
<span id="cb124-3"><a href="#cb124-3"></a>    x[,<span class="dv">1</span>] &lt;-<span class="st"> </span>x0</span>
<span id="cb124-4"><a href="#cb124-4"></a>    acc =<span class="st"> </span><span class="dv">0</span></span>
<span id="cb124-5"><a href="#cb124-5"></a>    Rhat &lt;-<span class="st"> </span><span class="ot">NULL</span></span>
<span id="cb124-6"><a href="#cb124-6"></a>    <span class="kw">set.seed</span>(<span class="dv">1</span>)</span>
<span id="cb124-7"><a href="#cb124-7"></a>    <span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">2</span><span class="op">:</span>N_max) {</span>
<span id="cb124-8"><a href="#cb124-8"></a>        y &lt;-<span class="st"> </span><span class="kw">c</span>(<span class="kw">rnorm</span>(<span class="dv">1</span>, x[<span class="dv">1</span>,i<span class="dv">-1</span>], sigma),<span class="kw">rnorm</span>(<span class="dv">1</span>, x[<span class="dv">2</span>,i<span class="dv">-1</span>], sigma),<span class="kw">rnorm</span>(<span class="dv">1</span>, x[<span class="dv">3</span>,i<span class="dv">-1</span>], sigma),<span class="kw">rnorm</span>(<span class="dv">1</span>, x[<span class="dv">4</span>,i<span class="dv">-1</span>], sigma))</span>
<span id="cb124-9"><a href="#cb124-9"></a>        u &lt;-<span class="st"> </span><span class="kw">runif</span>(<span class="dv">1</span>)</span>
<span id="cb124-10"><a href="#cb124-10"></a>        <span class="cf">for</span>(k <span class="cf">in</span> <span class="dv">1</span><span class="op">:</span><span class="dv">4</span>){</span>
<span id="cb124-11"><a href="#cb124-11"></a>          <span class="cf">if</span> (u <span class="op">&lt;=</span><span class="st"> </span>(<span class="kw">dl</span>(y[k]) <span class="op">/</span><span class="st"> </span><span class="kw">dl</span>(x[k,i<span class="dv">-1</span>]))){</span>
<span id="cb124-12"><a href="#cb124-12"></a>            x[k,i] &lt;-<span class="st"> </span>y[k]</span>
<span id="cb124-13"><a href="#cb124-13"></a>            acc &lt;-<span class="st"> </span>acc <span class="op">+</span><span class="st"> </span><span class="dv">1</span></span>
<span id="cb124-14"><a href="#cb124-14"></a>          }</span>
<span id="cb124-15"><a href="#cb124-15"></a>          <span class="cf">else</span> x[k,i] &lt;-<span class="st"> </span>x[k,i<span class="dv">-1</span>]</span>
<span id="cb124-16"><a href="#cb124-16"></a>        }</span>
<span id="cb124-17"><a href="#cb124-17"></a>        <span class="co"># calculate Rhat</span></span>
<span id="cb124-18"><a href="#cb124-18"></a>        psi &lt;-<span class="st"> </span><span class="kw">t</span>(<span class="kw">apply</span>(x[,<span class="dv">1</span><span class="op">:</span>i], <span class="dv">1</span>, cumsum))<span class="co">#compute diagnostic statistics</span></span>
<span id="cb124-19"><a href="#cb124-19"></a>        <span class="cf">for</span> (k <span class="cf">in</span> <span class="dv">1</span><span class="op">:</span><span class="kw">nrow</span>(psi))</span>
<span id="cb124-20"><a href="#cb124-20"></a>            psi[k,] &lt;-<span class="st"> </span>psi[k,] <span class="op">/</span><span class="st"> </span>(<span class="dv">1</span><span class="op">:</span><span class="kw">ncol</span>(psi))</span>
<span id="cb124-21"><a href="#cb124-21"></a>        Rhat &lt;-<span class="st"> </span><span class="kw">c</span>(Rhat, <span class="kw">Gelman.Rubin</span>(psi))</span>
<span id="cb124-22"><a href="#cb124-22"></a>        <span class="cf">if</span>((i <span class="op">&gt;=</span><span class="st"> </span><span class="dv">3000</span>) <span class="op">&amp;</span><span class="st"> </span>(Rhat[i<span class="dv">-1</span>]<span class="op">&lt;</span><span class="fl">1.2</span>)) <span class="cf">break</span></span>
<span id="cb124-23"><a href="#cb124-23"></a>        </span>
<span id="cb124-24"><a href="#cb124-24"></a></span>
<span id="cb124-25"><a href="#cb124-25"></a>    }</span>
<span id="cb124-26"><a href="#cb124-26"></a>    <span class="kw">return</span>(<span class="kw">list</span>(<span class="dt">x=</span>x[,<span class="dv">1</span><span class="op">:</span>i], <span class="dt">acc=</span>acc<span class="op">/</span><span class="dv">4</span><span class="op">/</span>i, <span class="dt">Rhat=</span>Rhat))</span>
<span id="cb124-27"><a href="#cb124-27"></a>}</span></code></pre></div>
<div class="sourceCode" id="cb125"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb125-1"><a href="#cb125-1"></a>sigma &lt;-<span class="st"> </span><span class="kw">c</span>(<span class="fl">0.05</span>, <span class="fl">0.5</span>, <span class="dv">2</span>, <span class="dv">9</span>)</span>
<span id="cb125-2"><a href="#cb125-2"></a>chain1 &lt;-<span class="st"> </span><span class="kw">Metropolis</span>(sigma[<span class="dv">1</span>])</span>
<span id="cb125-3"><a href="#cb125-3"></a>chain2 &lt;-<span class="st"> </span><span class="kw">Metropolis</span>(sigma[<span class="dv">2</span>])</span>
<span id="cb125-4"><a href="#cb125-4"></a>chain3 &lt;-<span class="st"> </span><span class="kw">Metropolis</span>(sigma[<span class="dv">3</span>])</span>
<span id="cb125-5"><a href="#cb125-5"></a>chain4 &lt;-<span class="st"> </span><span class="kw">Metropolis</span>(sigma[<span class="dv">4</span>])</span></code></pre></div>
<div class="sourceCode" id="cb126"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb126-1"><a href="#cb126-1"></a><span class="co">#number of candidate points rejected</span></span>
<span id="cb126-2"><a href="#cb126-2"></a>acc.r &lt;-<span class="st"> </span><span class="kw">data.frame</span>(<span class="dt">sigma=</span>sigma,</span>
<span id="cb126-3"><a href="#cb126-3"></a>                    <span class="dt">acceptance.rates=</span><span class="kw">c</span>(chain1<span class="op">$</span>acc, chain2<span class="op">$</span>acc, chain3<span class="op">$</span>acc, chain4<span class="op">$</span>acc),</span>
<span id="cb126-4"><a href="#cb126-4"></a>                    <span class="dt">convergent.length=</span><span class="kw">c</span>(<span class="kw">sum</span>(chain1<span class="op">$</span>R<span class="op">&gt;</span><span class="fl">1.2</span>)<span class="op">+</span><span class="dv">1</span>, <span class="kw">sum</span>(chain2<span class="op">$</span>R<span class="op">&gt;</span><span class="fl">1.2</span>)<span class="op">+</span><span class="dv">1</span>, <span class="kw">sum</span>(chain3<span class="op">$</span>R<span class="op">&gt;</span><span class="fl">1.2</span>)<span class="op">+</span><span class="dv">1</span>, <span class="kw">sum</span>(chain4<span class="op">$</span>R<span class="op">&gt;</span><span class="fl">1.2</span>)<span class="op">+</span><span class="dv">1</span>))</span>
<span id="cb126-5"><a href="#cb126-5"></a></span>
<span id="cb126-6"><a href="#cb126-6"></a>acc.r</span></code></pre></div>
<p>We can see the acceptance rate becomes smaller when sigma becomes larger. And when sigma=0.05, the chain doesn’t convergent(R&lt;1.2) in 5000 epochs; When sigma=0.5,2,9, the chain convergent in 13446, 843, 1219 epochs.</p>
<p>plot the chains(each sigma choose one chain to plot)</p>
<div class="sourceCode" id="cb127"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb127-1"><a href="#cb127-1"></a><span class="kw">par</span>(<span class="dt">mfrow =</span> <span class="kw">c</span>(<span class="dv">2</span>, <span class="dv">2</span>))</span>
<span id="cb127-2"><a href="#cb127-2"></a><span class="kw">plot</span>(chain1<span class="op">$</span>x[<span class="dv">1</span>,], <span class="dt">type=</span><span class="st">&quot;l&quot;</span>, <span class="dt">xlab=</span><span class="st">&#39;sigma=0.05&#39;</span>)</span>
<span id="cb127-3"><a href="#cb127-3"></a><span class="kw">abline</span>(<span class="dt">h=</span><span class="kw">c</span>(lower, upper))</span>
<span id="cb127-4"><a href="#cb127-4"></a><span class="kw">plot</span>(chain2<span class="op">$</span>x[<span class="dv">1</span>,], <span class="dt">type=</span><span class="st">&quot;l&quot;</span>, <span class="dt">xlab=</span><span class="st">&#39;sigma=0.5&#39;</span>)</span>
<span id="cb127-5"><a href="#cb127-5"></a><span class="kw">abline</span>(<span class="dt">h=</span><span class="kw">c</span>(lower, upper))</span>
<span id="cb127-6"><a href="#cb127-6"></a><span class="kw">plot</span>(chain3<span class="op">$</span>x[<span class="dv">1</span>,], <span class="dt">type=</span><span class="st">&quot;l&quot;</span>, <span class="dt">xlab=</span><span class="st">&#39;sigma=2&#39;</span>)</span>
<span id="cb127-7"><a href="#cb127-7"></a><span class="kw">abline</span>(<span class="dt">h=</span><span class="kw">c</span>(lower, upper))</span>
<span id="cb127-8"><a href="#cb127-8"></a><span class="kw">plot</span>(chain4<span class="op">$</span>x[<span class="dv">1</span>,], <span class="dt">type=</span><span class="st">&quot;l&quot;</span>, <span class="dt">xlab=</span><span class="st">&#39;sigma=9&#39;</span>)</span>
<span id="cb127-9"><a href="#cb127-9"></a><span class="kw">abline</span>(<span class="dt">h=</span><span class="kw">c</span>(lower, upper))</span></code></pre></div>
<p>When sigma=0.05(too small), the chain can’t achieve stationarity quickly. When sigma=9(too large), the acceptance rate is low, it is convergent slowly. So I think sigma=2 is the best.</p>
<p>Plot the R.hat value calculating from the Gelman-Rubin method</p>
<div class="sourceCode" id="cb128"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb128-1"><a href="#cb128-1"></a><span class="kw">par</span>(<span class="dt">mfrow =</span> <span class="kw">c</span>(<span class="dv">2</span>, <span class="dv">2</span>))</span>
<span id="cb128-2"><a href="#cb128-2"></a><span class="kw">plot</span>(chain1<span class="op">$</span>Rhat[<span class="op">-</span><span class="kw">c</span>(<span class="dv">1</span><span class="op">:</span><span class="dv">500</span>)], <span class="dt">type=</span><span class="st">&quot;l&quot;</span>, <span class="dt">xlab=</span><span class="kw">bquote</span>(sigma <span class="op">==</span><span class="st"> </span>.(<span class="kw">round</span>(sigma[<span class="dv">1</span>],<span class="dv">3</span>))), <span class="dt">ylab=</span><span class="st">&quot;R&quot;</span>)</span>
<span id="cb128-3"><a href="#cb128-3"></a><span class="kw">abline</span>(<span class="dt">h=</span><span class="fl">1.2</span>, <span class="dt">lty=</span><span class="dv">2</span>)</span>
<span id="cb128-4"><a href="#cb128-4"></a><span class="kw">plot</span>(chain2<span class="op">$</span>Rhat[<span class="op">-</span><span class="kw">c</span>(<span class="dv">1</span><span class="op">:</span><span class="dv">500</span>)], <span class="dt">type=</span><span class="st">&quot;l&quot;</span>, <span class="dt">xlab=</span><span class="kw">bquote</span>(sigma <span class="op">==</span><span class="st"> </span>.(<span class="kw">round</span>(sigma[<span class="dv">2</span>],<span class="dv">3</span>))), <span class="dt">ylab=</span><span class="st">&quot;R&quot;</span>)</span>
<span id="cb128-5"><a href="#cb128-5"></a><span class="kw">abline</span>(<span class="dt">h=</span><span class="fl">1.2</span>, <span class="dt">lty=</span><span class="dv">2</span>)</span>
<span id="cb128-6"><a href="#cb128-6"></a><span class="kw">plot</span>(chain3<span class="op">$</span>Rhat[<span class="op">-</span><span class="kw">c</span>(<span class="dv">1</span><span class="op">:</span><span class="dv">300</span>)], <span class="dt">type=</span><span class="st">&quot;l&quot;</span>, <span class="dt">xlab=</span><span class="kw">bquote</span>(sigma <span class="op">==</span><span class="st"> </span>.(<span class="kw">round</span>(sigma[<span class="dv">3</span>],<span class="dv">3</span>))), <span class="dt">ylab=</span><span class="st">&quot;R&quot;</span>)</span>
<span id="cb128-7"><a href="#cb128-7"></a><span class="kw">abline</span>(<span class="dt">h=</span><span class="fl">1.2</span>, <span class="dt">lty=</span><span class="dv">2</span>)</span>
<span id="cb128-8"><a href="#cb128-8"></a><span class="kw">plot</span>(chain4<span class="op">$</span>Rhat[<span class="op">-</span><span class="kw">c</span>(<span class="dv">1</span><span class="op">:</span><span class="dv">300</span>)], <span class="dt">type=</span><span class="st">&quot;l&quot;</span>, <span class="dt">xlab=</span><span class="kw">bquote</span>(sigma <span class="op">==</span><span class="st"> </span>.(<span class="kw">round</span>(sigma[<span class="dv">4</span>],<span class="dv">3</span>))), <span class="dt">ylab=</span><span class="st">&quot;R&quot;</span>)</span>
<span id="cb128-9"><a href="#cb128-9"></a><span class="kw">abline</span>(<span class="dt">h=</span><span class="fl">1.2</span>, <span class="dt">lty=</span><span class="dv">2</span>)</span></code></pre></div>
<div class="sourceCode" id="cb129"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb129-1"><a href="#cb129-1"></a><span class="kw">rm</span>(<span class="dt">list=</span><span class="kw">ls</span>())</span></code></pre></div>
</div>
<div id="question-9.7" class="section level2">
<h2>Question 9.7</h2>
<p>Implement a Gibbs sampler to generate a bivariate normal chain <span class="math inline">\(X_t, Y_t\)</span> with zero means, unit standard deviations, and correlation 0.9. Plot the generated sample after discarding a suitable burn-in sample. Fit a simple linear regression model <span class="math inline">\(Y=\beta_0+\beta_1 X\)</span> to the sample and check the residuals of the model for normality and constant variance.</p>
</div>
<div id="answer-20" class="section level2">
<h2>Answer</h2>
<p>Use Gibbs sampler to generate the bivariate normal chain. Also, <span class="math inline">\(\hat R\)</span> is calculated in the same way above.</p>
<p>The same as Question 9.4, here I set the length of the chain no smaller than 3000 and no longer than 15000, whether or not it’s convergent before 3000 or it’s not convergent after 15000.</p>
<div class="sourceCode" id="cb130"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb130-1"><a href="#cb130-1"></a>N_max &lt;-<span class="st"> </span><span class="dv">15000</span> <span class="co">#max length of chain</span></span>
<span id="cb130-2"><a href="#cb130-2"></a>k &lt;-<span class="st"> </span><span class="dv">4</span> <span class="co">#number of chains</span></span>
<span id="cb130-3"><a href="#cb130-3"></a>burn &lt;-<span class="st"> </span><span class="dv">1000</span> <span class="co">#burn-in length</span></span>
<span id="cb130-4"><a href="#cb130-4"></a>X1 &lt;-<span class="st"> </span><span class="kw">matrix</span>(<span class="dv">0</span>, <span class="dt">nrow=</span><span class="dv">4</span>, <span class="dt">ncol=</span>N_max) <span class="co">#the 1st dimension of the bivariate normal chain</span></span>
<span id="cb130-5"><a href="#cb130-5"></a>X2 &lt;-<span class="st"> </span><span class="kw">matrix</span>(<span class="dv">0</span>, <span class="dt">nrow=</span><span class="dv">4</span>, <span class="dt">ncol=</span>N_max) <span class="co">#the 2rd dimension of the bivariate normal chain</span></span>
<span id="cb130-6"><a href="#cb130-6"></a>rho &lt;-<span class="st"> </span><span class="fl">0.9</span> <span class="co">#correlation</span></span>
<span id="cb130-7"><a href="#cb130-7"></a>mu1 &lt;-<span class="st"> </span>mu2 &lt;-<span class="st"> </span><span class="dv">0</span></span>
<span id="cb130-8"><a href="#cb130-8"></a>sigma1 &lt;-<span class="st"> </span>sigma2 &lt;-<span class="st"> </span><span class="dv">1</span></span>
<span id="cb130-9"><a href="#cb130-9"></a>s1 &lt;-<span class="st"> </span><span class="kw">sqrt</span>(<span class="dv">1</span><span class="op">-</span>rho<span class="op">^</span><span class="dv">2</span>)<span class="op">*</span>sigma1</span>
<span id="cb130-10"><a href="#cb130-10"></a>s2 &lt;-<span class="st"> </span><span class="kw">sqrt</span>(<span class="dv">1</span><span class="op">-</span>rho<span class="op">^</span><span class="dv">2</span>)<span class="op">*</span>sigma2</span>
<span id="cb130-11"><a href="#cb130-11"></a>Rhat &lt;-<span class="st"> </span><span class="ot">NULL</span></span>
<span id="cb130-12"><a href="#cb130-12"></a></span>
<span id="cb130-13"><a href="#cb130-13"></a></span>
<span id="cb130-14"><a href="#cb130-14"></a>Gelman.Rubin &lt;-<span class="st"> </span><span class="cf">function</span>(chain) {</span>
<span id="cb130-15"><a href="#cb130-15"></a>  chain &lt;-<span class="st"> </span><span class="kw">as.matrix</span>(chain)</span>
<span id="cb130-16"><a href="#cb130-16"></a>  l &lt;-<span class="st"> </span><span class="kw">ncol</span>(chain)</span>
<span id="cb130-17"><a href="#cb130-17"></a>  </span>
<span id="cb130-18"><a href="#cb130-18"></a>  B &lt;-<span class="st"> </span>l <span class="op">*</span><span class="st"> </span><span class="kw">var</span>(<span class="kw">rowMeans</span>(chain))       </span>
<span id="cb130-19"><a href="#cb130-19"></a>  chain.w &lt;-<span class="st"> </span><span class="kw">apply</span>(chain, <span class="dv">1</span>, <span class="st">&quot;var&quot;</span>) </span>
<span id="cb130-20"><a href="#cb130-20"></a>  W &lt;-<span class="st"> </span><span class="kw">mean</span>(chain.w)              </span>
<span id="cb130-21"><a href="#cb130-21"></a>  v.hat &lt;-<span class="st"> </span>W<span class="op">*</span>l<span class="op">/</span>(l<span class="dv">-1</span>) <span class="op">+</span><span class="st"> </span>(B<span class="op">/</span>l)   </span>
<span id="cb130-22"><a href="#cb130-22"></a>  r.hat &lt;-<span class="st"> </span>v.hat <span class="op">/</span><span class="st"> </span>W           </span>
<span id="cb130-23"><a href="#cb130-23"></a>  <span class="kw">return</span>(r.hat)</span>
<span id="cb130-24"><a href="#cb130-24"></a>}</span>
<span id="cb130-25"><a href="#cb130-25"></a></span>
<span id="cb130-26"><a href="#cb130-26"></a></span>
<span id="cb130-27"><a href="#cb130-27"></a><span class="co">#generate the chain</span></span>
<span id="cb130-28"><a href="#cb130-28"></a><span class="kw">set.seed</span>(<span class="dv">1</span>)</span>
<span id="cb130-29"><a href="#cb130-29"></a>X1[,<span class="dv">1</span>] &lt;-<span class="st"> </span><span class="kw">c</span>(<span class="op">-</span><span class="dv">5</span>,<span class="op">-</span><span class="dv">2</span>,<span class="dv">2</span>,<span class="dv">5</span>) <span class="co">#initialize</span></span>
<span id="cb130-30"><a href="#cb130-30"></a>X2[,<span class="dv">1</span>] &lt;-<span class="st"> </span><span class="kw">c</span>(<span class="op">-</span><span class="dv">5</span>,<span class="op">-</span><span class="dv">2</span>,<span class="dv">2</span>,<span class="dv">5</span>) <span class="co">#initialize</span></span>
<span id="cb130-31"><a href="#cb130-31"></a><span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">2</span><span class="op">:</span>N_max) { <span class="co">#calculate R with Gelman-Rubin method</span></span>
<span id="cb130-32"><a href="#cb130-32"></a>  <span class="cf">for</span> (k <span class="cf">in</span> <span class="dv">1</span><span class="op">:</span><span class="dv">4</span>){</span>
<span id="cb130-33"><a href="#cb130-33"></a>    x2 &lt;-<span class="st"> </span>X2[k,i<span class="dv">-1</span>]</span>
<span id="cb130-34"><a href="#cb130-34"></a>    m1 &lt;-<span class="st"> </span>mu1 <span class="op">+</span><span class="st"> </span>rho <span class="op">*</span><span class="st"> </span>(x2 <span class="op">-</span><span class="st"> </span>mu2) <span class="op">*</span><span class="st"> </span>sigma1<span class="op">/</span>sigma2</span>
<span id="cb130-35"><a href="#cb130-35"></a>    X1[k,i] &lt;-<span class="st"> </span><span class="kw">rnorm</span>(<span class="dv">1</span>, m1, s1)</span>
<span id="cb130-36"><a href="#cb130-36"></a>    x1 &lt;-<span class="st"> </span>X1[k,i]</span>
<span id="cb130-37"><a href="#cb130-37"></a>    m2 &lt;-<span class="st"> </span>mu2 <span class="op">+</span><span class="st"> </span>rho <span class="op">*</span><span class="st"> </span>(x1 <span class="op">-</span><span class="st"> </span>mu1) <span class="op">*</span><span class="st"> </span>sigma2<span class="op">/</span>sigma1</span>
<span id="cb130-38"><a href="#cb130-38"></a>    X2[k,i] &lt;-<span class="st"> </span><span class="kw">rnorm</span>(<span class="dv">1</span>, m2, s2)</span>
<span id="cb130-39"><a href="#cb130-39"></a>  }</span>
<span id="cb130-40"><a href="#cb130-40"></a>  </span>
<span id="cb130-41"><a href="#cb130-41"></a>  <span class="co"># calculate Rhat</span></span>
<span id="cb130-42"><a href="#cb130-42"></a>  <span class="co"># compute diagnostic statistics</span></span>
<span id="cb130-43"><a href="#cb130-43"></a>  <span class="cf">if</span>(i<span class="op">&gt;</span>burn){</span>
<span id="cb130-44"><a href="#cb130-44"></a>    psi1 &lt;-<span class="st"> </span><span class="kw">t</span>(<span class="kw">apply</span>(X1[,<span class="dv">1</span><span class="op">:</span>i], <span class="dv">1</span>, cumsum))</span>
<span id="cb130-45"><a href="#cb130-45"></a>    psi2 &lt;-<span class="st"> </span><span class="kw">t</span>(<span class="kw">apply</span>(X2[,<span class="dv">1</span><span class="op">:</span>i], <span class="dv">1</span>, cumsum))</span>
<span id="cb130-46"><a href="#cb130-46"></a>    psi &lt;-<span class="st"> </span>(psi1<span class="op">+</span>psi2)<span class="op">/</span><span class="dv">2</span></span>
<span id="cb130-47"><a href="#cb130-47"></a>    <span class="cf">for</span> (k <span class="cf">in</span> <span class="dv">1</span><span class="op">:</span><span class="kw">nrow</span>(psi))</span>
<span id="cb130-48"><a href="#cb130-48"></a>        psi[k,] &lt;-<span class="st"> </span>psi[k,] <span class="op">/</span><span class="st"> </span>(<span class="dv">1</span><span class="op">:</span><span class="kw">ncol</span>(psi))</span>
<span id="cb130-49"><a href="#cb130-49"></a>    Rhat &lt;-<span class="st"> </span><span class="kw">c</span>(Rhat, <span class="kw">Gelman.Rubin</span>(psi))</span>
<span id="cb130-50"><a href="#cb130-50"></a>    <span class="cf">if</span>((i <span class="op">&gt;=</span><span class="st"> </span><span class="dv">3000</span>) <span class="op">&amp;</span><span class="st"> </span>(Rhat[i<span class="op">-</span>burn]<span class="op">&lt;</span><span class="fl">1.2</span>)) <span class="cf">break</span></span>
<span id="cb130-51"><a href="#cb130-51"></a>  }</span>
<span id="cb130-52"><a href="#cb130-52"></a>}</span>
<span id="cb130-53"><a href="#cb130-53"></a></span>
<span id="cb130-54"><a href="#cb130-54"></a>X1 &lt;-<span class="st"> </span>X1[<span class="dv">1</span>, (burn<span class="op">+</span><span class="dv">1</span>)<span class="op">:</span>i]</span>
<span id="cb130-55"><a href="#cb130-55"></a>X2 &lt;-<span class="st"> </span>X2[<span class="dv">1</span>, (burn<span class="op">+</span><span class="dv">1</span>)<span class="op">:</span>i]</span></code></pre></div>
<div class="sourceCode" id="cb131"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb131-1"><a href="#cb131-1"></a><span class="kw">sum</span>(Rhat<span class="op">&gt;</span><span class="fl">1.2</span>)</span></code></pre></div>
<pre><code>## [1] 98</code></pre>
<p>The chain convergent (R&lt;1.2) in epochs 98 after the burn-in numbers.</p>
<div class="sourceCode" id="cb133"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb133-1"><a href="#cb133-1"></a><span class="kw">plot</span>(Rhat, <span class="dt">type=</span><span class="st">&quot;l&quot;</span>, <span class="dt">ylab=</span><span class="st">&quot;R&quot;</span>)</span>
<span id="cb133-2"><a href="#cb133-2"></a><span class="kw">abline</span>(<span class="dt">h=</span><span class="fl">1.2</span>, <span class="dt">lty=</span><span class="dv">2</span>)</span></code></pre></div>
<p><img src="data:image/png;base64,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" /><!-- --></p>
<p>Fit a simple linear regression mode</p>
<div class="sourceCode" id="cb134"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb134-1"><a href="#cb134-1"></a>fm &lt;-<span class="st"> </span><span class="kw">lm</span>(X2 <span class="op">~</span><span class="st"> </span>X1)</span>
<span id="cb134-2"><a href="#cb134-2"></a>coef &lt;-<span class="st"> </span><span class="kw">summary</span>(fm)<span class="op">$</span>coef</span>
<span id="cb134-3"><a href="#cb134-3"></a>coef[,<span class="dv">1</span>]</span></code></pre></div>
<pre><code>## (Intercept)          X1 
## 0.009011883 0.896465192</code></pre>
<p><span class="math inline">\(Y=0.009+0.896X\)</span></p>
<p>Then residual analysis.</p>
<div class="sourceCode" id="cb136"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb136-1"><a href="#cb136-1"></a>res &lt;-<span class="st"> </span>X2 <span class="op">-</span><span class="st"> </span>coef[<span class="dv">1</span>,<span class="dv">1</span>] <span class="op">-</span><span class="st"> </span>coef[<span class="dv">2</span>,<span class="dv">1</span>]<span class="op">*</span>X1</span>
<span id="cb136-2"><a href="#cb136-2"></a><span class="kw">plot</span>(X1, res, <span class="dt">main=</span><span class="st">&#39;residual&#39;</span>)</span></code></pre></div>
<p><img src="data:image/png;base64,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" /><!-- --></p>
<p>check the residuals of the model for normality</p>
<div class="sourceCode" id="cb137"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb137-1"><a href="#cb137-1"></a><span class="kw">qqnorm</span>(res)</span></code></pre></div>
<p><img src="data:image/png;base64,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" /><!-- --></p>
<div class="sourceCode" id="cb138"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb138-1"><a href="#cb138-1"></a><span class="kw">ks.test</span>(res,<span class="st">&quot;pnorm&quot;</span>,<span class="dt">mean=</span><span class="kw">mean</span>(res),<span class="dt">sd=</span><span class="kw">sqrt</span>(<span class="kw">var</span>(res)))</span></code></pre></div>
<pre><code>## 
##  One-sample Kolmogorov-Smirnov test
## 
## data:  res
## D = 0.010294, p-value = 0.9839
## alternative hypothesis: two-sided</code></pre>
<p>p-value = 0.9839, the residuals of the model is considered normal.</p>
<p>Divide X1 into 6 groups to check the residuals of the model forconstant variance.</p>
<div class="sourceCode" id="cb140"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb140-1"><a href="#cb140-1"></a><span class="kw">require</span>(graphics)</span>
<span id="cb140-2"><a href="#cb140-2"></a>group &lt;-<span class="st"> </span>X1</span>
<span id="cb140-3"><a href="#cb140-3"></a>group[group <span class="op">&lt;</span><span class="st"> </span><span class="dv">-2</span>] =<span class="st"> </span><span class="dv">1</span></span>
<span id="cb140-4"><a href="#cb140-4"></a>group[group <span class="op">&lt;</span><span class="st"> </span><span class="dv">-1</span>] =<span class="st"> </span><span class="dv">2</span></span>
<span id="cb140-5"><a href="#cb140-5"></a>group[group <span class="op">&lt;</span><span class="st"> </span><span class="dv">0</span>] =<span class="st"> </span><span class="dv">3</span></span>
<span id="cb140-6"><a href="#cb140-6"></a>group[group <span class="op">&lt;</span><span class="st"> </span><span class="dv">1</span>] =<span class="st"> </span><span class="dv">4</span></span>
<span id="cb140-7"><a href="#cb140-7"></a>group[group <span class="op">&lt;</span><span class="st"> </span><span class="dv">2</span>] =<span class="st"> </span><span class="dv">5</span></span>
<span id="cb140-8"><a href="#cb140-8"></a>group[X1 <span class="op">&gt;</span><span class="st"> </span><span class="dv">2</span>] =<span class="st"> </span><span class="dv">6</span></span>
<span id="cb140-9"><a href="#cb140-9"></a><span class="kw">bartlett.test</span>(res <span class="op">~</span><span class="st"> </span>group)</span></code></pre></div>
<pre><code>## 
##  Bartlett test of homogeneity of variances
## 
## data:  res by group
## Bartlett&#39;s K-squared = 0.63209, df = 4, p-value = 0.9594</code></pre>
<p>p-value = 0.9594, the residuals of the model is constant variance.</p>
<p>In conclusion, the Gibbs sampler seems OK.</p>
<div class="sourceCode" id="cb142"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb142-1"><a href="#cb142-1"></a><span class="kw">rm</span>(<span class="dt">list =</span> <span class="kw">ls</span>())</span></code></pre></div>
</div>
</div>
<div id="homework-8-2022-11-04" class="section level1">
<h1>homework 8: 2022-11-04</h1>
<div id="question-1-1" class="section level2">
<h2>Question 1</h2>
<p>test for mediation</p>
</div>
<div id="answer-21" class="section level2">
<h2>Answer</h2>
<p>Let <span class="math display">\[X \sim N(2, 2^2)\]</span> <span class="math display">\[M=a_M+\alpha X +e_M\]</span> <span class="math display">\[Y=a_Y+\beta M+\gamma X + e_Y\]</span> where <span class="math inline">\(a_M=a_Y=1, e_M,e_Y\sim N(0,1)\)</span></p>
<div class="sourceCode" id="cb143"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb143-1"><a href="#cb143-1"></a>generate_sample &lt;-<span class="st"> </span><span class="cf">function</span>(alpha, beta, gamma, <span class="dt">n=</span><span class="dv">500</span>, <span class="dt">aM=</span><span class="dv">1</span>, <span class="dt">aY=</span><span class="dv">1</span>){</span>
<span id="cb143-2"><a href="#cb143-2"></a>  eM =<span class="st"> </span><span class="kw">rnorm</span>(n, <span class="dv">0</span>, <span class="dv">1</span>)</span>
<span id="cb143-3"><a href="#cb143-3"></a>  eY =<span class="st"> </span><span class="kw">rnorm</span>(n, <span class="dv">0</span>, <span class="dv">1</span>)</span>
<span id="cb143-4"><a href="#cb143-4"></a>  X &lt;-<span class="st"> </span><span class="kw">rnorm</span>(n, <span class="dv">2</span>, <span class="dv">2</span>)</span>
<span id="cb143-5"><a href="#cb143-5"></a>  M &lt;-<span class="st"> </span>aM <span class="op">+</span><span class="st"> </span>alpha<span class="op">*</span>X <span class="op">+</span><span class="st"> </span>eM</span>
<span id="cb143-6"><a href="#cb143-6"></a>  Y &lt;-<span class="st"> </span>aY <span class="op">+</span><span class="st"> </span>beta<span class="op">*</span>M <span class="op">+</span><span class="st"> </span>gamma<span class="op">*</span>X <span class="op">+</span><span class="st"> </span>eY</span>
<span id="cb143-7"><a href="#cb143-7"></a>  <span class="kw">return</span>(<span class="kw">data.frame</span>(<span class="dt">X=</span>X, <span class="dt">M=</span>M, <span class="dt">Y=</span>Y))</span>
<span id="cb143-8"><a href="#cb143-8"></a>}</span>
<span id="cb143-9"><a href="#cb143-9"></a><span class="kw">set.seed</span>(<span class="dv">1</span>)</span>
<span id="cb143-10"><a href="#cb143-10"></a>sam1 =<span class="st"> </span><span class="kw">generate_sample</span>(<span class="dv">0</span>,<span class="dv">0</span>,<span class="dv">1</span>)</span>
<span id="cb143-11"><a href="#cb143-11"></a>sam2 =<span class="st"> </span><span class="kw">generate_sample</span>(<span class="dv">0</span>,<span class="dv">1</span>,<span class="dv">1</span>)</span>
<span id="cb143-12"><a href="#cb143-12"></a>sam3 =<span class="st"> </span><span class="kw">generate_sample</span>(<span class="dv">1</span>,<span class="dv">0</span>,<span class="dv">1</span>)</span></code></pre></div>
<p><span class="math inline">\(H_0: \alpha\beta=0 \leftrightarrow H_1:\alpha\beta\neq 0\)</span></p>
<p><span class="math inline">\(T=\frac{\hat\alpha\hat\beta}{\hat{se}(\hat\alpha\hat\beta)}\)</span></p>
<p>where <span class="math inline">\(se(\hat\alpha\hat\beta)=\sqrt{b^2s_a^2+a^2s_b^2}\)</span></p>
<p>If there is a mediation effect, then H1 is established and |T| will be relatively large. The p-value can be calculated by calculating the permuted statistic T: <span class="math inline">\(P(|T|&gt;T_0)\)</span></p>
<p>When guaranteeing condition 1 <span class="math inline">\(\alpha=0\)</span>, the statistics won’t change by permuting the order of X</p>
<p>When guaranteeing condition 2 <span class="math inline">\(\beta=0\)</span>, the statistics won’t change by permuting the order of Y</p>
<p>When guaranteeing condition 3 <span class="math inline">\(\alpha=\beta=0\)</span>, the statistics won’t change by permuting the order of M</p>
<div class="sourceCode" id="cb144"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb144-1"><a href="#cb144-1"></a><span class="kw">library</span>(boot)</span>
<span id="cb144-2"><a href="#cb144-2"></a>boot.perm &lt;-<span class="st"> </span><span class="cf">function</span>(data, i, condition){</span>
<span id="cb144-3"><a href="#cb144-3"></a>  x &lt;-<span class="st"> </span>data<span class="op">$</span>X</span>
<span id="cb144-4"><a href="#cb144-4"></a>  y &lt;-<span class="st"> </span>data<span class="op">$</span>Y</span>
<span id="cb144-5"><a href="#cb144-5"></a>  m &lt;-<span class="st"> </span>data<span class="op">$</span>M</span>
<span id="cb144-6"><a href="#cb144-6"></a>  <span class="cf">if</span>(condition <span class="op">==</span><span class="st"> &#39;X&#39;</span>) x &lt;-<span class="st"> </span>x[i] <span class="co">#permuting</span></span>
<span id="cb144-7"><a href="#cb144-7"></a>  <span class="cf">if</span>(condition <span class="op">==</span><span class="st"> &#39;Y&#39;</span>) y &lt;-<span class="st"> </span>y[i] <span class="co">#permuting</span></span>
<span id="cb144-8"><a href="#cb144-8"></a>  <span class="cf">if</span>(condition <span class="op">==</span><span class="st"> &#39;M&#39;</span>) m &lt;-<span class="st"> </span>m[i] <span class="co">#permuting</span></span>
<span id="cb144-9"><a href="#cb144-9"></a>  fy &lt;-<span class="st"> </span><span class="kw">lm</span>(y <span class="op">~</span><span class="st"> </span>m <span class="op">+</span><span class="st"> </span>x)</span>
<span id="cb144-10"><a href="#cb144-10"></a>  fm &lt;-<span class="st"> </span><span class="kw">lm</span>(m <span class="op">~</span><span class="st"> </span>x)</span>
<span id="cb144-11"><a href="#cb144-11"></a>  b =<span class="st"> </span><span class="kw">summary</span>(fy)<span class="op">$</span>coefficients[<span class="dv">2</span>,<span class="dv">1</span>]</span>
<span id="cb144-12"><a href="#cb144-12"></a>  b.se =<span class="st"> </span><span class="kw">summary</span>(fy)<span class="op">$</span>coefficients[<span class="dv">2</span>,<span class="dv">2</span>]</span>
<span id="cb144-13"><a href="#cb144-13"></a>  a =<span class="st"> </span><span class="kw">summary</span>(fm)<span class="op">$</span>coefficients[<span class="dv">2</span>,<span class="dv">1</span>]</span>
<span id="cb144-14"><a href="#cb144-14"></a>  a.se =<span class="st"> </span><span class="kw">summary</span>(fm)<span class="op">$</span>coefficients[<span class="dv">2</span>,<span class="dv">2</span>]</span>
<span id="cb144-15"><a href="#cb144-15"></a>  ab.se =<span class="st"> </span><span class="kw">sqrt</span>(b<span class="op">^</span><span class="dv">2</span><span class="op">*</span>a.se<span class="op">^</span><span class="dv">2</span><span class="op">+</span>a<span class="op">^</span><span class="dv">2</span><span class="op">*</span>b.se<span class="op">^</span><span class="dv">2</span>)</span>
<span id="cb144-16"><a href="#cb144-16"></a>  t =<span class="st"> </span>a<span class="op">*</span>b<span class="op">/</span>ab.se</span>
<span id="cb144-17"><a href="#cb144-17"></a>}</span></code></pre></div>
<div id="parameter-combination-1.-alpha0beta0" class="section level3">
<h3>parameter combination 1. <span class="math inline">\(\alpha=0,\beta=0\)</span></h3>
<p>permutation guarantee <span class="math inline">\(\alpha=0\)</span></p>
<div class="sourceCode" id="cb145"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb145-1"><a href="#cb145-1"></a><span class="kw">set.seed</span>(<span class="dv">1</span>)</span>
<span id="cb145-2"><a href="#cb145-2"></a>boot.med &lt;-<span class="st"> </span><span class="kw">boot</span>(<span class="dt">data =</span> sam1, <span class="dt">statistic =</span> boot.perm, <span class="dt">R =</span> <span class="dv">1999</span>, <span class="dt">sim =</span> <span class="st">&quot;permutation&quot;</span>, <span class="dt">condition=</span><span class="st">&#39;X&#39;</span>)</span>
<span id="cb145-3"><a href="#cb145-3"></a>p.value.a &lt;-<span class="st"> </span><span class="kw">mean</span>(<span class="kw">abs</span>(<span class="kw">c</span>(boot.med<span class="op">$</span>t0, boot.med<span class="op">$</span>t)) <span class="op">&gt;</span><span class="st"> </span><span class="kw">abs</span>(boot.med<span class="op">$</span>t0))</span></code></pre></div>
<p>permutation guarantee <span class="math inline">\(\beta=0\)</span></p>
<div class="sourceCode" id="cb146"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb146-1"><a href="#cb146-1"></a><span class="kw">set.seed</span>(<span class="dv">1</span>)</span>
<span id="cb146-2"><a href="#cb146-2"></a>boot.med &lt;-<span class="st"> </span><span class="kw">boot</span>(<span class="dt">data =</span> sam1, <span class="dt">statistic =</span> boot.perm, <span class="dt">R =</span> <span class="dv">1999</span>, <span class="dt">sim =</span> <span class="st">&quot;permutation&quot;</span>, <span class="dt">condition=</span><span class="st">&#39;Y&#39;</span>)</span>
<span id="cb146-3"><a href="#cb146-3"></a>p.value.b &lt;-<span class="st"> </span><span class="kw">mean</span>(<span class="kw">abs</span>(<span class="kw">c</span>(boot.med<span class="op">$</span>t0, boot.med<span class="op">$</span>t)) <span class="op">&gt;</span><span class="st"> </span><span class="kw">abs</span>(boot.med<span class="op">$</span>t0))</span></code></pre></div>
<p>permutation guarantee <span class="math inline">\(\alpha=\beta=0\)</span></p>
<div class="sourceCode" id="cb147"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb147-1"><a href="#cb147-1"></a><span class="kw">set.seed</span>(<span class="dv">1</span>)</span>
<span id="cb147-2"><a href="#cb147-2"></a>boot.med &lt;-<span class="st"> </span><span class="kw">boot</span>(<span class="dt">data =</span> sam1, <span class="dt">statistic =</span> boot.perm, <span class="dt">R =</span> <span class="dv">1999</span>, <span class="dt">sim =</span> <span class="st">&quot;permutation&quot;</span>, <span class="dt">condition=</span><span class="st">&#39;M&#39;</span>)</span>
<span id="cb147-3"><a href="#cb147-3"></a>p.value.m &lt;-<span class="st"> </span><span class="kw">mean</span>(<span class="kw">abs</span>(<span class="kw">c</span>(boot.med<span class="op">$</span>t0, boot.med<span class="op">$</span>t)) <span class="op">&gt;</span><span class="st"> </span><span class="kw">abs</span>(boot.med<span class="op">$</span>t0))</span></code></pre></div>
<p>p values:</p>
<div class="sourceCode" id="cb148"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb148-1"><a href="#cb148-1"></a><span class="kw">c</span>(<span class="st">&#39;a=0&#39;</span>=p.value.a, <span class="st">&#39;b=0&#39;</span>=p.value.b, <span class="st">&#39;ab=0&#39;</span>=p.value.m)</span></code></pre></div>
<pre><code>##    a=0    b=0   ab=0 
## 0.5365 0.3275 0.2755</code></pre>
<p>Due to p values, we can say <span class="math inline">\(\alpha=\beta=0\)</span>. And method 1 for condition 1 <span class="math inline">\(\alpha=0\)</span> has lower I error rate.</p>
</div>
<div id="parameter-combination-2.-alpha0beta1" class="section level3">
<h3>parameter combination 2. <span class="math inline">\(\alpha=0,\beta=1\)</span></h3>
<p>permutation guarantee <span class="math inline">\(\alpha=0\)</span></p>
<div class="sourceCode" id="cb150"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb150-1"><a href="#cb150-1"></a><span class="kw">set.seed</span>(<span class="dv">1</span>)</span>
<span id="cb150-2"><a href="#cb150-2"></a>boot.med &lt;-<span class="st"> </span><span class="kw">boot</span>(<span class="dt">data =</span> sam2, <span class="dt">statistic =</span> boot.perm, <span class="dt">R =</span> <span class="dv">1999</span>, <span class="dt">sim =</span> <span class="st">&quot;permutation&quot;</span>, <span class="dt">condition=</span><span class="st">&#39;X&#39;</span>)</span>
<span id="cb150-3"><a href="#cb150-3"></a>p.value.a &lt;-<span class="st"> </span><span class="kw">mean</span>(<span class="kw">abs</span>(<span class="kw">c</span>(boot.med<span class="op">$</span>t0, boot.med<span class="op">$</span>t)) <span class="op">&gt;</span><span class="st"> </span><span class="kw">abs</span>(boot.med<span class="op">$</span>t0))</span></code></pre></div>
<p>permutation guarantee <span class="math inline">\(\beta=0\)</span></p>
<div class="sourceCode" id="cb151"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb151-1"><a href="#cb151-1"></a><span class="kw">set.seed</span>(<span class="dv">1</span>)</span>
<span id="cb151-2"><a href="#cb151-2"></a>boot.med &lt;-<span class="st"> </span><span class="kw">boot</span>(<span class="dt">data =</span> sam2, <span class="dt">statistic =</span> boot.perm, <span class="dt">R =</span> <span class="dv">1999</span>, <span class="dt">sim =</span> <span class="st">&quot;permutation&quot;</span>, <span class="dt">condition=</span><span class="st">&#39;Y&#39;</span>)</span>
<span id="cb151-3"><a href="#cb151-3"></a>p.value.b &lt;-<span class="st"> </span><span class="kw">mean</span>(<span class="kw">abs</span>(<span class="kw">c</span>(boot.med<span class="op">$</span>t0, boot.med<span class="op">$</span>t)) <span class="op">&gt;</span><span class="st"> </span><span class="kw">abs</span>(boot.med<span class="op">$</span>t0))</span></code></pre></div>
<p>permutation guarantee <span class="math inline">\(\alpha=\beta=0\)</span></p>
<div class="sourceCode" id="cb152"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb152-1"><a href="#cb152-1"></a><span class="kw">set.seed</span>(<span class="dv">1</span>)</span>
<span id="cb152-2"><a href="#cb152-2"></a>boot.med &lt;-<span class="st"> </span><span class="kw">boot</span>(<span class="dt">data =</span> sam2, <span class="dt">statistic =</span> boot.perm, <span class="dt">R =</span> <span class="dv">1999</span>, <span class="dt">sim =</span> <span class="st">&quot;permutation&quot;</span>, <span class="dt">condition=</span><span class="st">&#39;M&#39;</span>)</span>
<span id="cb152-3"><a href="#cb152-3"></a>p.value.m &lt;-<span class="st"> </span><span class="kw">mean</span>(<span class="kw">abs</span>(<span class="kw">c</span>(boot.med<span class="op">$</span>t0, boot.med<span class="op">$</span>t)) <span class="op">&gt;</span><span class="st"> </span><span class="kw">abs</span>(boot.med<span class="op">$</span>t0))</span></code></pre></div>
<p>p values:</p>
<div class="sourceCode" id="cb153"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb153-1"><a href="#cb153-1"></a><span class="kw">c</span>(<span class="st">&#39;a=0&#39;</span>=p.value.a, <span class="st">&#39;b=0&#39;</span>=p.value.b, <span class="st">&#39;ab=0&#39;</span>=p.value.m)</span></code></pre></div>
<pre><code>##    a=0    b=0   ab=0 
## 0.6500 0.0000 0.3465</code></pre>
<p>Due to p values, we can say <span class="math inline">\(\alpha=\beta=0\)</span> cause <span class="math inline">\(\alpha=0\)</span>. And method 1 for condition 1 <span class="math inline">\(\alpha=0\)</span> has lower I error rate.</p>
</div>
<div id="parameter-combination-3.-alpha1beta0" class="section level3">
<h3>parameter combination 3. <span class="math inline">\(\alpha=1,\beta=0\)</span></h3>
<p>permutation guarantee <span class="math inline">\(\alpha=0\)</span></p>
<div class="sourceCode" id="cb155"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb155-1"><a href="#cb155-1"></a><span class="kw">set.seed</span>(<span class="dv">1</span>)</span>
<span id="cb155-2"><a href="#cb155-2"></a>boot.med &lt;-<span class="st"> </span><span class="kw">boot</span>(<span class="dt">data =</span> sam3, <span class="dt">statistic =</span> boot.perm, <span class="dt">R =</span> <span class="dv">1999</span>, <span class="dt">sim =</span> <span class="st">&quot;permutation&quot;</span>, <span class="dt">condition=</span><span class="st">&#39;X&#39;</span>)</span>
<span id="cb155-3"><a href="#cb155-3"></a>p.value.a &lt;-<span class="st"> </span><span class="kw">mean</span>(<span class="kw">abs</span>(<span class="kw">c</span>(boot.med<span class="op">$</span>t0, boot.med<span class="op">$</span>t)) <span class="op">&gt;</span><span class="st"> </span><span class="kw">abs</span>(boot.med<span class="op">$</span>t0))</span></code></pre></div>
<p>permutation guarantee <span class="math inline">\(\beta=0\)</span></p>
<div class="sourceCode" id="cb156"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb156-1"><a href="#cb156-1"></a><span class="kw">set.seed</span>(<span class="dv">1</span>)</span>
<span id="cb156-2"><a href="#cb156-2"></a>boot.med &lt;-<span class="st"> </span><span class="kw">boot</span>(<span class="dt">data =</span> sam3, <span class="dt">statistic =</span> boot.perm, <span class="dt">R =</span> <span class="dv">1999</span>, <span class="dt">sim =</span> <span class="st">&quot;permutation&quot;</span>, <span class="dt">condition=</span><span class="st">&#39;Y&#39;</span>)</span>
<span id="cb156-3"><a href="#cb156-3"></a>p.value.b &lt;-<span class="st"> </span><span class="kw">mean</span>(<span class="kw">abs</span>(<span class="kw">c</span>(boot.med<span class="op">$</span>t0, boot.med<span class="op">$</span>t)) <span class="op">&gt;</span><span class="st"> </span><span class="kw">abs</span>(boot.med<span class="op">$</span>t0))</span></code></pre></div>
<p>permutation guarantee <span class="math inline">\(\alpha=\beta=0\)</span></p>
<div class="sourceCode" id="cb157"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb157-1"><a href="#cb157-1"></a><span class="kw">set.seed</span>(<span class="dv">1</span>)</span>
<span id="cb157-2"><a href="#cb157-2"></a>boot.med &lt;-<span class="st"> </span><span class="kw">boot</span>(<span class="dt">data =</span> sam3, <span class="dt">statistic =</span> boot.perm, <span class="dt">R =</span> <span class="dv">1999</span>, <span class="dt">sim =</span> <span class="st">&quot;permutation&quot;</span>, <span class="dt">condition=</span><span class="st">&#39;M&#39;</span>)</span>
<span id="cb157-3"><a href="#cb157-3"></a>p.value.m &lt;-<span class="st"> </span><span class="kw">mean</span>(<span class="kw">abs</span>(<span class="kw">c</span>(boot.med<span class="op">$</span>t0, boot.med<span class="op">$</span>t)) <span class="op">&gt;</span><span class="st"> </span><span class="kw">abs</span>(boot.med<span class="op">$</span>t0))</span></code></pre></div>
<p>p values:</p>
<div class="sourceCode" id="cb158"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb158-1"><a href="#cb158-1"></a><span class="kw">c</span>(<span class="st">&#39;a=0&#39;</span>=p.value.a, <span class="st">&#39;b=0&#39;</span>=p.value.b, <span class="st">&#39;ab=0&#39;</span>=p.value.m)</span></code></pre></div>
<pre><code>##    a=0    b=0   ab=0 
## 0.2630 0.2705 0.0300</code></pre>
<p>Due to p values, we can say <span class="math inline">\(\alpha=\beta=0\)</span>. And method 2 for condition 2 <span class="math inline">\(\beta=0\)</span> has a little bit lower I error rate. But it seems that both of them don’t have very low I error rate.</p>
<div class="sourceCode" id="cb160"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb160-1"><a href="#cb160-1"></a><span class="kw">rm</span>(<span class="dt">list=</span><span class="kw">ls</span>())</span></code></pre></div>
</div>
</div>
<div id="question-2-1" class="section level2">
<h2>Question 2</h2>
<p>logistic</p>
</div>
<div id="answer-22" class="section level2">
<h2>Answer</h2>
<ol style="list-style-type: decimal">
<li>write a R function</li>
</ol>
<div class="sourceCode" id="cb161"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb161-1"><a href="#cb161-1"></a>g &lt;-<span class="st"> </span><span class="cf">function</span>(alpha, b1, b2, b3, f0, x1, x2, x3){</span>
<span id="cb161-2"><a href="#cb161-2"></a>  tmp &lt;-<span class="st"> </span><span class="kw">exp</span>(<span class="op">-</span>alpha<span class="op">-</span>b1<span class="op">*</span>x1<span class="op">-</span>b2<span class="op">*</span>x2<span class="op">-</span>b3<span class="op">*</span>x3)</span>
<span id="cb161-3"><a href="#cb161-3"></a>  p &lt;-<span class="st"> </span><span class="dv">1</span><span class="op">/</span>(<span class="dv">1</span><span class="op">+</span>tmp)</span>
<span id="cb161-4"><a href="#cb161-4"></a>  <span class="kw">mean</span>(p) <span class="op">-</span><span class="st"> </span>f0</span>
<span id="cb161-5"><a href="#cb161-5"></a>}</span>
<span id="cb161-6"><a href="#cb161-6"></a></span>
<span id="cb161-7"><a href="#cb161-7"></a>alpha_cal &lt;-<span class="st"> </span><span class="cf">function</span>(N, b1, b2, b3, f0){</span>
<span id="cb161-8"><a href="#cb161-8"></a>  x1 &lt;-<span class="st"> </span><span class="kw">rpois</span>(N, <span class="dv">1</span>)</span>
<span id="cb161-9"><a href="#cb161-9"></a>  x2 &lt;-<span class="st"> </span><span class="kw">rexp</span>(N, <span class="dt">rate =</span> <span class="dv">1</span>)</span>
<span id="cb161-10"><a href="#cb161-10"></a>  x3 &lt;-<span class="st"> </span><span class="kw">rbinom</span>(N, <span class="dt">size=</span><span class="dv">1</span>, <span class="dt">prob=</span><span class="fl">0.5</span>)</span>
<span id="cb161-11"><a href="#cb161-11"></a>  solution &lt;-<span class="st"> </span><span class="kw">uniroot</span>(<span class="cf">function</span>(a) <span class="kw">g</span>(a, b1, b2, b3, f0, x1, x2, x3), <span class="kw">c</span>(<span class="op">-</span><span class="dv">30</span>,<span class="dv">30</span>))</span>
<span id="cb161-12"><a href="#cb161-12"></a>  solution<span class="op">$</span>root</span>
<span id="cb161-13"><a href="#cb161-13"></a>}</span></code></pre></div>
<ol start="2" style="list-style-type: decimal">
<li></li>
</ol>
<div class="sourceCode" id="cb162"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb162-1"><a href="#cb162-1"></a>alpha =<span class="st"> </span><span class="kw">numeric</span>(<span class="dv">0</span>)</span>
<span id="cb162-2"><a href="#cb162-2"></a><span class="cf">for</span>(f <span class="cf">in</span> <span class="kw">c</span>(<span class="fl">0.1</span>, <span class="fl">0.01</span>, <span class="fl">0.001</span>, <span class="fl">0.0001</span>)){</span>
<span id="cb162-3"><a href="#cb162-3"></a>  alpha =<span class="st"> </span><span class="kw">c</span>(alpha, <span class="kw">alpha_cal</span>(<span class="fl">1e6</span>, <span class="dv">0</span>, <span class="dv">1</span>, <span class="dv">-1</span>, f))</span>
<span id="cb162-4"><a href="#cb162-4"></a>}</span></code></pre></div>
<ol start="3" style="list-style-type: decimal">
<li></li>
</ol>
<div class="sourceCode" id="cb163"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb163-1"><a href="#cb163-1"></a><span class="kw">plot</span>(<span class="op">-</span><span class="kw">log</span>(<span class="kw">c</span>(<span class="fl">0.1</span>, <span class="fl">0.01</span>, <span class="fl">0.001</span>, <span class="fl">0.0001</span>)), alpha, <span class="dt">xlab =</span> <span class="st">&#39;-log f0&#39;</span>)</span></code></pre></div>
<p><img src="data:image/png;base64,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" /><!-- --></p>
<div class="sourceCode" id="cb164"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb164-1"><a href="#cb164-1"></a><span class="kw">rm</span>(<span class="dt">list =</span> <span class="kw">ls</span>())</span></code></pre></div>
</div>
</div>
<div id="homework-9-2022-11-11" class="section level1">
<h1>homework 9: 2022-11-11</h1>
<div id="question-1-2" class="section level2">
<h2>Question 1</h2>
<p>Class work</p>
</div>
<div id="answer-23" class="section level2">
<h2>Answer</h2>
<ol style="list-style-type: decimal">
<li>Log likelihood function</li>
</ol>
<p><span class="math display">\[l(\lambda) = \sum_{i=1}^n logP_{\lambda}(u_i \leq X_i \leq v_i)\]</span></p>
<p>where <span class="math inline">\(P_{\lambda}(u_i \leq X_i \leq v_i)=\int_{u_i}^{v_i}\lambda e^{-\lambda x}dx=e^{-\lambda u_i}-e^{-\lambda v_i}\)</span></p>
<p>So<span class="math display">\[l(\lambda) = \sum_{i=1}^n log [e^{-\lambda u_i}-e^{-\lambda v_i}]\]</span> <span class="math display">\[l&#39;(\lambda) = \sum_{i=1}^n \frac{-u_ie^{-\lambda u_i}+v_ie^{-\lambda v_i}}{e^{-\lambda u_i}-e^{-\lambda v_i}}\]</span></p>
<p>Solve <span class="math inline">\(l&#39;(\lambda)=0\)</span> to get <span class="math inline">\(\lambda_{MLE}\)</span></p>
<p>EM algorithm</p>
<p>E-step</p>
<p><span class="math display">\[
\begin{aligned}
I_o(\lambda; X^{(o)})&amp; =E_{\lambda}[l(\lambda;X^{(o)},X^{{(m)}})|X^{(o)}] \\
&amp; = E_{\lambda}[\sum log(\lambda e^{-\lambda x_i})|X^{(o)}]\\
&amp; = \sum \int_{u_i}^{v_i}log(\lambda e^{-\lambda x_i})\lambda_0e^{-\lambda_0 x_i}dx_i/\int_{u_i}^{v_i}\lambda_0e^{-\lambda_0 x_i}dx_i \\
&amp; = \sum (\int_{u_i}^{v_i} \lambda_0 e^{-\lambda_0 x_i}log\lambda dx_i + \int_{u_i}^{v_i} -\lambda\lambda_0 x_i e^{-\lambda_0 x_i}dx_i)/\int_{u_i}^{v_i}\lambda_0e^{-\lambda_0 x_i}dx_i \\
&amp; = log\lambda\times n+\lambda\sum[(v_i+\frac{1}{\lambda_0})e^{-\lambda_0 v_i} - (u_i+\frac{1}{\lambda_0})e^{-\lambda_0 u_i} ]/(e^{-\lambda_0 u_i}-e^{-\lambda_0 v_i}) \\
&amp; := nlog\lambda+ \lambda A
\end{aligned}
\]</span></p>
<p>M-step</p>
<p>To maximum <span class="math inline">\(I_o\)</span>, let <span class="math inline">\(I_o&#39;(\lambda; X^{(o)})=0\)</span>, So <span class="math inline">\(\lambda_1 = -\frac{n}{A}\)</span></p>
<p>The EM algorithm estimation is the same with MLE estimation.</p>
<ol start="2" style="list-style-type: decimal">
<li></li>
</ol>
<div class="sourceCode" id="cb165"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb165-1"><a href="#cb165-1"></a>u =<span class="st"> </span><span class="kw">c</span>(<span class="dv">11</span>,<span class="dv">8</span>,<span class="dv">27</span>,<span class="dv">13</span>,<span class="dv">16</span>,<span class="dv">0</span>,<span class="dv">23</span>,<span class="dv">10</span>,<span class="dv">24</span>,<span class="dv">2</span>)</span>
<span id="cb165-2"><a href="#cb165-2"></a>v =<span class="st"> </span><span class="kw">c</span>(<span class="dv">12</span>,<span class="dv">9</span>,<span class="dv">28</span>,<span class="dv">14</span>,<span class="dv">17</span>,<span class="dv">1</span>,<span class="dv">24</span>,<span class="dv">11</span>,<span class="dv">25</span>,<span class="dv">3</span>)</span></code></pre></div>
<p>MLE</p>
<div class="sourceCode" id="cb166"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb166-1"><a href="#cb166-1"></a>log_like_dao &lt;-<span class="st"> </span><span class="cf">function</span>(lambda){</span>
<span id="cb166-2"><a href="#cb166-2"></a>  <span class="kw">sum</span>((<span class="op">-</span>u<span class="op">*</span><span class="kw">exp</span>(<span class="op">-</span>lambda<span class="op">*</span>u)<span class="op">+</span>v<span class="op">*</span><span class="kw">exp</span>(<span class="op">-</span>lambda<span class="op">*</span>v))<span class="op">/</span>(<span class="kw">exp</span>(<span class="op">-</span>lambda<span class="op">*</span>u)<span class="op">-</span><span class="kw">exp</span>(<span class="op">-</span>lambda<span class="op">*</span>v)))</span>
<span id="cb166-3"><a href="#cb166-3"></a>}</span>
<span id="cb166-4"><a href="#cb166-4"></a><span class="kw">uniroot</span>(log_like_dao, <span class="kw">c</span>(<span class="fl">0.01</span>,<span class="dv">1</span>))<span class="op">$</span>root</span></code></pre></div>
<pre><code>## [1] 0.07196878</code></pre>
<p>So the MLE estimation is 0.07196878</p>
<p>EM</p>
<div class="sourceCode" id="cb168"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb168-1"><a href="#cb168-1"></a>epo =<span class="st"> </span><span class="dv">500</span></span>
<span id="cb168-2"><a href="#cb168-2"></a>lambda0=<span class="dv">1</span></span>
<span id="cb168-3"><a href="#cb168-3"></a>n =<span class="st"> </span><span class="kw">length</span>(u)</span>
<span id="cb168-4"><a href="#cb168-4"></a><span class="cf">for</span>(i <span class="cf">in</span> <span class="dv">1</span><span class="op">:</span>epo){</span>
<span id="cb168-5"><a href="#cb168-5"></a>  A =<span class="st"> </span><span class="kw">sum</span>(((v<span class="op">+</span><span class="dv">1</span><span class="op">/</span>lambda0)<span class="op">*</span><span class="kw">exp</span>(<span class="op">-</span>lambda0<span class="op">*</span>v) <span class="op">-</span><span class="st"> </span>(u<span class="op">+</span><span class="dv">1</span><span class="op">/</span>lambda0)<span class="op">*</span><span class="kw">exp</span>(<span class="op">-</span>lambda0<span class="op">*</span>u)) <span class="op">/</span><span class="st"> </span>(<span class="kw">exp</span>(<span class="op">-</span>lambda0<span class="op">*</span>u)<span class="op">-</span><span class="kw">exp</span>(<span class="op">-</span>lambda0<span class="op">*</span>v)))</span>
<span id="cb168-6"><a href="#cb168-6"></a>  lambda1 =<span class="st"> </span><span class="op">-</span>n<span class="op">/</span>A</span>
<span id="cb168-7"><a href="#cb168-7"></a>  <span class="cf">if</span>(<span class="kw">abs</span>(lambda0<span class="op">-</span>lambda1)<span class="op">&lt;</span><span class="fl">1e-3</span>){</span>
<span id="cb168-8"><a href="#cb168-8"></a>    <span class="cf">break</span></span>
<span id="cb168-9"><a href="#cb168-9"></a>    }</span>
<span id="cb168-10"><a href="#cb168-10"></a>  lambda0 =<span class="st"> </span>lambda1</span>
<span id="cb168-11"><a href="#cb168-11"></a>}</span>
<span id="cb168-12"><a href="#cb168-12"></a>i</span></code></pre></div>
<pre><code>## [1] 2</code></pre>
<div class="sourceCode" id="cb170"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb170-1"><a href="#cb170-1"></a>lambda1</span></code></pre></div>
<pre><code>## [1] 0.07197367</code></pre>
<p>So the EM estimation is 0.07197367 (the same as MLE) with 2 epochs.</p>
</div>
<div id="question-2-2" class="section level2">
<h2>Question 2</h2>
<p>2.1.3 Exercise 4, 5</p>
</div>
<div id="answer-24" class="section level2">
<h2>Answer</h2>
<div id="exercise-4" class="section level4">
<h4>Exercise 4</h4>
<div class="sourceCode" id="cb172"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb172-1"><a href="#cb172-1"></a><span class="kw">unlist</span>(<span class="kw">list</span>(<span class="dv">1</span>,<span class="dv">2</span>,<span class="dv">3</span>))</span></code></pre></div>
<pre><code>## [1] 1 2 3</code></pre>
<div class="sourceCode" id="cb174"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb174-1"><a href="#cb174-1"></a><span class="kw">is.vector</span>(<span class="kw">list</span>(<span class="dv">1</span>,<span class="dv">2</span>,<span class="dv">3</span>))</span></code></pre></div>
<pre><code>## [1] TRUE</code></pre>
<div class="sourceCode" id="cb176"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb176-1"><a href="#cb176-1"></a><span class="kw">as.vector</span>(<span class="kw">list</span>(<span class="dv">1</span>,<span class="dv">2</span>,<span class="dv">3</span>))</span></code></pre></div>
<pre><code>## [[1]]
## [1] 1
## 
## [[2]]
## [1] 2
## 
## [[3]]
## [1] 3</code></pre>
<p><code>unlist</code> can get rid of flatten the nested structure</p>
<p><code>list</code> itself is a vector, <code>as.vector</code> doesn’t change it. To turn the list into a vector which contains all the atomic components which occur in it, we need to use <code>unlist</code>.</p>
</div>
<div id="exercise-5" class="section level4">
<h4>Exercise 5</h4>
<p>1 == ‘1’ true because the <code>numeric</code> will be automatically converted to <code>character</code> when comparing them.</p>
<p>-1 &lt; FALSE true because FALSE=0</p>
<p>“one” &lt; 2 false also because the <code>numeric</code> will be automatically converted to <code>character</code> when comparing them. And the order of characters is judged from the ASC2. All numbers appear before characters.</p>
</div>
</div>
<div id="question-3-1" class="section level2">
<h2>Question 3</h2>
<p>2.3.1 Exercise 1, 2</p>
</div>
<div id="answer-25" class="section level2">
<h2>Answer</h2>
<div id="exercise-1" class="section level4">
<h4>Exercise 1</h4>
<p>dim() return <code>NULL</code> when applied to a vector.</p>
</div>
<div id="exercise-2" class="section level4">
<h4>Exercise 2</h4>
<p>If is.matrix(x) is TRUE, is.array(x) will return TRUE.</p>
</div>
</div>
<div id="question-4" class="section level2">
<h2>Question 4</h2>
<p>2.4.5 Exercise 1, 2, 3</p>
</div>
<div id="answer-26" class="section level2">
<h2>Answer</h2>
<div id="exercise-1-1" class="section level4">
<h4>Exercise 1</h4>
<p>names, row.names and class</p>
</div>
<div id="exercise-2-1" class="section level4">
<h4>Exercise 2</h4>
<p>as.matrix is a generic function. The method for data frames will return a character matrix if there is only atomic columns and any non-(numeric/logical/complex) column, applying as.vector to factors and format to other non-character columns. Otherwise, the usual coercion hierarchy (logical &lt; integer &lt; double &lt; complex) will be used, e.g., all-logical data frames will be coerced to a logical matrix, mixed logical-integer will give a integer matrix, etc.</p>
</div>
<div id="exercise-3" class="section level4">
<h4>Exercise 3</h4>
<p>Yes. Also both dimensions can be 0.</p>
<div class="sourceCode" id="cb178"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb178-1"><a href="#cb178-1"></a>x &lt;-<span class="st"> </span><span class="kw">data.frame</span>()</span>
<span id="cb178-2"><a href="#cb178-2"></a>x</span></code></pre></div>
<pre><code>## data frame with 0 columns and 0 rows</code></pre>
<div class="sourceCode" id="cb180"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb180-1"><a href="#cb180-1"></a><span class="kw">rm</span>(<span class="dt">list =</span> <span class="kw">ls</span>())</span></code></pre></div>
</div>
</div>
</div>
<div id="homework-10-2022-11-18" class="section level1">
<h1>homework 10: 2022-11-18</h1>
<div id="question-1-3" class="section level2">
<h2>Question 1</h2>
<p>11.1.2 Exercises 2</p>
<p>The function below scales a vector so it falls in the range [0,1]. How would you apply it to every column of a data frame? How would you apply it to every numeric column in a dataframe?</p>
<div class="sourceCode" id="cb181"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb181-1"><a href="#cb181-1"></a>scale01 &lt;-<span class="st"> </span><span class="cf">function</span>(x) {</span>
<span id="cb181-2"><a href="#cb181-2"></a>rng &lt;-<span class="st"> </span><span class="kw">range</span>(x, <span class="dt">na.rm =</span> <span class="ot">TRUE</span>)</span>
<span id="cb181-3"><a href="#cb181-3"></a>(x <span class="op">-</span><span class="st"> </span>rng[<span class="dv">1</span>]) <span class="op">/</span><span class="st"> </span>(rng[<span class="dv">2</span>] <span class="op">-</span><span class="st"> </span>rng[<span class="dv">1</span>])</span>
<span id="cb181-4"><a href="#cb181-4"></a>}</span></code></pre></div>
</div>
<div id="answer-27" class="section level2">
<h2>Answer</h2>
<p>apply it to every column of a data frame</p>
<div class="sourceCode" id="cb182"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb182-1"><a href="#cb182-1"></a><span class="kw">data</span>(data)</span>
<span id="cb182-2"><a href="#cb182-2"></a>data =<span class="st"> </span>iris[<span class="dv">1</span><span class="op">:</span><span class="dv">4</span>]</span>
<span id="cb182-3"><a href="#cb182-3"></a>data_every_column =<span class="st"> </span><span class="kw">apply</span>(data, <span class="dv">2</span>, scale01)</span>
<span id="cb182-4"><a href="#cb182-4"></a><span class="kw">head</span>(data_every_column)</span></code></pre></div>
<pre><code>##      Sepal.Length Sepal.Width Petal.Length Petal.Width
## [1,]   0.22222222   0.6250000   0.06779661  0.04166667
## [2,]   0.16666667   0.4166667   0.06779661  0.04166667
## [3,]   0.11111111   0.5000000   0.05084746  0.04166667
## [4,]   0.08333333   0.4583333   0.08474576  0.04166667
## [5,]   0.19444444   0.6666667   0.06779661  0.04166667
## [6,]   0.30555556   0.7916667   0.11864407  0.12500000</code></pre>
<p>apply it to every numeric column of a data frame</p>
<div class="sourceCode" id="cb184"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb184-1"><a href="#cb184-1"></a>data =<span class="st"> </span>iris</span>
<span id="cb184-2"><a href="#cb184-2"></a>data_numeric_column =<span class="st"> </span><span class="kw">data.frame</span>(<span class="kw">lapply</span>(data, <span class="cf">function</span>(x) <span class="cf">if</span> (<span class="kw">is.numeric</span>(x)) <span class="kw">scale01</span>(x) <span class="cf">else</span> x))</span>
<span id="cb184-3"><a href="#cb184-3"></a><span class="kw">head</span>(data_numeric_column)</span></code></pre></div>
<pre><code>##   Sepal.Length Sepal.Width Petal.Length Petal.Width Species
## 1   0.22222222   0.6250000   0.06779661  0.04166667  setosa
## 2   0.16666667   0.4166667   0.06779661  0.04166667  setosa
## 3   0.11111111   0.5000000   0.05084746  0.04166667  setosa
## 4   0.08333333   0.4583333   0.08474576  0.04166667  setosa
## 5   0.19444444   0.6666667   0.06779661  0.04166667  setosa
## 6   0.30555556   0.7916667   0.11864407  0.12500000  setosa</code></pre>
<div class="sourceCode" id="cb186"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb186-1"><a href="#cb186-1"></a><span class="kw">rm</span>(<span class="dt">list =</span> <span class="kw">ls</span>())</span></code></pre></div>
</div>
<div id="question-2-3" class="section level2">
<h2>Question 2</h2>
<p>11.2.5 Exercises 1</p>
<ol style="list-style-type: decimal">
<li>Use vapply() to:</li>
</ol>
<ol style="list-style-type: lower-alpha">
<li>Compute the standard deviation of every column in a numeric data frame.</li>
<li>Compute the standard deviation of every numeric column in a mixed data frame. (Hint: you’ll need to use vapply() twice.)</li>
</ol>
</div>
<div id="answer-28" class="section level2">
<h2>Answer</h2>
<ol style="list-style-type: lower-alpha">
<li>a numeric data frame</li>
</ol>
<div class="sourceCode" id="cb187"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb187-1"><a href="#cb187-1"></a><span class="kw">data</span>(data)</span>
<span id="cb187-2"><a href="#cb187-2"></a>data =<span class="st"> </span>iris[<span class="dv">1</span><span class="op">:</span><span class="dv">4</span>]</span>
<span id="cb187-3"><a href="#cb187-3"></a><span class="kw">vapply</span>(data, sd, <span class="dv">0</span>)</span></code></pre></div>
<pre><code>## Sepal.Length  Sepal.Width Petal.Length  Petal.Width 
##    0.8280661    0.4358663    1.7652982    0.7622377</code></pre>
<ol start="2" style="list-style-type: lower-alpha">
<li>a mixed data frame</li>
</ol>
<div class="sourceCode" id="cb189"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb189-1"><a href="#cb189-1"></a>data =<span class="st"> </span>iris</span>
<span id="cb189-2"><a href="#cb189-2"></a><span class="kw">vapply</span>(data[<span class="kw">vapply</span>(data, is.numeric, <span class="kw">logical</span>(<span class="dv">1</span>))], sd, <span class="dv">0</span>)</span></code></pre></div>
<pre><code>## Sepal.Length  Sepal.Width Petal.Length  Petal.Width 
##    0.8280661    0.4358663    1.7652982    0.7622377</code></pre>
<div class="sourceCode" id="cb191"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb191-1"><a href="#cb191-1"></a><span class="kw">rm</span>(<span class="dt">list =</span> <span class="kw">ls</span>())</span></code></pre></div>
</div>
<div id="question-3-2" class="section level2">
<h2>Question 3</h2>
<p>Implement a Gibbs sampler to generate a bivariate normal chain (Xt, Yt) with zero means, unit standard deviations, and correlation 0.9. Write an Rcpp function. Compare the corresponding generated random numbers with pure R language using the function ‘qqplot’. Compare the computation time of the two functions with the function ‘microbenchmark’.</p>
</div>
<div id="answer-29" class="section level2">
<h2>Answer</h2>
<pre><code>## 
## 载入程辑包：&#39;StatComp&#39;</code></pre>
<pre><code>## The following object is masked from &#39;package:StatComp22023&#39;:
## 
##     gibbsC</code></pre>
<div class="sourceCode" id="cb194"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb194-1"><a href="#cb194-1"></a>gibbsR &lt;-<span class="st"> </span><span class="cf">function</span>(N, thin) {</span>
<span id="cb194-2"><a href="#cb194-2"></a>  mat &lt;-<span class="st"> </span><span class="kw">matrix</span>(<span class="dt">nrow =</span> N, <span class="dt">ncol =</span> <span class="dv">2</span>)</span>
<span id="cb194-3"><a href="#cb194-3"></a>  x &lt;-<span class="st"> </span>y &lt;-<span class="st"> </span><span class="dv">0</span></span>
<span id="cb194-4"><a href="#cb194-4"></a>  <span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">1</span><span class="op">:</span>N) {</span>
<span id="cb194-5"><a href="#cb194-5"></a>    <span class="cf">for</span> (j <span class="cf">in</span> <span class="dv">1</span><span class="op">:</span>thin) {</span>
<span id="cb194-6"><a href="#cb194-6"></a>      x &lt;-<span class="st"> </span><span class="kw">rnorm</span>(<span class="dv">1</span>, <span class="fl">0.9</span><span class="op">*</span>y, <span class="kw">sqrt</span>(<span class="dv">1</span><span class="fl">-0.9</span><span class="op">^</span><span class="dv">2</span>))</span>
<span id="cb194-7"><a href="#cb194-7"></a>      y &lt;-<span class="st"> </span><span class="kw">rnorm</span>(<span class="dv">1</span>, <span class="fl">0.9</span><span class="op">*</span>x, <span class="kw">sqrt</span>(<span class="dv">1</span><span class="fl">-0.9</span><span class="op">^</span><span class="dv">2</span>))</span>
<span id="cb194-8"><a href="#cb194-8"></a>    }</span>
<span id="cb194-9"><a href="#cb194-9"></a>    mat[i, ] &lt;-<span class="st"> </span><span class="kw">c</span>(x, y)</span>
<span id="cb194-10"><a href="#cb194-10"></a>  }</span>
<span id="cb194-11"><a href="#cb194-11"></a>  mat</span>
<span id="cb194-12"><a href="#cb194-12"></a>}</span></code></pre></div>
<div class="sourceCode" id="cb195"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb195-1"><a href="#cb195-1"></a>gibbR=<span class="kw">gibbsR</span>(<span class="dv">1000</span>,<span class="dv">20</span>)</span>
<span id="cb195-2"><a href="#cb195-2"></a>gibbC=<span class="kw">gibbsC</span>(<span class="dv">1000</span>,<span class="dv">20</span>)</span></code></pre></div>
<div class="sourceCode" id="cb196"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb196-1"><a href="#cb196-1"></a><span class="kw">par</span>(<span class="dt">mfrow =</span> <span class="kw">c</span>(<span class="dv">1</span>,<span class="dv">2</span>))</span>
<span id="cb196-2"><a href="#cb196-2"></a><span class="kw">qqplot</span>(gibbR[,<span class="dv">1</span>], gibbC[,<span class="dv">1</span>], <span class="dt">main=</span><span class="st">&#39;Xt&#39;</span>)</span>
<span id="cb196-3"><a href="#cb196-3"></a><span class="kw">abline</span>(<span class="dt">a=</span><span class="dv">0</span>,<span class="dt">b=</span><span class="dv">1</span>, <span class="dt">col=</span><span class="st">&#39;red&#39;</span>)</span>
<span id="cb196-4"><a href="#cb196-4"></a><span class="kw">qqplot</span>(gibbR[,<span class="dv">2</span>], gibbC[,<span class="dv">2</span>], <span class="dt">main=</span><span class="st">&#39;Yt&#39;</span>)</span>
<span id="cb196-5"><a href="#cb196-5"></a><span class="kw">abline</span>(<span class="dt">a=</span><span class="dv">0</span>,<span class="dt">b=</span><span class="dv">1</span>, <span class="dt">col=</span><span class="st">&#39;red&#39;</span>)</span></code></pre></div>
<p>The samples from Gibbs sampling with Rcpp have a high correlation with the samples obtained with R language</p>
<div class="sourceCode" id="cb197"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb197-1"><a href="#cb197-1"></a><span class="kw">library</span>(microbenchmark)</span>
<span id="cb197-2"><a href="#cb197-2"></a>compare &lt;-<span class="st"> </span><span class="kw">microbenchmark</span>(<span class="dt">gibbR=</span><span class="kw">gibbsR</span>(<span class="dv">1000</span>,<span class="dv">20</span>), <span class="dt">gibbC=</span><span class="kw">gibbsC</span>(<span class="dv">1000</span>,<span class="dv">20</span>))</span>
<span id="cb197-3"><a href="#cb197-3"></a><span class="kw">summary</span>(compare)</span></code></pre></div>
<p>We can see that the running time of C language is much less than that of R language.</p>
</div>
</div>



<!-- code folding -->


<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    script.src  = "https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML";
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>

</body>
</html>
